,project_metrics,run,_runtime_metrics,_step_metrics,_timestamp_metrics,_wandb_metrics,epoch_metrics,loss_coeff/forces_tail_huber_metrics,loss_coeff/per_atom_energy_mse_metrics,loss_coeff/stress_mse_metrics,lr-Adam_metrics,test0_epoch/forces_mae_metrics,test0_epoch/forces_rmse_metrics,test0_epoch/per_atom_energy_mae_metrics,test0_epoch/per_atom_energy_rmse_metrics,test0_epoch/stress_mae_metrics,test0_epoch/stress_rmse_metrics,test0_epoch/weighted_sum_metrics,train_loss_epoch/forces_tail_huber_metrics,train_loss_epoch/per_atom_energy_mse_metrics,train_loss_epoch/stress_mse_metrics,train_loss_epoch/weighted_sum_metrics,train_loss_step/forces_tail_huber_metrics,train_loss_step/per_atom_energy_mse_metrics,train_loss_step/stress_mse_metrics,train_loss_step/weighted_sum_metrics,trainer/global_step_metrics,val0_epoch/forces_mae_x,val0_epoch/forces_rmse_metrics,val0_epoch/per_atom_energy_mae_metrics,val0_epoch/per_atom_energy_rmse_metrics,val0_epoch/stress_mae_metrics,val0_epoch/stress_rmse_metrics,val0_epoch/weighted_sum_metrics,val1_epoch/forces_mae_metrics,val1_epoch/forces_rmse_metrics,val1_epoch/per_atom_energy_mae_metrics,val1_epoch/per_atom_energy_rmse_metrics,val1_epoch/stress_mae_metrics,val1_epoch/stress_rmse_metrics,val1_epoch/weighted_sum_metrics,cfg_ema_decay,cfg_info_dict_metrics,cfg_loss_metrics,cfg_lr_scheduler_metrics,cfg_model_metrics,cfg_num_datasets_metrics,cfg_optimizer,cfg_test_metrics,cfg_train_metrics_metrics,cfg_val_metrics,train_loss/auto_delta_metrics,loss_coeff/forces_auto_stratified_huber_metrics,train_loss_epoch/forces_auto_stratified_huber_metrics,train_loss_step/forces_auto_stratified_huber_metrics,loss_coeff/forces_focal_focal_mse_metrics,train_loss_epoch/forces_focal_focal_mse_metrics,train_loss_step/forces_focal_focal_mse_metrics,loss_coeff/forces_angle_forces_angle_metrics,loss_coeff/stress_shear_stress_shear_mae_metrics,train_loss_epoch/forces_angle_forces_angle_metrics,train_loss_epoch/stress_shear_stress_shear_mae_metrics,train_loss_step/forces_angle_forces_angle_metrics,train_loss_step/stress_shear_stress_shear_mae_metrics,loss_coeff/forces_angle_force_angle_metrics,train_loss_epoch/forces_angle_force_angle_metrics,train_loss_step/forces_angle_force_angle_metrics,loss_coeff/stress_angle_stress_angle_metrics,train_loss_epoch/stress_angle_stress_angle_metrics,train_loss_step/stress_angle_stress_angle_metrics,loss_coeff/force_strat_E_huber_metrics,loss_coeff/peratom_E_Huber_metrics,loss_coeff/stress_E_Huber_metrics,lr-AdamW_metrics,test0_epoch/total_energy_mae_metrics,test0_epoch/total_energy_rmse_metrics,train_loss_epoch/force_strat_E_huber_metrics,train_loss_epoch/peratom_E_Huber_metrics,train_loss_epoch/stress_E_Huber_metrics,train_loss_step/force_strat_E_huber_metrics,train_loss_step/peratom_E_Huber_metrics,train_loss_step/stress_E_Huber_metrics,train_metric_epoch/forces_mae_metrics,train_metric_epoch/forces_rmse_metrics,train_metric_epoch/per_atom_energy_mae_metrics,train_metric_epoch/per_atom_energy_rmse_metrics,train_metric_epoch/stress_mae_metrics,train_metric_epoch/stress_rmse_metrics,train_metric_epoch/total_energy_mae_metrics,train_metric_epoch/total_energy_rmse_metrics,train_metric_epoch/weighted_sum_metrics,train_metric_step/forces_mae_metrics,train_metric_step/forces_rmse_metrics,train_metric_step/per_atom_energy_mae_metrics,train_metric_step/per_atom_energy_rmse_metrics,train_metric_step/stress_mae_metrics,train_metric_step/stress_rmse_metrics,train_metric_step/total_energy_mae_metrics,train_metric_step/total_energy_rmse_metrics,train_metric_step/weighted_sum_metrics,val0_epoch/total_energy_mae_metrics,val0_epoch/total_energy_rmse_metrics,loss_coeff/forces_stratified_huber_metrics,train_loss_epoch/forces_stratified_huber_metrics,train_loss_step/forces_stratified_huber_metrics,loss_coeff/forces_huber_metrics,loss_coeff/stress_huber_metrics,train_loss_epoch/forces_huber_metrics,train_loss_epoch/per_atom_energy_huber_metrics,train_loss_epoch/stress_huber_metrics,train_loss_step/forces_huber_metrics,train_loss_step/per_atom_energy_huber_metrics,train_loss_step/stress_huber_metrics,loss_coeff/forces_mse_metrics,train_loss_epoch/forces_mse_metrics,train_loss_step/forces_mse_metrics,loss_coeff/per_atom_energy_huber_metrics,cfg_gradient_clip_algorithm_metrics,cfg_gradient_clip_val_metrics,cfg_lsqr_metrics,cfg_norm_eps_metrics,val0_epoch/forces_mae_y,val0_epoch/forces_mae,loss_coeff/force_strat_E_huber_summary,train_metric_epoch/total_energy_mae_summary,test0_epoch/total_energy_rmse_summary,train_loss_step/forces_stratified_huber_summary,train_metric_epoch/per_atom_energy_rmse_summary,train_loss_step/forces_tail_huber_summary,train_loss_step/forces_angle_forces_angle_summary,loss_coeff/forces_angle_force_angle_summary,train_loss_step/weighted_sum_summary,train_loss_epoch/stress_E_Huber_summary,test0_epoch/per_atom_energy_mae_summary,train_loss/auto_delta_summary,trainer/global_step_summary,test0_epoch/forces_mae_summary,train_metric_step/stress_mae_summary,cfg_lsqr_summary,loss_coeff/forces_auto_stratified_huber_summary,train_loss_step/stress_mse_summary,train_loss_epoch/forces_focal_focal_mse_summary,train_metric_step/per_atom_energy_mae_summary,loss_coeff/stress_angle_stress_angle_summary,val0_epoch/per_atom_energy_mae_summary,train_metric_step/weighted_sum_summary,val0_epoch/weighted_sum_summary,cfg_train_metrics_summary,val0_epoch/per_atom_energy_rmse_summary,train_loss_epoch/forces_stratified_huber_summary,lr-AdamW_summary,cfg_loss_summary,epoch_summary,train_loss_step/stress_angle_stress_angle_summary,train_loss_epoch/forces_huber_summary,train_loss_epoch/stress_huber_summary,_runtime_summary,train_loss_epoch/per_atom_energy_huber_summary,train_metric_epoch/per_atom_energy_mae_summary,train_metric_step/forces_mae_summary,test0_epoch/total_energy_mae_summary,val1_epoch/weighted_sum_summary,train_loss_step/forces_focal_focal_mse_summary,train_loss_step/forces_huber_summary,val1_epoch/stress_rmse_summary,train_metric_step/total_energy_mae_summary,train_metric_step/total_energy_rmse_summary,lr-Adam_summary,val0_epoch/total_energy_mae_summary,train_loss_epoch/force_strat_E_huber_summary,train_loss_epoch/stress_shear_stress_shear_mae_summary,train_metric_epoch/total_energy_rmse_summary,train_loss_step/force_strat_E_huber_summary,train_loss_step/forces_mse_summary,_timestamp_summary,cfg_gradient_clip_val_summary,train_loss_step/per_atom_energy_huber_summary,cfg_info_dict_summary,project_summary,test0_epoch/forces_rmse_summary,train_metric_epoch/weighted_sum_summary,cfg_norm_eps_summary,train_loss_epoch/forces_angle_forces_angle_summary,train_metric_step/per_atom_energy_rmse_summary,train_loss_epoch/per_atom_energy_mse_summary,loss_coeff/stress_mse_summary,train_loss_step/stress_huber_summary,loss_coeff/forces_stratified_huber_summary,cfg_num_datasets_summary,train_loss_step/peratom_E_Huber_summary,train_metric_epoch/forces_rmse_summary,loss_coeff/per_atom_energy_huber_summary,train_metric_step/stress_rmse_summary,_step_summary,val1_epoch/stress_mae_summary,train_loss_epoch/forces_tail_huber_summary,val1_epoch/forces_rmse_summary,train_loss_epoch/stress_angle_stress_angle_summary,loss_coeff/forces_huber_summary,train_loss_epoch/stress_mse_summary,val1_epoch/forces_mae_summary,loss_coeff/peratom_E_Huber_summary,train_loss_step/per_atom_energy_mse_summary,test0_epoch/stress_mae_summary,train_loss_epoch/forces_auto_stratified_huber_summary,loss_coeff/stress_huber_summary,train_loss_epoch/forces_mse_summary,loss_coeff/per_atom_energy_mse_summary,val0_epoch/stress_mae_summary,cfg_model_summary,_wandb_summary,test0_epoch/per_atom_energy_rmse_summary,train_metric_epoch/stress_rmse_summary,test0_epoch/stress_rmse_summary,cfg_gradient_clip_algorithm_summary,train_metric_epoch/forces_mae_summary,val0_epoch/forces_rmse_summary,loss_coeff/stress_E_Huber_summary,loss_coeff/stress_shear_stress_shear_mae_summary,train_loss_step/stress_E_Huber_summary,loss_coeff/forces_focal_focal_mse_summary,train_metric_step/forces_rmse_summary,val1_epoch/per_atom_energy_mae_summary,val1_epoch/per_atom_energy_rmse_summary,loss_coeff/forces_angle_forces_angle_summary,loss_coeff/forces_tail_huber_summary,val0_epoch/total_energy_rmse_summary,train_loss_step/stress_shear_stress_shear_mae_summary,train_loss_epoch/peratom_E_Huber_summary,cfg_lr_scheduler_summary,train_loss_epoch/weighted_sum_summary,val0_epoch/stress_rmse_summary,train_loss_step/forces_auto_stratified_huber_summary,loss_coeff/forces_mse_summary,train_metric_epoch/stress_mae_summary,train_loss_epoch/forces_angle_force_angle_summary,test0_epoch/weighted_sum_summary,train_loss_step/forces_angle_force_angle_summary,run_uid,r_max,num_layers,l_max,model_dtype,seed,avg_num_neighbors,num_scalar_features,num_tensor_features,mlp_depth,mlp_width,scalar_mlp_depth,scalar_mlp_width,radial_embed_dim,parity,per_type_energy_scales_trainable,per_type_energy_shifts_trainable,tp_path_channel_coupling,scalar_embed_mlp_nonlinearity,poly_p,num_bessels,bessel_trainable,train_file_path,val_file_path,test_file_path,dataset_hash,dataset_signature,loss_functions,checkpoint_monitor,checkpoint_mode,checkpoint_save_top_k,callback_types,lr_scheduler_type,lr_scheduler_monitor,lr_scheduler_frequency,epoch_last,epoch_best
0,allegro_huber_loss_study,base_huber_q0.9_no_sampler,27516.154726852,104363.0,1751286031.6503975,{'runtime': 27516},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.0005,0.10254749854695976,0.1911405014524467,0.021366433040964007,0.02952050621982827,0.0022686240583407987,0.0048833928567666605,0.07518146684301387,0.03031734012863151,0.0024945136822239404,3.199850037401357e-05,0.005037177704708847,0.0430526241925131,0.0008637788239086706,1.5705181529803806e-05,0.007084840652877539,520300.0,0.10612094880019211,0.20842814930517525,0.022027290752049854,0.03889020560397747,0.0024558211513949677,0.005683224027735958,0.08433385964562955,0.1530876308211367,0.552682513998552,0.041540953861963825,0.15707427865887852,0.0033647908239508363,0.006806756945542641,0.2388545165343244,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.9_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.9_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.9_no_sampler_val.xyz"", ""data/base_huber_q0.9_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.9_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.9_no_sampler"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/base_huber_q0.9_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10612094880019211,,,,,,0.0430526241925131,,,0.007084840652877539,,0.021366433040964007,,520300.0,0.10254749854695976,,,,1.5705181529803806e-05,,,,0.022027290752049854,,0.08433385964562955,,0.03889020560397747,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27516.154726852,,,,,0.2388545165343244,,,0.006806756945542641,,,0.0005,,,,,,,1751286031.6503975,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.9_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.9_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.9_no_sampler_val.xyz"", ""data/base_huber_q0.9_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.9_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.9_no_sampler"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/base_huber_q0.9_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.1911405014524467,,,,,0.0024945136822239404,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,104363.0,0.0033647908239508363,0.03031734012863151,0.552682513998552,,,3.199850037401357e-05,0.1530876308211367,,0.0008637788239086706,0.0022686240583407987,,,,0.01639344262295082,0.0024558211513949677,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27516},0.02952050621982827,,0.0048833928567666605,,,0.20842814930517525,,,,,,0.041540953861963825,0.15707427865887852,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.005037177704708847,0.005683224027735958,,,,,0.07518146684301387,,allegro_huber_loss_study/base_huber_q0.9_no_sampler,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_huber_q0.9_no_sampler_train.xyz,data/base_huber_q0.9_no_sampler_val.xyz|data/base_huber_q0.9_no_sampler_val_b.xyz,data/base_huber_q0.9_no_sampler_test.xyz,053fe93a,train:data/base_huber_q0.9_no_sampler_train.xyz|val:data/base_huber_q0.9_no_sampler_val.xyz|data/base_huber_q0.9_no_sampler_val_b.xyz|test:data/base_huber_q0.9_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
1,allegro_huber_loss_study,base_huber_q0.9_rare_sampling,45335.41650777,115063.0,1751304064.2202437,{'runtime': 45335},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.0005,0.10164869735937736,0.19172092124042417,0.020918427986187312,0.03261888793227116,0.0021572962794893084,0.004710982461363402,0.07635026387801958,0.025658831510292437,0.001872183236043818,2.825421704932368e-05,0.004260216544121874,0.012190985007475176,0.00047198696378281254,8.020440110433084e-06,0.002012833754820594,573800.0,0.10487019505037332,0.20303245159824904,0.021553049325501127,0.042417604768836936,0.0023419283335550187,0.005369724345500171,0.08360659357086206,0.1510671236728317,0.5116309105693935,0.030165550166699084,0.12528958493024622,0.002858530895607464,0.0061608555192550684,0.2143604503396316,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.9_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.9_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.9_rare_sampling_val.xyz"", ""data/base_huber_q0.9_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.9_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.9_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/base_huber_q0.9_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10487019505037332,,,,,,0.012190985007475176,,,0.002012833754820594,,0.020918427986187312,,573800.0,0.10164869735937736,,,,8.020440110433084e-06,,,,0.021553049325501127,,0.08360659357086206,,0.042417604768836936,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}",100.0,,,,45335.41650777,,,,,0.2143604503396316,,,0.0061608555192550684,,,0.0005,,,,,,,1751304064.2202437,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.9_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.9_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.9_rare_sampling_val.xyz"", ""data/base_huber_q0.9_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.9_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.9_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/base_huber_q0.9_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.19172092124042417,,,,,0.001872183236043818,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,115063.0,0.002858530895607464,0.025658831510292437,0.5116309105693935,,,2.825421704932368e-05,0.1510671236728317,,0.00047198696378281254,0.0021572962794893084,,,,0.01639344262295082,0.0023419283335550187,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 45335},0.03261888793227116,,0.004710982461363402,,,0.20303245159824904,,,,,,0.030165550166699084,0.12528958493024622,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.004260216544121874,0.005369724345500171,,,,,0.07635026387801958,,allegro_huber_loss_study/base_huber_q0.9_rare_sampling,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_huber_q0.9_rare_sampling_train.xyz,data/base_huber_q0.9_rare_sampling_val.xyz|data/base_huber_q0.9_rare_sampling_val_b.xyz,data/base_huber_q0.9_rare_sampling_test.xyz,b462b62a,train:data/base_huber_q0.9_rare_sampling_train.xyz|val:data/base_huber_q0.9_rare_sampling_val.xyz|data/base_huber_q0.9_rare_sampling_val_b.xyz|test:data/base_huber_q0.9_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
2,allegro_huber_loss_study,huber_q0.75_no_sampler,27562.568767414,104363.0,1751313678.0625737,{'runtime': 27563},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.0005,0.09586490689320916,0.18558980791802537,0.018466647122210272,0.025281528683871343,0.0018781806707149284,0.0039671995102656,0.07161284537072075,0.019121027913306835,0.001595118276971171,2.2509784170472633e-05,0.003179194862599396,0.028413435991210222,0.0005873641705961608,8.4097433063577e-06,0.004674462479475677,520300.0,0.0989994739460856,0.21374278982044015,0.019512303584701296,0.040656900061115775,0.002024177117616963,0.004732998496440818,0.08637756279266558,0.14143573916729668,0.5079161020643589,0.03131664115373205,0.13120427074116606,0.0027276790125348757,0.005596799114419472,0.2149057239733148,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.75_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.75_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.75_no_sampler_val.xyz"", ""data/huber_q0.75_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.75_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.75_no_sampler"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.75_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.09899947394608559,0.0989994739460856,,,,,,0.028413435991210222,,,0.004674462479475677,,0.018466647122210272,,520300.0,0.09586490689320916,,,,8.4097433063577e-06,,,,0.019512303584701296,,0.08637756279266558,,0.040656900061115775,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27562.568767414,,,,,0.2149057239733148,,,0.005596799114419472,,,0.0005,,,,,,,1751313678.0625737,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.75_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.75_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.75_no_sampler_val.xyz"", ""data/huber_q0.75_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.75_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.75_no_sampler"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.75_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.18558980791802537,,,,,0.001595118276971171,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,104363.0,0.0027276790125348757,0.019121027913306835,0.5079161020643589,,,2.2509784170472633e-05,0.14143573916729668,,0.0005873641705961608,0.0018781806707149284,,,,0.01639344262295082,0.002024177117616963,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27563},0.025281528683871343,,0.0039671995102656,,,0.21374278982044015,,,,,,0.03131664115373205,0.13120427074116606,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.003179194862599396,0.004732998496440818,,,,,0.07161284537072075,,allegro_huber_loss_study/huber_q0.75_no_sampler,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.75_no_sampler_train.xyz,data/huber_q0.75_no_sampler_val.xyz|data/huber_q0.75_no_sampler_val_b.xyz,data/huber_q0.75_no_sampler_test.xyz,baebf705,train:data/huber_q0.75_no_sampler_train.xyz|val:data/huber_q0.75_no_sampler_val.xyz|data/huber_q0.75_no_sampler_val_b.xyz|test:data/huber_q0.75_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
3,allegro_huber_loss_study,huber_q0.75_rare_sampling,45122.812204037,115063.0,1751349329.2986264,{'runtime': 45122},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.0005,0.0956961013168147,0.18625388452878777,0.017814298757240863,0.022279887636913867,0.0018188835066085824,0.00394157694898334,0.07082511637156166,0.01710283876188546,0.0011016187678594216,1.970259993377304e-05,0.002837953055465617,0.008668411872774203,0.0008271930319667777,2.922345322312547e-06,0.0014370070332102366,573800.0,0.09890520379498344,0.19383200519672472,0.01819860263590827,0.029267646727638073,0.0019692932780790407,0.004598940449563682,0.07589953079130882,0.1429352815478644,0.4754970589671423,0.02596946638510881,0.10327090241258668,0.002661688691639346,0.005383270247955538,0.19471707720922815,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.75_rare_sampling_val.xyz"", ""data/huber_q0.75_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.09890520379498344,,,,,,0.008668411872774203,,,0.0014370070332102366,,0.017814298757240863,,573800.0,0.0956961013168147,,,,2.922345322312547e-06,,,,0.01819860263590827,,0.07589953079130882,,0.029267646727638073,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",100.0,,,,45122.812204037,,,,,0.19471707720922815,,,0.005383270247955538,,,0.0005,,,,,,,1751349329.2986264,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.75_rare_sampling_val.xyz"", ""data/huber_q0.75_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.18625388452878777,,,,,0.0011016187678594216,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,115063.0,0.002661688691639346,0.01710283876188546,0.4754970589671423,,,1.970259993377304e-05,0.1429352815478644,,0.0008271930319667777,0.0018188835066085824,,,,0.01639344262295082,0.0019692932780790407,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 45122},0.022279887636913867,,0.00394157694898334,,,0.19383200519672472,,,,,,0.02596946638510881,0.10327090241258668,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.002837953055465617,0.004598940449563682,,,,,0.07082511637156166,,allegro_huber_loss_study/huber_q0.75_rare_sampling,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.75_rare_sampling_train.xyz,data/huber_q0.75_rare_sampling_val.xyz|data/huber_q0.75_rare_sampling_val_b.xyz,data/huber_q0.75_rare_sampling_test.xyz,3c50b7d5,train:data/huber_q0.75_rare_sampling_train.xyz|val:data/huber_q0.75_rare_sampling_val.xyz|data/huber_q0.75_rare_sampling_val_b.xyz|test:data/huber_q0.75_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
4,allegro_huber_loss_study,huber_q0.85_no_sampler,27713.593757072,104363.0,1751341475.7666037,{'runtime': 27714},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.001,0.10004657951810426,0.1890967723745727,0.021629762292590105,0.030552377897764316,0.002184422846086098,0.004633636851556048,0.07476092904129769,0.02926532786095441,0.0030968806996229613,3.782756925509674e-05,0.00487936947167085,0.04675922647033077,0.0011207619359973543,2.0441600381800285e-05,0.007700575518990082,520300.0,0.10342677513038656,0.19460440413266697,0.02221919305376378,0.03789733181728618,0.002332223513701258,0.0052360250038777,0.0792459203179436,0.1516042636432191,0.5059623558261507,0.03621416647157811,0.11610933848063608,0.003013244136298839,0.00615708240079623,0.20940959223586095,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_no_sampler_val.xyz"", ""data/huber_q0.85_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_no_sampler"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.85_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10342677513038656,,,,,,0.04675922647033077,,,0.007700575518990082,,0.021629762292590105,,520300.0,0.10004657951810426,,,,2.0441600381800285e-05,,,,0.02221919305376378,,0.0792459203179436,,0.03789733181728618,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27713.593757072,,,,,0.20940959223586095,,,0.00615708240079623,,,0.001,,,,,,,1751341475.7666037,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_no_sampler_val.xyz"", ""data/huber_q0.85_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_no_sampler"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.85_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.1890967723745727,,,,,0.0030968806996229613,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,104363.0,0.003013244136298839,0.02926532786095441,0.5059623558261507,,,3.782756925509674e-05,0.1516042636432191,,0.0011207619359973543,0.002184422846086098,,,,0.01639344262295082,0.002332223513701258,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27714},0.030552377897764316,,0.004633636851556048,,,0.19460440413266697,,,,,,0.03621416647157811,0.11610933848063608,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.00487936947167085,0.0052360250038777,,,,,0.07476092904129769,,allegro_huber_loss_study/huber_q0.85_no_sampler,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.85_no_sampler_train.xyz,data/huber_q0.85_no_sampler_val.xyz|data/huber_q0.85_no_sampler_val_b.xyz,data/huber_q0.85_no_sampler_test.xyz,7b84bd00,train:data/huber_q0.85_no_sampler_train.xyz|val:data/huber_q0.85_no_sampler_val.xyz|data/huber_q0.85_no_sampler_val_b.xyz|test:data/huber_q0.85_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
5,allegro_huber_loss_study,huber_q0.95_no_sampler,27483.138410892,104363.0,1751369043.809563,{'runtime': 27483},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.0005,0.10706347187996731,0.19498862000497336,0.022676686373921513,0.033499698846585095,0.002486155855743671,0.005305214472138326,0.0779311777745656,0.03878856525577862,0.0019296039181005392,3.83996104093518e-05,0.006421889131087775,0.06134663393034284,0.0013934255808103811,2.822652142125117e-05,0.010102804769759038,520300.0,0.11074331597777266,0.20831615944928017,0.02374168351538438,0.04608453689542308,0.002667628543013798,0.006114009238918273,0.08683823519454051,0.1594079837477951,0.5381227860839762,0.04307309360027093,0.14588555638410586,0.0032435404460738984,0.00687707524143402,0.23029513923650535,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.95_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.95_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.95_no_sampler_val.xyz"", ""data/huber_q0.95_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.95_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.95_no_sampler"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.95_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.95}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.95}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.11074331597777266,,,,,,0.06134663393034284,,,0.010102804769759038,,0.022676686373921513,,520300.0,0.10706347187996731,,,,2.822652142125117e-05,,,,0.02374168351538438,,0.08683823519454051,,0.04608453689542308,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.95}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27483.138410892,,,,,0.23029513923650535,,,0.00687707524143402,,,0.0005,,,,,,,1751369043.809563,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.95_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.95_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.95_no_sampler_val.xyz"", ""data/huber_q0.95_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.95_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.95_no_sampler"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.95_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.95}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.19498862000497336,,,,,0.0019296039181005392,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,104363.0,0.0032435404460738984,0.03878856525577862,0.5381227860839762,,,3.83996104093518e-05,0.1594079837477951,,0.0013934255808103811,0.002486155855743671,,,,0.01639344262295082,0.002667628543013798,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27483},0.033499698846585095,,0.005305214472138326,,,0.20831615944928017,,,,,,0.04307309360027093,0.14588555638410586,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.006421889131087775,0.006114009238918273,,,,,0.0779311777745656,,allegro_huber_loss_study/huber_q0.95_no_sampler,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.95_no_sampler_train.xyz,data/huber_q0.95_no_sampler_val.xyz|data/huber_q0.95_no_sampler_val_b.xyz,data/huber_q0.95_no_sampler_test.xyz,385d94aa,train:data/huber_q0.95_no_sampler_train.xyz|val:data/huber_q0.95_no_sampler_val.xyz|data/huber_q0.95_no_sampler_val_b.xyz|test:data/huber_q0.95_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
6,allegro_huber_loss_study,huber_q0.85_rare_sampling,45655.283691778,115063.0,1751395125.814844,{'runtime': 45655},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.00025,0.10071845964276048,0.19025008036494068,0.01940781377793282,0.02523645571036659,0.0020072829707943954,0.004333104540568548,0.07327321353862526,0.02091012328667329,0.0008664083106257384,2.177598916834802e-05,0.00345994164976682,0.009536574100866387,0.0003509688857457914,7.125805434982514e-06,0.0015749672158386688,573800.0,0.10415636207441492,0.2037011641141922,0.020247996086599423,0.03938619633342144,0.002226042503479916,0.005349976957046467,0.08281244580155335,0.14724314276224035,0.5185220064174889,0.030489752369354237,0.1313273673577477,0.0028188164372307156,0.00572410289284633,0.2185244922226943,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz"", ""data/huber_q0.85_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10415636207441492,,,,,,0.009536574100866387,,,0.0015749672158386688,,0.01940781377793282,,573800.0,0.10071845964276048,,,,7.125805434982514e-06,,,,0.020247996086599423,,0.08281244580155335,,0.03938619633342144,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}",100.0,,,,45655.283691778,,,,,0.2185244922226943,,,0.00572410289284633,,,0.00025,,,,,,,1751395125.814844,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz"", ""data/huber_q0.85_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.19025008036494068,,,,,0.0008664083106257384,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,115063.0,0.0028188164372307156,0.02091012328667329,0.5185220064174889,,,2.177598916834802e-05,0.14724314276224035,,0.0003509688857457914,0.0020072829707943954,,,,0.01639344262295082,0.002226042503479916,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 45655},0.02523645571036659,,0.004333104540568548,,,0.2037011641141922,,,,,,0.030489752369354237,0.1313273673577477,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.00345994164976682,0.005349976957046467,,,,,0.07327321353862526,,allegro_huber_loss_study/huber_q0.85_rare_sampling,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.85_rare_sampling_train.xyz,data/huber_q0.85_rare_sampling_val.xyz|data/huber_q0.85_rare_sampling_val_b.xyz,data/huber_q0.85_rare_sampling_test.xyz,b465f3b4,train:data/huber_q0.85_rare_sampling_train.xyz|val:data/huber_q0.85_rare_sampling_val.xyz|data/huber_q0.85_rare_sampling_val_b.xyz|test:data/huber_q0.85_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
7,allegro_huber_loss_study,huber_q0.85_rare_sampling,45655.283691778,115063.0,1751395125.814844,{'runtime': 45655},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.00025,0.10071845964276048,0.19025008036494068,0.01940781377793282,0.02523645571036659,0.0020072829707943954,0.004333104540568548,0.07327321353862526,0.02091012328667329,0.0008664083106257384,2.177598916834802e-05,0.00345994164976682,0.009536574100866387,0.0003509688857457914,7.125805434982514e-06,0.0015749672158386688,573800.0,0.10415636207441492,0.2037011641141922,0.020247996086599423,0.03938619633342144,0.002226042503479916,0.005349976957046467,0.08281244580155335,0.14724314276224035,0.5185220064174889,0.030489752369354237,0.1313273673577477,0.0028188164372307156,0.00572410289284633,0.2185244922226943,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz"", ""data/huber_q0.85_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10415636207441492,,,,,,0.0653028466144636,,,0.019493512966554095,,0.05250154717693558,,516200.0,0.1987573675745534,,,,0.0002722828670905252,,,,0.05251628302659434,,0.19533459656477617,,0.08713191594234171,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27223.893185831,,,,,,,,,,,3.90625e-06,,,,,,,1751578470.7956803,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,1.278432103962787,,,,,0.2594354609269759,0.32656200133938035,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103543.0,,0.1408767356094206,,,,0.01805672185260557,,,0.0005711161995599731,0.011439816605070596,,,,0.3796101609649174,0.011906557119822213,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27224},0.08704150203659579,,0.02378775921928318,,,0.4711439387077011,,,,,,,,,0.2938278376957023,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.14577448291405748,0.027727935044285605,,,,,0.4630871217395553,,allegro_huber_loss_study/huber_q0.85_rare_sampling,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.85_rare_sampling_train.xyz,data/huber_q0.85_rare_sampling_val.xyz|data/huber_q0.85_rare_sampling_val_b.xyz,data/huber_q0.85_rare_sampling_test.xyz,b465f3b4,train:data/huber_q0.85_rare_sampling_train.xyz|val:data/huber_q0.85_rare_sampling_val.xyz|data/huber_q0.85_rare_sampling_val_b.xyz|test:data/huber_q0.85_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
8,allegro_huber_loss_study,huber_q0.85_rare_sampling,45655.283691778,115063.0,1751395125.814844,{'runtime': 45655},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.00025,0.10071845964276048,0.19025008036494068,0.01940781377793282,0.02523645571036659,0.0020072829707943954,0.004333104540568548,0.07327321353862526,0.02091012328667329,0.0008664083106257384,2.177598916834802e-05,0.00345994164976682,0.009536574100866387,0.0003509688857457914,7.125805434982514e-06,0.0015749672158386688,573800.0,0.10415636207441492,0.2037011641141922,0.020247996086599423,0.03938619633342144,0.002226042503479916,0.005349976957046467,0.08281244580155335,0.14724314276224035,0.5185220064174889,0.030489752369354237,0.1313273673577477,0.0028188164372307156,0.00572410289284633,0.2185244922226943,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz"", ""data/huber_q0.85_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.201030216640029,,,,,,0.009536574100866387,,,0.0015749672158386688,,0.01940781377793282,,573800.0,0.10071845964276048,,,,7.125805434982514e-06,,,,0.020247996086599423,,0.08281244580155335,,0.03938619633342144,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}",100.0,,,,45655.283691778,,,,,0.2185244922226943,,,0.00572410289284633,,,0.00025,,,,,,,1751395125.814844,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz"", ""data/huber_q0.85_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.19025008036494068,,,,,0.0008664083106257384,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,115063.0,0.0028188164372307156,0.02091012328667329,0.5185220064174889,,,2.177598916834802e-05,0.14724314276224035,,0.0003509688857457914,0.0020072829707943954,,,,0.01639344262295082,0.002226042503479916,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 45655},0.02523645571036659,,0.004333104540568548,,,0.2037011641141922,,,,,,0.030489752369354237,0.1313273673577477,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.00345994164976682,0.005349976957046467,,,,,0.07327321353862526,,allegro_huber_loss_study/huber_q0.85_rare_sampling,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.85_rare_sampling_train.xyz,data/huber_q0.85_rare_sampling_val.xyz|data/huber_q0.85_rare_sampling_val_b.xyz,data/huber_q0.85_rare_sampling_test.xyz,b465f3b4,train:data/huber_q0.85_rare_sampling_train.xyz|val:data/huber_q0.85_rare_sampling_val.xyz|data/huber_q0.85_rare_sampling_val_b.xyz|test:data/huber_q0.85_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
9,allegro_huber_loss_study,huber_q0.85_rare_sampling,45655.283691778,115063.0,1751395125.814844,{'runtime': 45655},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.00025,0.10071845964276048,0.19025008036494068,0.01940781377793282,0.02523645571036659,0.0020072829707943954,0.004333104540568548,0.07327321353862526,0.02091012328667329,0.0008664083106257384,2.177598916834802e-05,0.00345994164976682,0.009536574100866387,0.0003509688857457914,7.125805434982514e-06,0.0015749672158386688,573800.0,0.10415636207441492,0.2037011641141922,0.020247996086599423,0.03938619633342144,0.002226042503479916,0.005349976957046467,0.08281244580155335,0.14724314276224035,0.5185220064174889,0.030489752369354237,0.1313273673577477,0.0028188164372307156,0.00572410289284633,0.2185244922226943,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz"", ""data/huber_q0.85_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.201030216640029,,,,,,0.0653028466144636,,,0.019493512966554095,,0.05250154717693558,,516200.0,0.1987573675745534,,,,0.0002722828670905252,,,,0.05251628302659434,,0.19533459656477617,,0.08713191594234171,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27223.893185831,,,,,,,,,,,3.90625e-06,,,,,,,1751578470.7956803,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,1.278432103962787,,,,,0.2594354609269759,0.32656200133938035,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103543.0,,0.1408767356094206,,,,0.01805672185260557,,,0.0005711161995599731,0.011439816605070596,,,,0.3796101609649174,0.011906557119822213,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27224},0.08704150203659579,,0.02378775921928318,,,0.4711439387077011,,,,,,,,,0.2938278376957023,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.14577448291405748,0.027727935044285605,,,,,0.4630871217395553,,allegro_huber_loss_study/huber_q0.85_rare_sampling,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.85_rare_sampling_train.xyz,data/huber_q0.85_rare_sampling_val.xyz|data/huber_q0.85_rare_sampling_val_b.xyz,data/huber_q0.85_rare_sampling_test.xyz,b465f3b4,train:data/huber_q0.85_rare_sampling_train.xyz|val:data/huber_q0.85_rare_sampling_val.xyz|data/huber_q0.85_rare_sampling_val_b.xyz|test:data/huber_q0.85_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
10,allegro_huber_loss_study,huber_q0.9_auto_delta_no_sampler,27961.077330671,104363.0,1751397088.19268,{'runtime': 27962},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.0005,0.10532127558090308,0.1922156496379939,0.022349822164649535,0.0338425518777787,0.002428136221391941,0.005170295095352786,0.0770761655370418,0.0367951524526701,0.0024135358057083187,3.786717146792285e-05,0.006102597031242713,0.05355447534986831,0.001401486733421215,5.814387185296245e-05,0.008850056292209056,520300.0,0.10898665858281392,0.2121624250559318,0.02447767033171998,0.053198341122281445,0.0025788912702683605,0.005883939885830646,0.09041490202134796,0.15502413776183288,0.5069878610354797,0.04661845219986803,0.14613396193182485,0.0033401968106807553,0.006744260890834702,0.21995536128604637,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.9_auto_delta_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.9_auto_delta_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.9_auto_delta_no_sampler_val.xyz"", ""data/huber_q0.9_auto_delta_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.9_auto_delta_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""forge.workflows.allegro_utils.callbacks.DeltaLoggerCallback""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.9_auto_delta_no_sampler"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.9_auto_delta_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",0.3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10898665858281392,,,,,,0.05355447534986831,,,0.008850056292209056,,0.022349822164649535,0.3,520300.0,0.10532127558090308,,,,5.814387185296245e-05,,,,0.02447767033171998,,0.09041490202134796,,0.053198341122281445,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27961.077330671,,,,,0.21995536128604637,,,0.006744260890834702,,,0.0005,,,,,,,1751397088.19268,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.9_auto_delta_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.9_auto_delta_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.9_auto_delta_no_sampler_val.xyz"", ""data/huber_q0.9_auto_delta_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.9_auto_delta_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""forge.workflows.allegro_utils.callbacks.DeltaLoggerCallback""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.9_auto_delta_no_sampler"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.9_auto_delta_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.1922156496379939,,,,,0.0024135358057083187,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,104363.0,0.0033401968106807553,0.0367951524526701,0.5069878610354797,,,3.786717146792285e-05,0.15502413776183288,,0.001401486733421215,0.002428136221391941,,,,0.01639344262295082,0.0025788912702683605,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27962},0.0338425518777787,,0.005170295095352786,,,0.2121624250559318,,,,,,0.04661845219986803,0.14613396193182485,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.006102597031242713,0.005883939885830646,,,,,0.0770761655370418,,allegro_huber_loss_study/huber_q0.9_auto_delta_no_sampler,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.9_auto_delta_no_sampler_train.xyz,data/huber_q0.9_auto_delta_no_sampler_val.xyz|data/huber_q0.9_auto_delta_no_sampler_val_b.xyz,data/huber_q0.9_auto_delta_no_sampler_test.xyz,3a73fc5d,train:data/huber_q0.9_auto_delta_no_sampler_train.xyz|val:data/huber_q0.9_auto_delta_no_sampler_val.xyz|data/huber_q0.9_auto_delta_no_sampler_val_b.xyz|test:data/huber_q0.9_auto_delta_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|DeltaLoggerCallback|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
11,allegro_huber_loss_study,huber_q0.95_rare_sampling,45130.554722154,115063.0,1751440399.6706252,{'runtime': 45130},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.0005,0.10690374897419104,0.19893652284837648,0.023365013635450196,0.037704388043181034,0.00246373558162794,0.005308773133254203,0.08064989467493723,0.03463175724085012,0.0024017205322725468,3.540555768065656e-05,0.005745730669259123,0.020078910568591457,0.0012894149669861624,1.6308053828673344e-05,0.003326129890890727,573800.0,0.11027253237395328,0.20377092852815243,0.024549002294225117,0.055831462072209785,0.002627653947881885,0.005962193943465806,0.08852152818127601,0.1571893070602095,0.5211100425065072,0.035922555458525865,0.12153422233470527,0.003397449350874239,0.007213527310777113,0.21661926405066315,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.95_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.95_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.95_rare_sampling_val.xyz"", ""data/huber_q0.95_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.95_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.95_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.95_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.95}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.95}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.11027253237395328,,,,,,0.020078910568591457,,,0.003326129890890727,,0.023365013635450196,,573800.0,0.10690374897419104,,,,1.6308053828673344e-05,,,,0.024549002294225117,,0.08852152818127601,,0.055831462072209785,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.95}, ""name"": ""forces_tail_huber""}]}",100.0,,,,45130.554722154,,,,,0.21661926405066315,,,0.007213527310777113,,,0.0005,,,,,,,1751440399.6706252,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.95_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.95_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.95_rare_sampling_val.xyz"", ""data/huber_q0.95_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.95_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.95_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.95_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.95}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.19893652284837648,,,,,0.0024017205322725468,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,115063.0,0.003397449350874239,0.03463175724085012,0.5211100425065072,,,3.540555768065656e-05,0.1571893070602095,,0.0012894149669861624,0.00246373558162794,,,,0.01639344262295082,0.002627653947881885,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 45130},0.037704388043181034,,0.005308773133254203,,,0.20377092852815243,,,,,,0.035922555458525865,0.12153422233470527,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.005745730669259123,0.005962193943465806,,,,,0.08064989467493723,,allegro_huber_loss_study/huber_q0.95_rare_sampling,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.95_rare_sampling_train.xyz,data/huber_q0.95_rare_sampling_val.xyz|data/huber_q0.95_rare_sampling_val_b.xyz,data/huber_q0.95_rare_sampling_test.xyz,fbad863a,train:data/huber_q0.95_rare_sampling_train.xyz|val:data/huber_q0.95_rare_sampling_val.xyz|data/huber_q0.95_rare_sampling_val_b.xyz|test:data/huber_q0.95_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
12,allegro_huber_loss_study,huber_q0.75_auto_delta_no_sampler,28085.648576833,104363.0,1751426119.064324,{'runtime': 28086},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.00025,0.09835322608971066,0.18558491775173253,0.018330397388335556,0.023334178086036297,0.0019441221445302456,0.0041332003155657715,0.07101743205111152,0.021263567966219497,0.0008670608557020237,2.192592245364908e-05,0.003518016994107859,0.03729862423893567,0.000466487467698297,1.4612878296383523e-05,0.00613415366839138,520300.0,0.10133447769559452,0.20595948927871896,0.018963546393111624,0.026532745827941545,0.002119009180640085,0.004995807866072853,0.07916268099091112,0.146444890304928,0.46788418180661207,0.028306688810599563,0.09223505380703202,0.002884732662313424,0.005958637379075483,0.1886926243309065,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.9_auto_delta_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.9_auto_delta_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.9_auto_delta_no_sampler_val.xyz"", ""data/huber_q0.9_auto_delta_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.75_auto_delta_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""forge.workflows.allegro_utils.callbacks.DeltaLoggerCallback""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.75_auto_delta_no_sampler"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.75_auto_delta_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",0.3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10133447769559452,,,,,,0.03729862423893567,,,0.00613415366839138,,0.018330397388335556,0.3,520300.0,0.09835322608971066,,,,1.4612878296383523e-05,,,,0.018963546393111624,,0.07916268099091112,,0.026532745827941545,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",100.0,,,,28085.648576833,,,,,0.1886926243309065,,,0.005958637379075483,,,0.00025,,,,,,,1751426119.064324,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.9_auto_delta_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.9_auto_delta_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.9_auto_delta_no_sampler_val.xyz"", ""data/huber_q0.9_auto_delta_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.75_auto_delta_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""forge.workflows.allegro_utils.callbacks.DeltaLoggerCallback""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.75_auto_delta_no_sampler"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.75_auto_delta_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.18558491775173253,,,,,0.0008670608557020237,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,104363.0,0.002884732662313424,0.021263567966219497,0.46788418180661207,,,2.192592245364908e-05,0.146444890304928,,0.000466487467698297,0.0019441221445302456,,,,0.01639344262295082,0.002119009180640085,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 28086},0.023334178086036297,,0.0041332003155657715,,,0.20595948927871896,,,,,,0.028306688810599563,0.09223505380703202,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.003518016994107859,0.004995807866072853,,,,,0.07101743205111152,,allegro_huber_loss_study/huber_q0.75_auto_delta_no_sampler,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.9_auto_delta_no_sampler_train.xyz,data/huber_q0.9_auto_delta_no_sampler_val.xyz|data/huber_q0.9_auto_delta_no_sampler_val_b.xyz,data/huber_q0.9_auto_delta_no_sampler_test.xyz,3a73fc5d,train:data/huber_q0.9_auto_delta_no_sampler_train.xyz|val:data/huber_q0.9_auto_delta_no_sampler_val.xyz|data/huber_q0.9_auto_delta_no_sampler_val_b.xyz|test:data/huber_q0.9_auto_delta_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|DeltaLoggerCallback|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
13,allegro_huber_loss_study,nequip_huber_q0.9_auto_delta_rare_sampling,62350.864472038,115063.0,1751468494.8686988,{'runtime': 62351},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.001,0.1243067864757715,0.22284850676756593,0.03157018346181418,0.09536580258340416,0.0020167471674889287,0.004771770947958044,0.10766202676630936,0.07524786616066276,0.008415898664864419,7.025051425418287e-05,0.012531263704659032,0.025883917116046463,0.001336843120702731,1.480413658139178e-05,0.004277315100167819,573800.0,0.12783655651658135,0.2212420807539287,0.03309372964068066,0.09378672840589236,0.0021138365880348326,0.005475882917013324,0.1068348973589448,0.18110219935300997,0.5409799310101404,0.05433494059624811,0.12985270353021822,0.003532330720958652,0.006052321416341167,0.2256283186522333,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.9_auto_delta_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.9_auto_delta_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.9_auto_delta_rare_sampling_val.xyz"", ""data/huber_q0.9_auto_delta_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/nequip_huber_q0.9_auto_delta_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""forge.workflows.allegro_utils.callbacks.DeltaLoggerCallback""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""nequip_huber_q0.9_auto_delta_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/nequip_huber_q0.9_auto_delta_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.NequIPGNNModel"", ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_bessels"": 8, ""num_features"": 32, ""num_layers"": 3, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""polynomial_cutoff_p"": 8, ""r_max"": 5, ""radial_mlp_depth"": 3, ""radial_mlp_width"": 128, ""seed"": 42, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.7.0"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""nequip.model.NequIPGNNModel"", ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_bessels"": 8, ""num_features"": 32, ""num_layers"": 3, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""polynomial_cutoff_p"": 8, ""r_max"": 5, ""radial_mlp_depth"": 3, ""radial_mlp_width"": 128, ""seed"": 42, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",0.8244919025808276,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.12783655651658135,,,,,,0.025883917116046463,,,0.004277315100167819,,0.03157018346181418,0.8244919025808276,573800.0,0.1243067864757715,,,,1.480413658139178e-05,,,,0.03309372964068066,,0.1068348973589448,,0.09378672840589236,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}",100.0,,,,62350.864472038,,,,,0.2256283186522333,,,0.006052321416341167,,,0.001,,,,,,,1751468494.8686988,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.9_auto_delta_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.9_auto_delta_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.9_auto_delta_rare_sampling_val.xyz"", ""data/huber_q0.9_auto_delta_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/nequip_huber_q0.9_auto_delta_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""forge.workflows.allegro_utils.callbacks.DeltaLoggerCallback""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""nequip_huber_q0.9_auto_delta_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/nequip_huber_q0.9_auto_delta_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.NequIPGNNModel"", ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_bessels"": 8, ""num_features"": 32, ""num_layers"": 3, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""polynomial_cutoff_p"": 8, ""r_max"": 5, ""radial_mlp_depth"": 3, ""radial_mlp_width"": 128, ""seed"": 42, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.7.0"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}",allegro_huber_loss_study,0.22284850676756593,,,,,0.008415898664864419,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,115063.0,0.003532330720958652,0.07524786616066276,0.5409799310101404,,,7.025051425418287e-05,0.18110219935300997,,0.001336843120702731,0.0020167471674889287,,,,0.01639344262295082,0.0021138365880348326,"{""_target_"": ""nequip.model.NequIPGNNModel"", ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_bessels"": 8, ""num_features"": 32, ""num_layers"": 3, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""polynomial_cutoff_p"": 8, ""r_max"": 5, ""radial_mlp_depth"": 3, ""radial_mlp_width"": 128, ""seed"": 42, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 62351},0.09536580258340416,,0.004771770947958044,,,0.2212420807539287,,,,,,0.05433494059624811,0.12985270353021822,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.012531263704659032,0.005475882917013324,,,,,0.10766202676630936,,allegro_huber_loss_study/nequip_huber_q0.9_auto_delta_rare_sampling,5.0,3.0,2.0,float32,42.0,32.03126333894399,,,,,,,,False,False,False,,,,,,data/huber_q0.9_auto_delta_rare_sampling_train.xyz,data/huber_q0.9_auto_delta_rare_sampling_val.xyz|data/huber_q0.9_auto_delta_rare_sampling_val_b.xyz,data/huber_q0.9_auto_delta_rare_sampling_test.xyz,a0330c52,train:data/huber_q0.9_auto_delta_rare_sampling_train.xyz|val:data/huber_q0.9_auto_delta_rare_sampling_val.xyz|data/huber_q0.9_auto_delta_rare_sampling_val_b.xyz|test:data/huber_q0.9_auto_delta_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|DeltaLoggerCallback|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
14,allegro_huber_loss_study,huber_q0.9_auto_delta_rare_sampling,46477.566109615,115063.0,1751487020.119583,{'runtime': 46478},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.0005,0.10520319911416696,0.19328306958662017,0.02239713377058121,0.036746058328388,0.002353096662626464,0.004983634967721352,0.0783375876275765,0.03164657884160899,0.002859305926615766,3.239651537863486e-05,0.005261392132977663,0.01169865693697553,0.0005724718217432709,1.262814276893938e-05,0.0019375483332777956,573800.0,0.10888038230114729,0.2123254541739059,0.024314689077948225,0.054656480236747226,0.0025666789548605706,0.0059403233374479905,0.0909740859160337,0.15408116230272442,0.4782317692222134,0.038471099910555945,0.11324035072291552,0.003347305639162699,0.006931940084061545,0.1994680200097301,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.9_auto_delta_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.9_auto_delta_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.9_auto_delta_rare_sampling_val.xyz"", ""data/huber_q0.9_auto_delta_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.9_auto_delta_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""forge.workflows.allegro_utils.callbacks.DeltaLoggerCallback""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.9_auto_delta_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.9_auto_delta_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",0.6194429460443844,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10888038230114729,,,,,,0.01169865693697553,,,0.0019375483332777956,,0.02239713377058121,0.6194429460443844,573800.0,0.10520319911416696,,,,1.262814276893938e-05,,,,0.024314689077948225,,0.0909740859160337,,0.054656480236747226,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}",100.0,,,,46477.566109615,,,,,0.1994680200097301,,,0.006931940084061545,,,0.0005,,,,,,,1751487020.119583,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.9_auto_delta_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.9_auto_delta_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.9_auto_delta_rare_sampling_val.xyz"", ""data/huber_q0.9_auto_delta_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.9_auto_delta_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""forge.workflows.allegro_utils.callbacks.DeltaLoggerCallback""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.9_auto_delta_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.9_auto_delta_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.9}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.19328306958662017,,,,,0.002859305926615766,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,115063.0,0.003347305639162699,0.03164657884160899,0.4782317692222134,,,3.239651537863486e-05,0.15408116230272442,,0.0005724718217432709,0.002353096662626464,,,,0.01639344262295082,0.0025666789548605706,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 46478},0.036746058328388,,0.004983634967721352,,,0.2123254541739059,,,,,,0.038471099910555945,0.11324035072291552,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.005261392132977663,0.0059403233374479905,,,,,0.0783375876275765,,allegro_huber_loss_study/huber_q0.9_auto_delta_rare_sampling,5.0,2.0,2.0,float32,42.0,32.03126333894399,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.9_auto_delta_rare_sampling_train.xyz,data/huber_q0.9_auto_delta_rare_sampling_val.xyz|data/huber_q0.9_auto_delta_rare_sampling_val_b.xyz,data/huber_q0.9_auto_delta_rare_sampling_test.xyz,a0330c52,train:data/huber_q0.9_auto_delta_rare_sampling_train.xyz|val:data/huber_q0.9_auto_delta_rare_sampling_val.xyz|data/huber_q0.9_auto_delta_rare_sampling_val_b.xyz|test:data/huber_q0.9_auto_delta_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|DeltaLoggerCallback|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
15,allegro_additive_loss_study,base_only_no_sampler,22825.339144802,39273.0,1751080482.673604,{'runtime': 22826},150.0,,0.01639344262295082,0.819672131147541,3.125e-05,0.2943156534809359,1.8204004731050576,0.0825492154595221,1.5516010838965608,0.004191598679491022,0.013107335598538003,1.1283696308667188,,0.45755738487226777,0.0043040907674846375,0.0136306635328269,,0.001035500406771364,5.488379125433156e-05,0.002578986861602468,194100.0,0.29254254598060386,0.9202100665119336,0.07137551789911627,1.191358521567361,0.00745086024177894,0.3016239840664499,0.8043975240485816,0.6971637516254716,11.910046237402549,0.6204594865778928,2.2193081538075177,0.011586509828564854,0.0923660622077324,4.7405734844726,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/base_only_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/base_only_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/base_only_no_sampler_val.xyz"", ""data/base_only_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_only_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_only_no_sampler"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_only_no_sampler""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,0.16393442622950818,0.015870855225594123,0.01535385085882626,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.29254254598060386,,,,,,,,,0.002578986861602468,,0.0825492154595221,,194100.0,0.2943156534809359,,,0.16393442622950818,5.488379125433156e-05,,,,0.07137551789911627,,0.8043975240485816,,1.191358521567361,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",150.0,,,,22825.339144802,,,,,4.7405734844726,,,0.0923660622077324,,,3.125e-05,,,,,,,1751080482.673604,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/base_only_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/base_only_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/base_only_no_sampler_val.xyz"", ""data/base_only_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_only_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_only_no_sampler"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_only_no_sampler""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_additive_loss_study,1.8204004731050576,,,,,0.45755738487226777,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,39273.0,0.011586509828564854,,11.910046237402549,,,0.0043040907674846375,0.6971637516254716,,0.001035500406771364,0.004191598679491022,0.015870855225594123,,,0.01639344262295082,0.00745086024177894,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 22826},1.5516010838965608,,0.013107335598538003,,,0.9202100665119336,,,,,,0.6204594865778928,2.2193081538075177,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.0136306635328269,0.3016239840664499,0.01535385085882626,,,,1.1283696308667188,,allegro_additive_loss_study/base_only_no_sampler,5.0,2.0,2.0,float32,42.0,32.006362324321195,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_only_no_sampler_train.xyz,data/base_only_no_sampler_val.xyz|data/base_only_no_sampler_val_b.xyz,data/base_only_no_sampler_test.xyz,0c9545ca,train:data/base_only_no_sampler_train.xyz|val:data/base_only_no_sampler_val.xyz|data/base_only_no_sampler_val_b.xyz|test:data/base_only_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|forces_auto_stratified_huber(coeff=10)|stress_mse(coeff=50),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
16,allegro_additive_loss_study,base_only_rare_sampling,21779.6243799,28127.0,1751087184.5547774,{'runtime': 21779},95.0,,0.01639344262295082,0.819672131147541,1.5625e-05,1.0176361129943658,11.486639831689889,10.147781343613069,10.39875866575634,0.21935116762966744,0.3969454659518299,7.427447987799352,,0.5755095477075444,0.014533823616463182,0.024129086329666892,,0.0007363073864842976,5.225715434002603e-05,0.002056659106179321,139199.0,0.30092919283198466,2.686971149495735,0.05394927428611249,0.9769004545811768,0.004490608132085033,0.013212103573263669,1.2256945692167251,0.8335889244564026,9.563919429290593,0.8429100318193302,4.582640946270267,0.01579351058746483,0.09478837891865052,4.747116251493169,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/base_only_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/base_only_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/base_only_rare_sampling_val.xyz"", ""data/base_only_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_only_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_only_rare_sampling"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_only_rare_sampling""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,0.16393442622950818,0.016967353757897697,0.012210704037345298,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.30092919283198466,,,,,,,,,0.002056659106179321,,10.147781343613069,,139199.0,1.0176361129943658,,,0.16393442622950818,5.225715434002603e-05,,,,0.05394927428611249,,1.2256945692167251,,0.9769004545811768,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",95.0,,,,21779.6243799,,,,,4.747116251493169,,,0.09478837891865052,,,1.5625e-05,,,,,,,1751087184.5547774,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/base_only_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/base_only_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/base_only_rare_sampling_val.xyz"", ""data/base_only_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_only_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_only_rare_sampling"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_only_rare_sampling""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_additive_loss_study,11.486639831689889,,,,,0.5755095477075444,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,28127.0,0.01579351058746483,,9.563919429290593,,,0.014533823616463182,0.8335889244564026,,0.0007363073864842976,0.21935116762966744,0.016967353757897697,,,0.01639344262295082,0.004490608132085033,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 21779},10.39875866575634,,0.3969454659518299,,,2.686971149495735,,,,,,0.8429100318193302,4.582640946270267,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.024129086329666892,0.013212103573263669,0.012210704037345298,,,,7.427447987799352,,allegro_additive_loss_study/base_only_rare_sampling,5.0,2.0,2.0,float32,42.0,32.00510198382953,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_only_rare_sampling_train.xyz,data/base_only_rare_sampling_val.xyz|data/base_only_rare_sampling_val_b.xyz,data/base_only_rare_sampling_test.xyz,a9b86807,train:data/base_only_rare_sampling_train.xyz|val:data/base_only_rare_sampling_val.xyz|data/base_only_rare_sampling_val_b.xyz|test:data/base_only_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|forces_auto_stratified_huber(coeff=10)|stress_mse(coeff=50),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,95.0,95.0
17,allegro_additive_loss_study,focal_force_no_sampler,23363.977384899,39273.0,1751106467.178486,{'runtime': 23364},150.0,,0.01408450704225352,0.704225352112676,1e-06,0.24865066574781447,2.0035463024886977,0.07558811758301956,0.6545128022772391,0.0061760085728415,0.02052700630915044,0.892862037025029,,0.5575671447189253,0.00726739761985963,0.026718013473131887,,0.002821878540275746,0.0001069124485591221,0.008586528279193185,194100.0,0.24974902168508545,0.8013435130963054,0.09236391396528838,1.098107834885438,0.009257865680339816,0.3032911122500173,0.7342474867439202,0.8861832532546279,33.800044760033096,0.5780352682120519,1.7378933165305377,0.01463003509856185,0.1108941680616862,11.882944081541773,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/focal_force_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/focal_force_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/focal_force_no_sampler_val.xyz"", ""data/focal_force_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/focal_force_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""focal_force_no_sampler"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/focal_force_no_sampler""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.10049593893954138}, ""name"": ""forces_focal_focal_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.10049593893954138}, ""name"": ""forces_focal_focal_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,0.14084507042253522,0.01545516505268532,0.018969695922534634,0.14084507042253522,0.08214902803536038,0.0411779047629138,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.24974902168508545,,,,,,,,,0.008586528279193185,,0.07558811758301956,,194100.0,0.24865066574781447,,,0.14084507042253522,0.0001069124485591221,0.08214902803536038,,,0.09236391396528838,,0.7342474867439202,,1.098107834885438,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.10049593893954138}, ""name"": ""forces_focal_focal_mse""}]}",150.0,,,,23363.977384899,,,,,11.882944081541773,0.0411779047629138,,0.1108941680616862,,,1e-06,,,,,,,1751106467.178486,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/focal_force_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/focal_force_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/focal_force_no_sampler_val.xyz"", ""data/focal_force_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/focal_force_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""focal_force_no_sampler"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/focal_force_no_sampler""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.10049593893954138}, ""name"": ""forces_focal_focal_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_additive_loss_study,2.0035463024886977,,,,,0.5575671447189253,0.704225352112676,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,39273.0,0.01463003509856185,,33.800044760033096,,,0.00726739761985963,0.8861832532546279,,0.002821878540275746,0.0061760085728415,0.01545516505268532,,,0.01408450704225352,0.009257865680339816,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 23364},0.6545128022772391,,0.02052700630915044,,,0.8013435130963054,,,,0.14084507042253522,,0.5780352682120519,1.7378933165305377,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.026718013473131887,0.3032911122500173,0.018969695922534634,,,,0.892862037025029,,allegro_additive_loss_study/focal_force_no_sampler,5.0,2.0,2.0,float32,42.0,32.006362324321195,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/focal_force_no_sampler_train.xyz,data/focal_force_no_sampler_val.xyz|data/focal_force_no_sampler_val_b.xyz,data/focal_force_no_sampler_test.xyz,309529de,train:data/focal_force_no_sampler_train.xyz|val:data/focal_force_no_sampler_val.xyz|data/focal_force_no_sampler_val_b.xyz|test:data/focal_force_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|forces_auto_stratified_huber(coeff=10)|stress_mse(coeff=50)|forces_focal_focal_mse(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
18,allegro_additive_loss_study,base_force_angle_focal_stress_shear_rare_sampling_softadapt,31496.68798022,41643.0,1751117991.468671,{'runtime': 31496},150.0,,0.2046462966200051,0.24153861173275065,1e-06,0.37294432493398527,1.2343619601347982,0.10537152987385848,0.5416549828664338,0.030093973977044823,0.05833887582814618,0.6114519396097927,,0.6344773597643052,0.017968970558022396,0.2396708510963692,,0.0031442255910100222,0.00044988336372682816,0.13123679105704317,205950.0,0.3779215357857542,1.535099379578741,0.10594176940492128,0.463483922364996,0.03018618555723026,0.057831002899398624,0.6854714349477119,0.9869078387118227,14.044814824330292,0.8770105026194921,2.156025884882082,0.04471683910951992,0.15023700225673697,5.45035923715637,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_softadapt"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,0.0910826151523685,0.10300413075129618,0.037454017073499025,0.22676862307830364,0.235963853416572,0.4216516239138472,0.0020679656966536334,0.5562971475246503,0.003909601949886835,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.3779215357857542,,,,,,,0.5562971475246503,,0.13123679105704317,,0.10537152987385848,,205950.0,0.37294432493398527,,,,0.00044988336372682816,0.10300413075129618,,,0.10594176940492128,,0.6854714349477119,,0.463483922364996,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}",150.0,,,,31496.68798022,,,,,5.45035923715637,0.037454017073499025,,0.15023700225673697,,,1e-06,,,0.0020679656966536334,,,,1751117991.468671,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_softadapt"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}",allegro_additive_loss_study,1.2343619601347982,,,0.4216516239138472,,0.6344773597643052,0.24153861173275065,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,41643.0,0.04471683910951992,,14.044814824330292,,,0.017968970558022396,0.9869078387118227,,0.0031442255910100222,0.030093973977044823,,,,0.2046462966200051,0.03018618555723026,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 31496},0.5416549828664338,,0.05833887582814618,,,1.535099379578741,,0.235963853416572,,0.0910826151523685,,0.8770105026194921,2.156025884882082,0.22676862307830364,,,0.003909601949886835,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.2396708510963692,0.057831002899398624,,,,,0.6114519396097927,,allegro_additive_loss_study/base_force_angle_focal_stress_shear_rare_sampling_softadapt,5.0,2.0,2.0,float32,42.0,32.00510198382953,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_train.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val_b.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_test.xyz,e31a340a,train:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_train.xyz|val:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val_b.xyz|test:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_focal_focal_mse(coeff=10)|forces_angle_forces_angle(coeff=10)|stress_shear_stress_shear_mae(coeff=25),val1_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
19,allegro_additive_loss_study,base_force_angle_focal_stress_shear_rare_sampling_no_softadapt,31493.245276509,41643.0,1751118180.2215824,{'runtime': 31494},150.0,,0.010416666666666666,0.5208333333333334,1e-06,0.4433531901967429,1.4059191310317931,0.2056632557366795,0.5251478502914606,0.0392951622282898,0.07635586919290092,0.6691409501720516,,0.6602066640561306,0.017532661995088246,0.06765200440185656,,0.001279648726744349,8.913860182004722e-05,0.06157394220020891,205950.0,0.4462630921260523,1.4047302720766552,0.22146711114735923,0.6176060297628223,0.038710585667041976,0.07498870590735081,0.6991083359156095,1.2529700351094022,12.610716755096444,1.5591466521503226,5.061394447283483,0.06244342549579877,0.17770490099546196,5.949938701125129,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_no_softadapt"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,0.10416666666666669,0.08669707394949808,0.03424001031295925,0.10416666666666669,0.2604166666666667,0.4050944696387244,0.0015934889154184772,0.5499428500151763,0.002541330764838125,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.4462630921260523,,,,,,,0.5499428500151763,,0.06157394220020891,,0.2056632557366795,,205950.0,0.4433531901967429,,,,8.913860182004722e-05,0.08669707394949808,,,0.22146711114735923,,0.6991083359156095,,0.6176060297628223,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}",150.0,,,,31493.245276509,,,,,5.949938701125129,0.03424001031295925,,0.17770490099546196,,,1e-06,,,0.0015934889154184772,,,,1751118180.2215824,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_no_softadapt"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}",allegro_additive_loss_study,1.4059191310317931,,,0.4050944696387244,,0.6602066640561306,0.5208333333333334,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,41643.0,0.06244342549579877,,12.610716755096444,,,0.017532661995088246,1.2529700351094022,,0.001279648726744349,0.0392951622282898,,,,0.010416666666666666,0.038710585667041976,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 31494},0.5251478502914606,,0.07635586919290092,,,1.4047302720766552,,0.2604166666666667,,0.10416666666666669,,1.5591466521503226,5.061394447283483,0.10416666666666669,,,0.002541330764838125,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.06765200440185656,0.07498870590735081,,,,,0.6691409501720516,,allegro_additive_loss_study/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt,5.0,2.0,2.0,float32,42.0,32.00510198382953,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_train.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val_b.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_test.xyz,71ef0ad8,train:data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_train.xyz|val:data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val_b.xyz|test:data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_focal_focal_mse(coeff=10)|forces_angle_forces_angle(coeff=10)|stress_shear_stress_shear_mae(coeff=25),val1_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
20,allegro_additive_loss_study,focal_force_rare_sampling,36714.269908696,43983.0,1751124013.9033878,{'runtime': 36714},150.0,,0.01408450704225352,0.704225352112676,1e-06,0.25446021237813377,0.6637694183268978,0.08409319083583541,0.7179358748430101,0.0068552948511824904,0.016825432926310196,0.4661769086987394,,0.6214929396580243,0.016583559922412946,0.03448168208677901,,0.005914622312546938,0.00014326933831870106,0.008296900733413696,217650.0,0.2618203331385906,1.4026257791128685,0.07583738115108077,0.4530782489213353,0.00710394402758544,0.016809776694739667,0.6241712682429811,0.8975595079318663,30.422030865962565,0.7099950432611127,2.397374420924843,0.017305409316393874,0.11265393565696294,10.977353074181456,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/focal_force_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/focal_force_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/focal_force_rare_sampling_val.xyz"", ""data/focal_force_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/focal_force_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""focal_force_rare_sampling"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/focal_force_rare_sampling""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,0.14084507042253522,0.01556221765148677,0.018816149134760544,0.14084507042253522,0.08419063158677703,0.0387840371496285,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.2618203331385906,,,,,,,,,0.008296900733413696,,0.08409319083583541,,217650.0,0.25446021237813377,,,0.14084507042253522,0.00014326933831870106,0.08419063158677703,,,0.07583738115108077,,0.6241712682429811,,0.4530782489213353,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}]}",150.0,,,,36714.269908696,,,,,10.977353074181456,0.0387840371496285,,0.11265393565696294,,,1e-06,,,,,,,1751124013.9033878,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/focal_force_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/focal_force_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/focal_force_rare_sampling_val.xyz"", ""data/focal_force_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/focal_force_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""focal_force_rare_sampling"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/focal_force_rare_sampling""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_additive_loss_study,0.6637694183268978,,,,,0.6214929396580243,0.704225352112676,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,43983.0,0.017305409316393874,,30.422030865962565,,,0.016583559922412946,0.8975595079318663,,0.005914622312546938,0.0068552948511824904,0.01556221765148677,,,0.01408450704225352,0.00710394402758544,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 36714},0.7179358748430101,,0.016825432926310196,,,1.4026257791128685,,,,0.14084507042253522,,0.7099950432611127,2.397374420924843,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.03448168208677901,0.016809776694739667,0.018816149134760544,,,,0.4661769086987394,,allegro_additive_loss_study/focal_force_rare_sampling,5.0,2.0,2.0,float32,42.0,32.00510198382953,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/focal_force_rare_sampling_train.xyz,data/focal_force_rare_sampling_val.xyz|data/focal_force_rare_sampling_val_b.xyz,data/focal_force_rare_sampling_test.xyz,2200fc23,train:data/focal_force_rare_sampling_train.xyz|val:data/focal_force_rare_sampling_val.xyz|data/focal_force_rare_sampling_val_b.xyz|test:data/focal_force_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|forces_auto_stratified_huber(coeff=10)|stress_mse(coeff=50)|forces_focal_focal_mse(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
21,allegro_additive_loss_study,force_angle_no_sampler,23361.235987972,39273.0,1751129940.4528687,{'runtime': 23361},150.0,,0.01408450704225352,0.704225352112676,6.25e-05,0.2191991014140248,1.157527873093095,0.06154889453690968,0.5567764982035459,0.00483170493784017,0.016496843796618522,0.5769337383644197,,0.5358071055883482,0.0070998509689367,0.062384903259051064,,0.0007034157125442841,8.141091465502676e-05,0.04835050390901991,194100.0,0.2195652166890109,0.936656311498842,0.07933128992743824,1.2167741980496225,0.007984735892433084,0.30191140778090786,0.8184473057764574,0.6250273447778307,8.221913027366368,0.6065108832217385,2.3865359793567285,0.01250815802775511,0.09137393087859556,3.56660764586723,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/force_angle_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/force_angle_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/force_angle_no_sampler_val.xyz"", ""data/force_angle_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/force_angle_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""force_angle_no_sampler"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/force_angle_no_sampler""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_force_angle""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_force_angle""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,0.14084507042253522,0.014763430967944824,0.017057466911907807,,,,,,,,,,0.14084507042253522,0.3390894167677994,0.325753714697604,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.2195652166890109,,,,,,,,0.14084507042253522,0.04835050390901991,,0.06154889453690968,,194100.0,0.2191991014140248,,,0.14084507042253522,8.141091465502676e-05,,,,0.07933128992743824,,0.8184473057764574,,1.2167741980496225,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_force_angle""}]}",150.0,,,,23361.235987972,,,,,3.56660764586723,,,0.09137393087859556,,,6.25e-05,,,,,,,1751129940.4528687,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/force_angle_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/force_angle_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/force_angle_no_sampler_val.xyz"", ""data/force_angle_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/force_angle_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""force_angle_no_sampler"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/force_angle_no_sampler""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_force_angle""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_additive_loss_study,1.157527873093095,,,,,0.5358071055883482,0.704225352112676,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,39273.0,0.01250815802775511,,8.221913027366368,,,0.0070998509689367,0.6250273447778307,,0.0007034157125442841,0.00483170493784017,0.014763430967944824,,,0.01408450704225352,0.007984735892433084,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 23361},0.5567764982035459,,0.016496843796618522,,,0.936656311498842,,,,,,0.6065108832217385,2.3865359793567285,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.062384903259051064,0.30191140778090786,0.017057466911907807,,,0.3390894167677994,0.5769337383644197,0.325753714697604,allegro_additive_loss_study/force_angle_no_sampler,5.0,2.0,2.0,float32,42.0,32.006362324321195,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/force_angle_no_sampler_train.xyz,data/force_angle_no_sampler_val.xyz|data/force_angle_no_sampler_val_b.xyz,data/force_angle_no_sampler_test.xyz,850c4982,train:data/force_angle_no_sampler_train.xyz|val:data/force_angle_no_sampler_val.xyz|data/force_angle_no_sampler_val_b.xyz|test:data/force_angle_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|forces_auto_stratified_huber(coeff=10)|stress_mse(coeff=50)|forces_angle_force_angle(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
22,allegro_additive_loss_study,base_force_angle_focal_stress_shear_rare_sampling_softadapt_equal,30113.154287588,41643.0,1751148213.205392,{'runtime': 30113},150.0,,0.12793385422433529,0.2585460671596649,1e-06,0.5182121996499212,1.296208585699279,0.14619669085596787,0.421487106381077,0.05553488788382755,0.10111475971335664,0.6062701505979043,,0.6377971813166365,0.01795532816586644,0.18232505311348848,,0.0031878783111099537,0.00044599755963518114,0.10930307473007306,205950.0,0.523275595370007,1.5016561661757546,0.16787344479873192,0.6790830121715613,0.05509587974894087,0.1005282180538331,0.7604224654670496,1.3604805547809429,13.379333550034548,1.4996720967823218,4.768920235252235,0.06681109691685723,0.18509301660023583,6.111115600629005,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_equal"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_softadapt_equal"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_equal""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,0.1731033700125922,0.09979069170431049,0.03792585401472753,0.18428307525854384,0.2561336333448638,0.4248455138510974,0.002034013157133078,0.5501555445902818,0.003242360157437518,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.523275595370007,,,,,,,0.5501555445902818,,0.10930307473007306,,0.14619669085596787,,205950.0,0.5182121996499212,,,,0.00044599755963518114,0.09979069170431049,,,0.16787344479873192,,0.7604224654670496,,0.6790830121715613,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}",150.0,,,,30113.154287588,,,,,6.111115600629005,0.03792585401472753,,0.18509301660023583,,,1e-06,,,0.002034013157133078,,,,1751148213.205392,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_equal"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_softadapt_equal"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_equal""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}",allegro_additive_loss_study,1.296208585699279,,,0.4248455138510974,,0.6377971813166365,0.2585460671596649,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,41643.0,0.06681109691685723,,13.379333550034548,,,0.01795532816586644,1.3604805547809429,,0.0031878783111099537,0.05553488788382755,,,,0.12793385422433529,0.05509587974894087,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 30113},0.421487106381077,,0.10111475971335664,,,1.5016561661757546,,0.2561336333448638,,0.1731033700125922,,1.4996720967823218,4.768920235252235,0.18428307525854384,,,0.003242360157437518,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.18232505311348848,0.1005282180538331,,,,,0.6062701505979043,,allegro_additive_loss_study/base_force_angle_focal_stress_shear_rare_sampling_softadapt_equal,5.0,2.0,2.0,float32,42.0,32.00510198382953,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_train.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val_b.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_test.xyz,e31a340a,train:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_train.xyz|val:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_val_b.xyz|test:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_focal_focal_mse(coeff=1)|forces_angle_forces_angle(coeff=1)|stress_shear_stress_shear_mae(coeff=1),val1_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
23,allegro_additive_loss_study,base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_equal,30226.147984067,41643.0,1751148509.7810235,{'runtime': 30226},150.0,,0.2,0.2,1e-06,0.5183344684622745,1.3133627447311442,0.14684551867716095,0.4195480422531981,0.05577098273424969,0.10155314196041584,0.6114879763149194,,0.6419692218319988,0.01801984732713502,0.2390155889661154,,0.0027366539414604356,0.0004678146877217457,0.11984497527356552,205950.0,0.5230045423462741,1.5574568690371684,0.16902846675636982,0.6960652894703423,0.05534322319397217,0.10100011650655975,0.7848407583380235,1.3848096406801107,13.966317846587994,1.5058080301925865,4.7888210624978385,0.06699310850873537,0.1854637890630927,6.313534232716307,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_equal"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_equal"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_equal""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,0.2,0.10436389972178362,0.03743109702958827,0.2,0.2,0.4286115542440325,0.002113421705627097,0.5551215185970181,0.003467792112039098,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.5230045423462741,,,,,,,0.5551215185970181,,0.11984497527356552,,0.14684551867716095,,205950.0,0.5183344684622745,,,,0.0004678146877217457,0.10436389972178362,,,0.16902846675636982,,0.7848407583380235,,0.6960652894703423,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}",150.0,,,,30226.147984067,,,,,6.313534232716307,0.03743109702958827,,0.1854637890630927,,,1e-06,,,0.002113421705627097,,,,1751148509.7810235,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_equal"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_equal"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_equal""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.09554130026344228}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}",allegro_additive_loss_study,1.3133627447311442,,,0.4286115542440325,,0.6419692218319988,0.2,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,41643.0,0.06699310850873537,,13.966317846587994,,,0.01801984732713502,1.3848096406801107,,0.0027366539414604356,0.05577098273424969,,,,0.2,0.05534322319397217,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 30226},0.4195480422531981,,0.10155314196041584,,,1.5574568690371684,,0.2,,0.2,,1.5058080301925865,4.7888210624978385,0.2,,,0.003467792112039098,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.2390155889661154,0.10100011650655975,,,,,0.6114879763149194,,allegro_additive_loss_study/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_equal,5.0,2.0,2.0,float32,42.0,32.00510198382953,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_train.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val_b.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_test.xyz,71ef0ad8,train:data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_train.xyz|val:data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_val_b.xyz|test:data/base_force_angle_focal_stress_shear_rare_sampling_no_softadapt_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_focal_focal_mse(coeff=1)|forces_angle_forces_angle(coeff=1)|stress_shear_stress_shear_mae(coeff=1),val1_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
24,allegro_additive_loss_study,force_angle_rare_sampling,34684.874174919,43983.0,1751158805.661532,{'runtime': 34685},150.0,,0.01408450704225352,0.704225352112676,1e-06,0.2357817845959668,1.000017402938587,0.06386549658423843,0.5352821020890286,0.005224285061790619,0.013730706221481532,0.5163434037496991,,0.5927253352415,0.016449652677648287,0.07596235263369028,,0.0015003374190925476,0.0002135713660341343,0.05082937496059163,217650.0,0.24443265861084865,3.3337878977018103,0.07548875703513606,1.5179042822148705,0.005252119313529938,0.013162761744922686,1.6216183138872011,0.7053623403291589,7.160445457698792,0.6855003528061018,2.5075858632621437,0.014346569919056652,0.09550408308513789,3.254511801348691,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/force_angle_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/force_angle_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/force_angle_rare_sampling_val.xyz"", ""data/force_angle_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/force_angle_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""force_angle_rare_sampling"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/force_angle_rare_sampling""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_force_angle""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_force_angle""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,0.14084507042253522,0.016840915769249776,0.0186023147440582,,,,,,,,,,0.14084507042253522,0.38097099101755977,0.3410683569040624,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.24443265861084865,,,,,,,,0.14084507042253522,0.05082937496059163,,0.06386549658423843,,217650.0,0.2357817845959668,,,0.14084507042253522,0.0002135713660341343,,,,0.07548875703513606,,1.6216183138872011,,1.5179042822148705,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_force_angle""}]}",150.0,,,,34684.874174919,,,,,3.254511801348691,,,0.09550408308513789,,,1e-06,,,,,,,1751158805.661532,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/force_angle_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/force_angle_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/force_angle_rare_sampling_val.xyz"", ""data/force_angle_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/force_angle_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""force_angle_rare_sampling"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/force_angle_rare_sampling""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_force_angle""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_additive_loss_study,1.000017402938587,,,,,0.5927253352415,0.704225352112676,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,43983.0,0.014346569919056652,,7.160445457698792,,,0.016449652677648287,0.7053623403291589,,0.0015003374190925476,0.005224285061790619,0.016840915769249776,,,0.01408450704225352,0.005252119313529938,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 34685},0.5352821020890286,,0.013730706221481532,,,3.3337878977018103,,,,,,0.6855003528061018,2.5075858632621437,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.07596235263369028,0.013162761744922686,0.0186023147440582,,,0.38097099101755977,0.5163434037496991,0.3410683569040624,allegro_additive_loss_study/force_angle_rare_sampling,5.0,2.0,2.0,float32,42.0,32.00510198382953,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/force_angle_rare_sampling_train.xyz,data/force_angle_rare_sampling_val.xyz|data/force_angle_rare_sampling_val_b.xyz,data/force_angle_rare_sampling_test.xyz,cf49a5ff,train:data/force_angle_rare_sampling_train.xyz|val:data/force_angle_rare_sampling_val.xyz|data/force_angle_rare_sampling_val_b.xyz|test:data/force_angle_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|forces_auto_stratified_huber(coeff=10)|stress_mse(coeff=50)|forces_angle_force_angle(coeff=10),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
25,allegro_additive_loss_study,stress_angle_no_sampler,23581.680127032,39273.0,1751153634.1529758,{'runtime': 23582},150.0,,0.011627906976744186,0.5813953488372093,3.90625e-06,0.5847942656624716,1.6943217772311483,0.14543714264578247,1.4154784193533076,0.01208890914358445,0.030875600448418593,1.0468919323442916,,0.3823656799342603,0.0031660081826377267,0.01755194410881907,,0.0553495573749698,0.00011843790011793196,0.00812028518980679,194100.0,0.5800166286686894,1.2514338615414056,0.14703800207649045,1.264610524998291,0.015935322842363236,0.3028857743846126,0.9396433869747696,1.313407266824926,14.2589514991824,0.719774175041352,2.239303868231376,0.023001996394803666,0.10204631231121346,5.533433893241663,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/stress_angle_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/stress_angle_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/stress_angle_no_sampler_val.xyz"", ""data/stress_angle_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/stress_angle_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""stress_angle_no_sampler"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/stress_angle_no_sampler""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressAngleLoss""}, ""name"": ""stress_angle_stress_angle""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressAngleLoss""}, ""name"": ""stress_angle_stress_angle""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,0.11627906976744186,0.027165478984983733,0.024998795109631693,,,,,,,,,,,,,0.29069767441860467,0.027885852577698236,0.015483404913848024,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.5800166286686894,,,,,,,,,0.00812028518980679,,0.14543714264578247,,194100.0,0.5847942656624716,,,0.11627906976744186,0.00011843790011793196,,,0.29069767441860467,0.14703800207649045,,0.9396433869747696,,1.264610524998291,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressAngleLoss""}, ""name"": ""stress_angle_stress_angle""}]}",150.0,0.015483404913848024,,,23581.680127032,,,,,5.533433893241663,,,0.10204631231121346,,,3.90625e-06,,,,,,,1751153634.1529758,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/stress_angle_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/stress_angle_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/stress_angle_no_sampler_val.xyz"", ""data/stress_angle_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/stress_angle_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""stress_angle_no_sampler"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/stress_angle_no_sampler""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressAngleLoss""}, ""name"": ""stress_angle_stress_angle""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_additive_loss_study,1.6943217772311483,,,,,0.3823656799342603,0.5813953488372093,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,39273.0,0.023001996394803666,,14.2589514991824,0.027885852577698236,,0.0031660081826377267,1.313407266824926,,0.0553495573749698,0.01208890914358445,0.027165478984983733,,,0.011627906976744186,0.015935322842363236,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 23582},1.4154784193533076,,0.030875600448418593,,,1.2514338615414056,,,,,,0.719774175041352,2.239303868231376,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.01755194410881907,0.3028857743846126,0.024998795109631693,,,,1.0468919323442916,,allegro_additive_loss_study/stress_angle_no_sampler,5.0,2.0,2.0,float32,42.0,32.006362324321195,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/stress_angle_no_sampler_train.xyz,data/stress_angle_no_sampler_val.xyz|data/stress_angle_no_sampler_val_b.xyz,data/stress_angle_no_sampler_test.xyz,5d4974a1,train:data/stress_angle_no_sampler_train.xyz|val:data/stress_angle_no_sampler_val.xyz|data/stress_angle_no_sampler_val_b.xyz|test:data/stress_angle_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|forces_auto_stratified_huber(coeff=10)|stress_mse(coeff=50)|stress_angle_stress_angle(coeff=25),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
26,allegro_additive_loss_study,stress_shear_no_sampler,23492.170695089,39273.0,1751177238.4556248,{'runtime': 23492},150.0,,0.011627906976744186,0.5813953488372093,7.8125e-06,0.2774963652478317,0.7489141879934347,0.0588781535792454,0.6974054810632802,0.0034822734544007763,0.014587477978613934,0.48696904901177623,,0.5288770901242718,0.0070433968057994,0.01215793475256688,,0.0008575328385116664,4.68434879940158e-05,0.0021630427568790633,194100.0,0.27635747937516586,0.7826887581757227,0.06716349155105213,1.125323673802514,0.00673872674359082,0.3016186327325261,0.7365436882369208,0.5980284708685293,7.633127222648842,0.6170422506990076,2.439351135397603,0.010700077276911996,0.0885430470512479,3.387007135032564,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/stress_shear_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/stress_shear_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/stress_shear_no_sampler_val.xyz"", ""data/stress_shear_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/stress_shear_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""stress_shear_no_sampler"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/stress_shear_no_sampler""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,0.11627906976744186,0.014134273753818656,0.015687726638489552,,,,,0.29069767441860467,,0.0009277088307329304,,0.0010377881387396595,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.27635747937516586,,,,,,,,,0.0021630427568790633,,0.0588781535792454,,194100.0,0.2774963652478317,,,0.11627906976744186,4.68434879940158e-05,,,,0.06716349155105213,,0.7365436882369208,,1.125323673802514,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}",150.0,,,,23492.170695089,,,,,3.387007135032564,,,0.0885430470512479,,,7.8125e-06,,,0.0009277088307329304,,,,1751177238.4556248,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/stress_shear_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/stress_shear_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/stress_shear_no_sampler_val.xyz"", ""data/stress_shear_no_sampler_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/stress_shear_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""stress_shear_no_sampler"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/stress_shear_no_sampler""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010286202654242516, 0.37812986969947815, 2.715738534927368], ""deltas"": [0.0010286202654242516, 0.0010286202654242516, 0.037812986969947816, 0.2715738534927368]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_additive_loss_study,0.7489141879934347,,,,,0.5288770901242718,0.5813953488372093,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,39273.0,0.010700077276911996,,7.633127222648842,,,0.0070433968057994,0.5980284708685293,,0.0008575328385116664,0.0034822734544007763,0.014134273753818656,,,0.011627906976744186,0.00673872674359082,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.006362324321195, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 9.95065084770841, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 23492},0.6974054810632802,,0.014587477978613934,,,0.7826887581757227,,0.29069767441860467,,,,0.6170422506990076,2.439351135397603,,,,0.0010377881387396595,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.01215793475256688,0.3016186327325261,0.015687726638489552,,,,0.48696904901177623,,allegro_additive_loss_study/stress_shear_no_sampler,5.0,2.0,2.0,float32,42.0,32.006362324321195,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/stress_shear_no_sampler_train.xyz,data/stress_shear_no_sampler_val.xyz|data/stress_shear_no_sampler_val_b.xyz,data/stress_shear_no_sampler_test.xyz,aeeb7743,train:data/stress_shear_no_sampler_train.xyz|val:data/stress_shear_no_sampler_val.xyz|data/stress_shear_no_sampler_val_b.xyz|test:data/stress_shear_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|forces_auto_stratified_huber(coeff=10)|stress_mse(coeff=50)|stress_shear_stress_shear_mae(coeff=25),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
27,allegro_additive_loss_study,base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid,30834.445028836,42453.0,1751187199.6613853,{'runtime': 30834},150.0,,0.010416666666666666,0.5208333333333334,1e-06,0.29147147277837837,0.8938433030441738,0.12281015043358293,0.40807813037087703,0.008969489326949414,0.023675981463731142,0.441865804959594,,0.2089781916033477,0.010931088620300334,0.05946117018185996,,0.004714094267255657,0.00023384985393379816,0.04345323387397009,210000.0,0.3023939693667761,1.4724800319813325,0.1668054868129796,2.0803389943547823,0.012161157746633518,0.24064390869699953,1.264487645011038,0.6601006989975804,14.128773303028616,1.0989205060043588,7.622236268456765,0.025041147891577697,0.08936390748085218,7.280124492988744,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [21758, 424, 425, 17662, 17663, 17666, 17667, 17669, 17670, 454, 9479, 6535, 9490, 6544, 470, 9507, 447, 9515, 9517, 20709, 9524, 9526, 9533, 9534, 9535, 20810, 9543, 9544, 20952, 9551, 9552, 9553, 21214, 9560, 9569, 9571, 22539, 9579, 22540, 22554, 5831, 9607, 9614, 9625, 9626, 6108, 9632, 9633, 17803, 17804, 17805, 17806, 23040, 17764, 17664, 17809, 564, 5201, 5221, 5226, 8953, 608, 620, 23148, 3968, 17332, 17346, 17355, 19422, 17458, 17459, 17672, 17673, 3983, 17681, 17687, 17688, 695, 3986, 17695, 19430, 17698, 17719, 19434, 17722, 17723, 17724, 17727, 17728, 3997, 17732, 17736, 719, 17741, 17743, 17745, 17746, 17747, 4005, 17752, 17754, 20385, 17756, 17760, 17761, 17762, 4011, 23291, 17771, 5317, 17775, 5318, 17779, 20392, 17781, 17787, 19451, 5320, 5324, 18148, 19455, 23375, 20398, 18161, 20399, 18165, 18166, 5330, 18172, 18178, 5334, 18181, 4032, 20404, 19462, 19463, 18182, 18186, 4036, 19465, 18190, 5341, 18194, 18198, 18202, 18565, 18567, 18571, 18590, 18593, 18597, 18598, 18603, 18080, 18610, 18612, 18613, 784, 19476, 18618, 4054, 19479, 18630, 18632, 19480, 4058, 2281, 5361, 2285, 5363, 20424, 20425, 18641, 18646, 18647, 18648, 18670, 2296, 18674, 20430, 2299, 18679, 5374, 19490, 18695, 18702, 18708, 4077, 18129, 18130, 18131, 847, 6684, 876, 878, 3403, 823, 859, 21991, 9744, 10314, 10322, 10330, 10340, 10355, 10362, 10370, 10378, 18218, 18221, 18222, 21998, 18224, 18118, 8003, 18226, 18227, 18231, 18134, 18135, 22007, 3412, 3413, 22016, 10755, 22017, 8032, 8041, 6225, 22028, 2459, 2461, 2467, 12637, 6758, 3425, 3426, 3427, 6776, 18337, 18347, 18349, 18352, 18354, 18356, 18360, 18369, 18372, 6819, 20562, 20563, 20564, 5565, 4727, 5584, 15673, 5597, 20594, 8176, 5607, 4308, 8183, 796, 2671, 2674, 2675, 2678, 2679, 2681, 2684, 2686, 2687, 2688, 2690, 12757, 12773, 6903, 12798, 12805, 12813, 12822, 12838, 2692, 6907, 2694, 2697, 19682, 2700, 2702, 18542, 18544, 12869, 18546, 3146, 3148, 3149, 18550, 18551, 19689, 3153, 3154, 3155, 3156, 3157, 18553, 18556, 3158, 3161, 3169, 3172, 3174, 3177, 22168, 3179, 3180, 3181, 3183, 3184, 3185, 8247, 3190, 3191, 3192, 3194, 3195, 3197, 3200, 3201, 3202, 8260, 3214, 3215, 3216, 22185, 3221, 3222, 3225, 3226, 22191, 3228, 3231, 5703, 3234, 3237, 8281, 13158, 3244, 3245, 3246, 3247, 8283, 3249, 3253, 9583, 3254, 3256, 8289, 3259, 3263, 3265, 3268, 3269, 3270, 3277, 3285, 3288, 3291, 3292, 3294, 3296, 3298, 3299, 3301, 3304, 3305, 3306, 3308, 3314, 3315, 3316, 3318, 3319, 3322, 3323, 3328, 3329, 3330, 3331, 3332, 4465, 3334, 3335, 3336, 3337, 3340, 3342, 3345, 3346, 3347, 3350, 3353, 3355, 3357, 22252, 3362, 3363, 3367, 3368, 3369, 3372, 22260, 18785, 18800, 3377, 3378, 3379, 3380, 18803, 18804, 18805, 18806, 18808, 18809, 3387, 18810, 4502, 3390, 3391, 18811, 18815, 18818, 18819, 18822, 4507, 3398, 3399, 3400, 18823, 3402, 18824, 18825, 4512, 18826, 18827, 18828, 3409, 18830, 18836, 18837, 18831, 18832, 18840, 18841, 18835, 4520, 18843, 18845, 3416, 18847, 18848, 3415, 3417, 18853, 3419, 18855, 3420, 18857, 3428, 3421, 3422, 3424, 3430, 18860, 3431, 3434, 3432, 3435, 18861, 19827, 18850, 18862, 18863, 3437, 3438, 3439, 3445, 3443, 3447, 3448, 3451, 3452, 25399, 25407, 3457, 3458, 4549, 3460, 3461, 25415, 3463, 3464, 3466, 25448, 3469, 3470, 25463, 3473, 3475, 3476, 8436, 3478, 3480, 3482, 3483, 3484, 3486, 19851, 3489, 3490, 3491, 3493, 3496, 3497, 4574, 3499, 19856, 3500, 3502, 3503, 3504, 3505, 3508, 3513, 3517, 3523, 3527, 3528, 3529, 3531, 3532, 3151, 3535, 3537, 5902, 3548, 7221, 3554, 3555, 3557, 3559, 19884, 4617, 3562, 4618, 3563, 3564, 3566, 3568, 3570, 19891, 4625, 3572, 19892, 4627, 3574, 3575, 19894, 3576, 3579, 3580, 3583, 3584, 3585, 19898, 3587, 3588, 3589, 3591, 3593, 19902, 3595, 3596, 3600, 4645, 3602, 3603, 19907, 4648, 19908, 3610, 3611, 3612, 3613, 4653, 3615, 3619, 3620, 4658, 3621, 3622, 3624, 3625, 19917, 3626, 3628, 3623, 3633, 3634, 3635, 3636, 3639, 3640, 3641, 19925, 3645, 3646, 3648, 3651, 19930, 3654, 19931, 3656, 3657, 3659, 3660, 19933, 3661, 3662, 3664, 3665, 3666, 3667, 4689, 3668, 3669, 3670, 3671, 3672, 3673, 3675, 3676, 3677, 3678, 24490, 3683, 3684, 3688, 21477, 3690, 3691, 1382, 1383, 1384, 3695, 3696, 1387, 1388, 3699, 3700, 3701, 1390, 3703, 3704, 1391, 1392, 3707, 1394, 11491, 4716, 3711, 1399, 1400, 3716, 19960, 3718, 3719, 3720, 3722, 3723, 3724, 3727, 3729, 3730, 3732, 7304, 3735, 3736, 3737, 3738, 3744, 3746, 3748, 3749, 3753, 3754, 3755, 3757, 3761, 7321, 3763, 3765, 3766, 3767, 21513, 7328, 3774, 3775, 3777, 7332, 3779, 7339, 7345, 19237, 21532, 21535, 19247, 19248, 4788, 20008, 4789, 21538, 20010, 4791, 20011, 19259, 19262, 21543, 19264, 19265, 20015, 19269, 7372, 19271, 19272, 20019, 4810, 4813, 7391, 23, 21562, 20033, 4824, 7399, 7402, 20041, 7407, 4836, 20047, 7415, 20048, 4845, 21579, 63, 64, 14804, 21585, 7428, 4859, 21589, 21590, 7434, 14829, 14868, 14885, 82, 83, 4870, 84, 86, 87, 88, 89, 90, 14893, 14900, 14927, 99, 22262, 4887, 107, 14941, 1657, 1659, 11707, 11715, 11723, 4894, 11747, 11771, 1660, 1662, 1663, 1665, 1669, 24633, 11788, 1670, 1673, 1674, 1675, 4908, 11795, 1676, 1678, 1679, 1680, 1683, 1685, 1686, 1687, 1689, 1693, 1694, 157, 1698, 20105, 1702, 11803, 1705, 1704, 10861, 4929, 1709, 1710, 22269, 178, 1711, 1714, 20112, 8379, 4936, 20114, 4943, 194, 8381, 20122, 4952, 20126, 4957, 20130, 216, 20131, 4961, 20135, 9026, 9027, 9028, 22511, 230, 22513, 233, 22514, 4973, 4974, 9052, 4975, 22515, 22480, 9059, 9060, 9066, 9068, 4981, 9074, 9075, 22519, 256, 4987, 4988, 260, 20153, 4997, 13757, 20164, 15083, 8395, 5016, 20173, 22281, 22282, 328, 330, 7612, 17585, 17586, 17588, 8403, 361, 372, 11242, 375, 377, 16754, 11266, 11274, 11299, 11315, 11331, 11362, 11378, 395], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,0.10416666666666669,0.08190396429100226,0.038405084882541775,0.10416666666666669,0.2604166666666667,0.4093059203945946,0.0016256347193688936,0.3750005463206706,0.0008419021162023637,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.3023939693667761,,,,,,,0.3750005463206706,,0.04345323387397009,,0.12281015043358293,,210000.0,0.29147147277837837,,,,0.00023384985393379816,0.08190396429100226,,,0.1668054868129796,,1.264487645011038,,2.0803389943547823,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}",150.0,,,,30834.445028836,,,,,7.280124492988744,0.038405084882541775,,0.08936390748085218,,,1e-06,,,0.0016256347193688936,,,,1751187199.6613853,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [21758, 424, 425, 17662, 17663, 17666, 17667, 17669, 17670, 454, 9479, 6535, 9490, 6544, 470, 9507, 447, 9515, 9517, 20709, 9524, 9526, 9533, 9534, 9535, 20810, 9543, 9544, 20952, 9551, 9552, 9553, 21214, 9560, 9569, 9571, 22539, 9579, 22540, 22554, 5831, 9607, 9614, 9625, 9626, 6108, 9632, 9633, 17803, 17804, 17805, 17806, 23040, 17764, 17664, 17809, 564, 5201, 5221, 5226, 8953, 608, 620, 23148, 3968, 17332, 17346, 17355, 19422, 17458, 17459, 17672, 17673, 3983, 17681, 17687, 17688, 695, 3986, 17695, 19430, 17698, 17719, 19434, 17722, 17723, 17724, 17727, 17728, 3997, 17732, 17736, 719, 17741, 17743, 17745, 17746, 17747, 4005, 17752, 17754, 20385, 17756, 17760, 17761, 17762, 4011, 23291, 17771, 5317, 17775, 5318, 17779, 20392, 17781, 17787, 19451, 5320, 5324, 18148, 19455, 23375, 20398, 18161, 20399, 18165, 18166, 5330, 18172, 18178, 5334, 18181, 4032, 20404, 19462, 19463, 18182, 18186, 4036, 19465, 18190, 5341, 18194, 18198, 18202, 18565, 18567, 18571, 18590, 18593, 18597, 18598, 18603, 18080, 18610, 18612, 18613, 784, 19476, 18618, 4054, 19479, 18630, 18632, 19480, 4058, 2281, 5361, 2285, 5363, 20424, 20425, 18641, 18646, 18647, 18648, 18670, 2296, 18674, 20430, 2299, 18679, 5374, 19490, 18695, 18702, 18708, 4077, 18129, 18130, 18131, 847, 6684, 876, 878, 3403, 823, 859, 21991, 9744, 10314, 10322, 10330, 10340, 10355, 10362, 10370, 10378, 18218, 18221, 18222, 21998, 18224, 18118, 8003, 18226, 18227, 18231, 18134, 18135, 22007, 3412, 3413, 22016, 10755, 22017, 8032, 8041, 6225, 22028, 2459, 2461, 2467, 12637, 6758, 3425, 3426, 3427, 6776, 18337, 18347, 18349, 18352, 18354, 18356, 18360, 18369, 18372, 6819, 20562, 20563, 20564, 5565, 4727, 5584, 15673, 5597, 20594, 8176, 5607, 4308, 8183, 796, 2671, 2674, 2675, 2678, 2679, 2681, 2684, 2686, 2687, 2688, 2690, 12757, 12773, 6903, 12798, 12805, 12813, 12822, 12838, 2692, 6907, 2694, 2697, 19682, 2700, 2702, 18542, 18544, 12869, 18546, 3146, 3148, 3149, 18550, 18551, 19689, 3153, 3154, 3155, 3156, 3157, 18553, 18556, 3158, 3161, 3169, 3172, 3174, 3177, 22168, 3179, 3180, 3181, 3183, 3184, 3185, 8247, 3190, 3191, 3192, 3194, 3195, 3197, 3200, 3201, 3202, 8260, 3214, 3215, 3216, 22185, 3221, 3222, 3225, 3226, 22191, 3228, 3231, 5703, 3234, 3237, 8281, 13158, 3244, 3245, 3246, 3247, 8283, 3249, 3253, 9583, 3254, 3256, 8289, 3259, 3263, 3265, 3268, 3269, 3270, 3277, 3285, 3288, 3291, 3292, 3294, 3296, 3298, 3299, 3301, 3304, 3305, 3306, 3308, 3314, 3315, 3316, 3318, 3319, 3322, 3323, 3328, 3329, 3330, 3331, 3332, 4465, 3334, 3335, 3336, 3337, 3340, 3342, 3345, 3346, 3347, 3350, 3353, 3355, 3357, 22252, 3362, 3363, 3367, 3368, 3369, 3372, 22260, 18785, 18800, 3377, 3378, 3379, 3380, 18803, 18804, 18805, 18806, 18808, 18809, 3387, 18810, 4502, 3390, 3391, 18811, 18815, 18818, 18819, 18822, 4507, 3398, 3399, 3400, 18823, 3402, 18824, 18825, 4512, 18826, 18827, 18828, 3409, 18830, 18836, 18837, 18831, 18832, 18840, 18841, 18835, 4520, 18843, 18845, 3416, 18847, 18848, 3415, 3417, 18853, 3419, 18855, 3420, 18857, 3428, 3421, 3422, 3424, 3430, 18860, 3431, 3434, 3432, 3435, 18861, 19827, 18850, 18862, 18863, 3437, 3438, 3439, 3445, 3443, 3447, 3448, 3451, 3452, 25399, 25407, 3457, 3458, 4549, 3460, 3461, 25415, 3463, 3464, 3466, 25448, 3469, 3470, 25463, 3473, 3475, 3476, 8436, 3478, 3480, 3482, 3483, 3484, 3486, 19851, 3489, 3490, 3491, 3493, 3496, 3497, 4574, 3499, 19856, 3500, 3502, 3503, 3504, 3505, 3508, 3513, 3517, 3523, 3527, 3528, 3529, 3531, 3532, 3151, 3535, 3537, 5902, 3548, 7221, 3554, 3555, 3557, 3559, 19884, 4617, 3562, 4618, 3563, 3564, 3566, 3568, 3570, 19891, 4625, 3572, 19892, 4627, 3574, 3575, 19894, 3576, 3579, 3580, 3583, 3584, 3585, 19898, 3587, 3588, 3589, 3591, 3593, 19902, 3595, 3596, 3600, 4645, 3602, 3603, 19907, 4648, 19908, 3610, 3611, 3612, 3613, 4653, 3615, 3619, 3620, 4658, 3621, 3622, 3624, 3625, 19917, 3626, 3628, 3623, 3633, 3634, 3635, 3636, 3639, 3640, 3641, 19925, 3645, 3646, 3648, 3651, 19930, 3654, 19931, 3656, 3657, 3659, 3660, 19933, 3661, 3662, 3664, 3665, 3666, 3667, 4689, 3668, 3669, 3670, 3671, 3672, 3673, 3675, 3676, 3677, 3678, 24490, 3683, 3684, 3688, 21477, 3690, 3691, 1382, 1383, 1384, 3695, 3696, 1387, 1388, 3699, 3700, 3701, 1390, 3703, 3704, 1391, 1392, 3707, 1394, 11491, 4716, 3711, 1399, 1400, 3716, 19960, 3718, 3719, 3720, 3722, 3723, 3724, 3727, 3729, 3730, 3732, 7304, 3735, 3736, 3737, 3738, 3744, 3746, 3748, 3749, 3753, 3754, 3755, 3757, 3761, 7321, 3763, 3765, 3766, 3767, 21513, 7328, 3774, 3775, 3777, 7332, 3779, 7339, 7345, 19237, 21532, 21535, 19247, 19248, 4788, 20008, 4789, 21538, 20010, 4791, 20011, 19259, 19262, 21543, 19264, 19265, 20015, 19269, 7372, 19271, 19272, 20019, 4810, 4813, 7391, 23, 21562, 20033, 4824, 7399, 7402, 20041, 7407, 4836, 20047, 7415, 20048, 4845, 21579, 63, 64, 14804, 21585, 7428, 4859, 21589, 21590, 7434, 14829, 14868, 14885, 82, 83, 4870, 84, 86, 87, 88, 89, 90, 14893, 14900, 14927, 99, 22262, 4887, 107, 14941, 1657, 1659, 11707, 11715, 11723, 4894, 11747, 11771, 1660, 1662, 1663, 1665, 1669, 24633, 11788, 1670, 1673, 1674, 1675, 4908, 11795, 1676, 1678, 1679, 1680, 1683, 1685, 1686, 1687, 1689, 1693, 1694, 157, 1698, 20105, 1702, 11803, 1705, 1704, 10861, 4929, 1709, 1710, 22269, 178, 1711, 1714, 20112, 8379, 4936, 20114, 4943, 194, 8381, 20122, 4952, 20126, 4957, 20130, 216, 20131, 4961, 20135, 9026, 9027, 9028, 22511, 230, 22513, 233, 22514, 4973, 4974, 9052, 4975, 22515, 22480, 9059, 9060, 9066, 9068, 4981, 9074, 9075, 22519, 256, 4987, 4988, 260, 20153, 4997, 13757, 20164, 15083, 8395, 5016, 20173, 22281, 22282, 328, 330, 7612, 17585, 17586, 17588, 8403, 361, 372, 11242, 375, 377, 16754, 11266, 11274, 11299, 11315, 11331, 11362, 11378, 395], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}",allegro_additive_loss_study,0.8938433030441738,,,0.4093059203945946,,0.2089781916033477,0.5208333333333334,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,42453.0,0.025041147891577697,,14.128773303028616,,,0.010931088620300334,0.6601006989975804,,0.004714094267255657,0.008969489326949414,,,,0.010416666666666666,0.012161157746633518,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 30834},0.40807813037087703,,0.023675981463731142,,,1.4724800319813325,,0.2604166666666667,,0.10416666666666669,,1.0989205060043588,7.622236268456765,0.10416666666666669,,,0.0008419021162023637,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.05946117018185996,0.24064390869699953,,,,,0.441865804959594,,allegro_additive_loss_study/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid,5.0,2.0,2.0,float32,42.0,32.023188572145564,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_train.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val_b.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_test.xyz,e738e290,train:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_train.xyz|val:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val_b.xyz|test:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_focal_focal_mse(coeff=10)|forces_angle_forces_angle(coeff=10)|stress_shear_stress_shear_mae(coeff=25),val1_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
28,allegro_additive_loss_study,base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_equal,30746.061328274,42453.0,1751187083.9736538,{'runtime': 30746},150.0,,0.2,0.2,1e-06,0.34061494312082896,1.2975009688948929,0.09619091338510811,0.2814411703774567,0.02430343068122242,0.045522100647130775,0.5414880799731601,,0.19506967573962977,0.011107820651811444,0.1385993077369268,,0.0019568811093831433,0.00025168515006090416,0.0819049837338947,210000.0,0.3516489580156159,1.523812090240879,0.14716208393717653,2.078307459795228,0.02779138074500485,0.24331797232896632,1.2818125074550244,0.7960042566372442,16.011453169838806,0.9317373300267924,5.373770211390009,0.03107866342748356,0.08055165109918126,7.155258344109332,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [21758, 424, 425, 17662, 17663, 17666, 17667, 17669, 17670, 454, 9479, 6535, 9490, 6544, 470, 9507, 447, 9515, 9517, 20709, 9524, 9526, 9533, 9534, 9535, 20810, 9543, 9544, 20952, 9551, 9552, 9553, 21214, 9560, 9569, 9571, 22539, 9579, 22540, 22554, 5831, 9607, 9614, 9625, 9626, 6108, 9632, 9633, 17803, 17804, 17805, 17806, 23040, 17764, 17664, 17809, 564, 5201, 5221, 5226, 8953, 608, 620, 23148, 3968, 17332, 17346, 17355, 19422, 17458, 17459, 17672, 17673, 3983, 17681, 17687, 17688, 695, 3986, 17695, 19430, 17698, 17719, 19434, 17722, 17723, 17724, 17727, 17728, 3997, 17732, 17736, 719, 17741, 17743, 17745, 17746, 17747, 4005, 17752, 17754, 20385, 17756, 17760, 17761, 17762, 4011, 23291, 17771, 5317, 17775, 5318, 17779, 20392, 17781, 17787, 19451, 5320, 5324, 18148, 19455, 23375, 20398, 18161, 20399, 18165, 18166, 5330, 18172, 18178, 5334, 18181, 4032, 20404, 19462, 19463, 18182, 18186, 4036, 19465, 18190, 5341, 18194, 18198, 18202, 18565, 18567, 18571, 18590, 18593, 18597, 18598, 18603, 18080, 18610, 18612, 18613, 784, 19476, 18618, 4054, 19479, 18630, 18632, 19480, 4058, 2281, 5361, 2285, 5363, 20424, 20425, 18641, 18646, 18647, 18648, 18670, 2296, 18674, 20430, 2299, 18679, 5374, 19490, 18695, 18702, 18708, 4077, 18129, 18130, 18131, 847, 6684, 876, 878, 3403, 823, 859, 21991, 9744, 10314, 10322, 10330, 10340, 10355, 10362, 10370, 10378, 18218, 18221, 18222, 21998, 18224, 18118, 8003, 18226, 18227, 18231, 18134, 18135, 22007, 3412, 3413, 22016, 10755, 22017, 8032, 8041, 6225, 22028, 2459, 2461, 2467, 12637, 6758, 3425, 3426, 3427, 6776, 18337, 18347, 18349, 18352, 18354, 18356, 18360, 18369, 18372, 6819, 20562, 20563, 20564, 5565, 4727, 5584, 15673, 5597, 20594, 8176, 5607, 4308, 8183, 796, 2671, 2674, 2675, 2678, 2679, 2681, 2684, 2686, 2687, 2688, 2690, 12757, 12773, 6903, 12798, 12805, 12813, 12822, 12838, 2692, 6907, 2694, 2697, 19682, 2700, 2702, 18542, 18544, 12869, 18546, 3146, 3148, 3149, 18550, 18551, 19689, 3153, 3154, 3155, 3156, 3157, 18553, 18556, 3158, 3161, 3169, 3172, 3174, 3177, 22168, 3179, 3180, 3181, 3183, 3184, 3185, 8247, 3190, 3191, 3192, 3194, 3195, 3197, 3200, 3201, 3202, 8260, 3214, 3215, 3216, 22185, 3221, 3222, 3225, 3226, 22191, 3228, 3231, 5703, 3234, 3237, 8281, 13158, 3244, 3245, 3246, 3247, 8283, 3249, 3253, 9583, 3254, 3256, 8289, 3259, 3263, 3265, 3268, 3269, 3270, 3277, 3285, 3288, 3291, 3292, 3294, 3296, 3298, 3299, 3301, 3304, 3305, 3306, 3308, 3314, 3315, 3316, 3318, 3319, 3322, 3323, 3328, 3329, 3330, 3331, 3332, 4465, 3334, 3335, 3336, 3337, 3340, 3342, 3345, 3346, 3347, 3350, 3353, 3355, 3357, 22252, 3362, 3363, 3367, 3368, 3369, 3372, 22260, 18785, 18800, 3377, 3378, 3379, 3380, 18803, 18804, 18805, 18806, 18808, 18809, 3387, 18810, 4502, 3390, 3391, 18811, 18815, 18818, 18819, 18822, 4507, 3398, 3399, 3400, 18823, 3402, 18824, 18825, 4512, 18826, 18827, 18828, 3409, 18830, 18836, 18837, 18831, 18832, 18840, 18841, 18835, 4520, 18843, 18845, 3416, 18847, 18848, 3415, 3417, 18853, 3419, 18855, 3420, 18857, 3428, 3421, 3422, 3424, 3430, 18860, 3431, 3434, 3432, 3435, 18861, 19827, 18850, 18862, 18863, 3437, 3438, 3439, 3445, 3443, 3447, 3448, 3451, 3452, 25399, 25407, 3457, 3458, 4549, 3460, 3461, 25415, 3463, 3464, 3466, 25448, 3469, 3470, 25463, 3473, 3475, 3476, 8436, 3478, 3480, 3482, 3483, 3484, 3486, 19851, 3489, 3490, 3491, 3493, 3496, 3497, 4574, 3499, 19856, 3500, 3502, 3503, 3504, 3505, 3508, 3513, 3517, 3523, 3527, 3528, 3529, 3531, 3532, 3151, 3535, 3537, 5902, 3548, 7221, 3554, 3555, 3557, 3559, 19884, 4617, 3562, 4618, 3563, 3564, 3566, 3568, 3570, 19891, 4625, 3572, 19892, 4627, 3574, 3575, 19894, 3576, 3579, 3580, 3583, 3584, 3585, 19898, 3587, 3588, 3589, 3591, 3593, 19902, 3595, 3596, 3600, 4645, 3602, 3603, 19907, 4648, 19908, 3610, 3611, 3612, 3613, 4653, 3615, 3619, 3620, 4658, 3621, 3622, 3624, 3625, 19917, 3626, 3628, 3623, 3633, 3634, 3635, 3636, 3639, 3640, 3641, 19925, 3645, 3646, 3648, 3651, 19930, 3654, 19931, 3656, 3657, 3659, 3660, 19933, 3661, 3662, 3664, 3665, 3666, 3667, 4689, 3668, 3669, 3670, 3671, 3672, 3673, 3675, 3676, 3677, 3678, 24490, 3683, 3684, 3688, 21477, 3690, 3691, 1382, 1383, 1384, 3695, 3696, 1387, 1388, 3699, 3700, 3701, 1390, 3703, 3704, 1391, 1392, 3707, 1394, 11491, 4716, 3711, 1399, 1400, 3716, 19960, 3718, 3719, 3720, 3722, 3723, 3724, 3727, 3729, 3730, 3732, 7304, 3735, 3736, 3737, 3738, 3744, 3746, 3748, 3749, 3753, 3754, 3755, 3757, 3761, 7321, 3763, 3765, 3766, 3767, 21513, 7328, 3774, 3775, 3777, 7332, 3779, 7339, 7345, 19237, 21532, 21535, 19247, 19248, 4788, 20008, 4789, 21538, 20010, 4791, 20011, 19259, 19262, 21543, 19264, 19265, 20015, 19269, 7372, 19271, 19272, 20019, 4810, 4813, 7391, 23, 21562, 20033, 4824, 7399, 7402, 20041, 7407, 4836, 20047, 7415, 20048, 4845, 21579, 63, 64, 14804, 21585, 7428, 4859, 21589, 21590, 7434, 14829, 14868, 14885, 82, 83, 4870, 84, 86, 87, 88, 89, 90, 14893, 14900, 14927, 99, 22262, 4887, 107, 14941, 1657, 1659, 11707, 11715, 11723, 4894, 11747, 11771, 1660, 1662, 1663, 1665, 1669, 24633, 11788, 1670, 1673, 1674, 1675, 4908, 11795, 1676, 1678, 1679, 1680, 1683, 1685, 1686, 1687, 1689, 1693, 1694, 157, 1698, 20105, 1702, 11803, 1705, 1704, 10861, 4929, 1709, 1710, 22269, 178, 1711, 1714, 20112, 8379, 4936, 20114, 4943, 194, 8381, 20122, 4952, 20126, 4957, 20130, 216, 20131, 4961, 20135, 9026, 9027, 9028, 22511, 230, 22513, 233, 22514, 4973, 4974, 9052, 4975, 22515, 22480, 9059, 9060, 9066, 9068, 4981, 9074, 9075, 22519, 256, 4987, 4988, 260, 20153, 4997, 13757, 20164, 15083, 8395, 5016, 20173, 22281, 22282, 328, 330, 7612, 17585, 17586, 17588, 8403, 361, 372, 11242, 375, 377, 16754, 11266, 11274, 11299, 11315, 11331, 11362, 11378, 395], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_equal"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_equal"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_equal""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,0.2,0.08105727364286656,0.03604335474074396,0.2,0.2,0.40410946169731665,0.0016523069530096411,0.3704086507927852,0.000864346876500206,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.3516489580156159,,,,,,,0.3704086507927852,,0.0819049837338947,,0.09619091338510811,,210000.0,0.34061494312082896,,,,0.00025168515006090416,0.08105727364286656,,,0.14716208393717653,,1.2818125074550244,,2.078307459795228,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}",150.0,,,,30746.061328274,,,,,7.155258344109332,0.03604335474074396,,0.08055165109918126,,,1e-06,,,0.0016523069530096411,,,,1751187083.9736538,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [21758, 424, 425, 17662, 17663, 17666, 17667, 17669, 17670, 454, 9479, 6535, 9490, 6544, 470, 9507, 447, 9515, 9517, 20709, 9524, 9526, 9533, 9534, 9535, 20810, 9543, 9544, 20952, 9551, 9552, 9553, 21214, 9560, 9569, 9571, 22539, 9579, 22540, 22554, 5831, 9607, 9614, 9625, 9626, 6108, 9632, 9633, 17803, 17804, 17805, 17806, 23040, 17764, 17664, 17809, 564, 5201, 5221, 5226, 8953, 608, 620, 23148, 3968, 17332, 17346, 17355, 19422, 17458, 17459, 17672, 17673, 3983, 17681, 17687, 17688, 695, 3986, 17695, 19430, 17698, 17719, 19434, 17722, 17723, 17724, 17727, 17728, 3997, 17732, 17736, 719, 17741, 17743, 17745, 17746, 17747, 4005, 17752, 17754, 20385, 17756, 17760, 17761, 17762, 4011, 23291, 17771, 5317, 17775, 5318, 17779, 20392, 17781, 17787, 19451, 5320, 5324, 18148, 19455, 23375, 20398, 18161, 20399, 18165, 18166, 5330, 18172, 18178, 5334, 18181, 4032, 20404, 19462, 19463, 18182, 18186, 4036, 19465, 18190, 5341, 18194, 18198, 18202, 18565, 18567, 18571, 18590, 18593, 18597, 18598, 18603, 18080, 18610, 18612, 18613, 784, 19476, 18618, 4054, 19479, 18630, 18632, 19480, 4058, 2281, 5361, 2285, 5363, 20424, 20425, 18641, 18646, 18647, 18648, 18670, 2296, 18674, 20430, 2299, 18679, 5374, 19490, 18695, 18702, 18708, 4077, 18129, 18130, 18131, 847, 6684, 876, 878, 3403, 823, 859, 21991, 9744, 10314, 10322, 10330, 10340, 10355, 10362, 10370, 10378, 18218, 18221, 18222, 21998, 18224, 18118, 8003, 18226, 18227, 18231, 18134, 18135, 22007, 3412, 3413, 22016, 10755, 22017, 8032, 8041, 6225, 22028, 2459, 2461, 2467, 12637, 6758, 3425, 3426, 3427, 6776, 18337, 18347, 18349, 18352, 18354, 18356, 18360, 18369, 18372, 6819, 20562, 20563, 20564, 5565, 4727, 5584, 15673, 5597, 20594, 8176, 5607, 4308, 8183, 796, 2671, 2674, 2675, 2678, 2679, 2681, 2684, 2686, 2687, 2688, 2690, 12757, 12773, 6903, 12798, 12805, 12813, 12822, 12838, 2692, 6907, 2694, 2697, 19682, 2700, 2702, 18542, 18544, 12869, 18546, 3146, 3148, 3149, 18550, 18551, 19689, 3153, 3154, 3155, 3156, 3157, 18553, 18556, 3158, 3161, 3169, 3172, 3174, 3177, 22168, 3179, 3180, 3181, 3183, 3184, 3185, 8247, 3190, 3191, 3192, 3194, 3195, 3197, 3200, 3201, 3202, 8260, 3214, 3215, 3216, 22185, 3221, 3222, 3225, 3226, 22191, 3228, 3231, 5703, 3234, 3237, 8281, 13158, 3244, 3245, 3246, 3247, 8283, 3249, 3253, 9583, 3254, 3256, 8289, 3259, 3263, 3265, 3268, 3269, 3270, 3277, 3285, 3288, 3291, 3292, 3294, 3296, 3298, 3299, 3301, 3304, 3305, 3306, 3308, 3314, 3315, 3316, 3318, 3319, 3322, 3323, 3328, 3329, 3330, 3331, 3332, 4465, 3334, 3335, 3336, 3337, 3340, 3342, 3345, 3346, 3347, 3350, 3353, 3355, 3357, 22252, 3362, 3363, 3367, 3368, 3369, 3372, 22260, 18785, 18800, 3377, 3378, 3379, 3380, 18803, 18804, 18805, 18806, 18808, 18809, 3387, 18810, 4502, 3390, 3391, 18811, 18815, 18818, 18819, 18822, 4507, 3398, 3399, 3400, 18823, 3402, 18824, 18825, 4512, 18826, 18827, 18828, 3409, 18830, 18836, 18837, 18831, 18832, 18840, 18841, 18835, 4520, 18843, 18845, 3416, 18847, 18848, 3415, 3417, 18853, 3419, 18855, 3420, 18857, 3428, 3421, 3422, 3424, 3430, 18860, 3431, 3434, 3432, 3435, 18861, 19827, 18850, 18862, 18863, 3437, 3438, 3439, 3445, 3443, 3447, 3448, 3451, 3452, 25399, 25407, 3457, 3458, 4549, 3460, 3461, 25415, 3463, 3464, 3466, 25448, 3469, 3470, 25463, 3473, 3475, 3476, 8436, 3478, 3480, 3482, 3483, 3484, 3486, 19851, 3489, 3490, 3491, 3493, 3496, 3497, 4574, 3499, 19856, 3500, 3502, 3503, 3504, 3505, 3508, 3513, 3517, 3523, 3527, 3528, 3529, 3531, 3532, 3151, 3535, 3537, 5902, 3548, 7221, 3554, 3555, 3557, 3559, 19884, 4617, 3562, 4618, 3563, 3564, 3566, 3568, 3570, 19891, 4625, 3572, 19892, 4627, 3574, 3575, 19894, 3576, 3579, 3580, 3583, 3584, 3585, 19898, 3587, 3588, 3589, 3591, 3593, 19902, 3595, 3596, 3600, 4645, 3602, 3603, 19907, 4648, 19908, 3610, 3611, 3612, 3613, 4653, 3615, 3619, 3620, 4658, 3621, 3622, 3624, 3625, 19917, 3626, 3628, 3623, 3633, 3634, 3635, 3636, 3639, 3640, 3641, 19925, 3645, 3646, 3648, 3651, 19930, 3654, 19931, 3656, 3657, 3659, 3660, 19933, 3661, 3662, 3664, 3665, 3666, 3667, 4689, 3668, 3669, 3670, 3671, 3672, 3673, 3675, 3676, 3677, 3678, 24490, 3683, 3684, 3688, 21477, 3690, 3691, 1382, 1383, 1384, 3695, 3696, 1387, 1388, 3699, 3700, 3701, 1390, 3703, 3704, 1391, 1392, 3707, 1394, 11491, 4716, 3711, 1399, 1400, 3716, 19960, 3718, 3719, 3720, 3722, 3723, 3724, 3727, 3729, 3730, 3732, 7304, 3735, 3736, 3737, 3738, 3744, 3746, 3748, 3749, 3753, 3754, 3755, 3757, 3761, 7321, 3763, 3765, 3766, 3767, 21513, 7328, 3774, 3775, 3777, 7332, 3779, 7339, 7345, 19237, 21532, 21535, 19247, 19248, 4788, 20008, 4789, 21538, 20010, 4791, 20011, 19259, 19262, 21543, 19264, 19265, 20015, 19269, 7372, 19271, 19272, 20019, 4810, 4813, 7391, 23, 21562, 20033, 4824, 7399, 7402, 20041, 7407, 4836, 20047, 7415, 20048, 4845, 21579, 63, 64, 14804, 21585, 7428, 4859, 21589, 21590, 7434, 14829, 14868, 14885, 82, 83, 4870, 84, 86, 87, 88, 89, 90, 14893, 14900, 14927, 99, 22262, 4887, 107, 14941, 1657, 1659, 11707, 11715, 11723, 4894, 11747, 11771, 1660, 1662, 1663, 1665, 1669, 24633, 11788, 1670, 1673, 1674, 1675, 4908, 11795, 1676, 1678, 1679, 1680, 1683, 1685, 1686, 1687, 1689, 1693, 1694, 157, 1698, 20105, 1702, 11803, 1705, 1704, 10861, 4929, 1709, 1710, 22269, 178, 1711, 1714, 20112, 8379, 4936, 20114, 4943, 194, 8381, 20122, 4952, 20126, 4957, 20130, 216, 20131, 4961, 20135, 9026, 9027, 9028, 22511, 230, 22513, 233, 22514, 4973, 4974, 9052, 4975, 22515, 22480, 9059, 9060, 9066, 9068, 4981, 9074, 9075, 22519, 256, 4987, 4988, 260, 20153, 4997, 13757, 20164, 15083, 8395, 5016, 20173, 22281, 22282, 328, 330, 7612, 17585, 17586, 17588, 8403, 361, 372, 11242, 375, 377, 16754, 11266, 11274, 11299, 11315, 11331, 11362, 11378, 395], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_equal"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_equal"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_equal""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}",allegro_additive_loss_study,1.2975009688948929,,,0.40410946169731665,,0.19506967573962977,0.2,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,42453.0,0.03107866342748356,,16.011453169838806,,,0.011107820651811444,0.7960042566372442,,0.0019568811093831433,0.02430343068122242,,,,0.2,0.02779138074500485,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 30746},0.2814411703774567,,0.045522100647130775,,,1.523812090240879,,0.2,,0.2,,0.9317373300267924,5.373770211390009,0.2,,,0.000864346876500206,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.1385993077369268,0.24331797232896632,,,,,0.5414880799731601,,allegro_additive_loss_study/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_equal,5.0,2.0,2.0,float32,42.0,32.023188572145564,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_train.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val_b.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_test.xyz,e738e290,train:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_train.xyz|val:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_val_b.xyz|test:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_focal_focal_mse(coeff=1)|forces_angle_forces_angle(coeff=1)|stress_shear_stress_shear_mae(coeff=1),val1_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
29,allegro_additive_loss_study,stress_angle_rare_sampling,37098.980714039,43983.0,1751196012.4193175,{'runtime': 37099},150.0,,0.011627906976744186,0.5813953488372093,1e-06,0.4761379597579151,1.1819535520417943,0.09426982260112111,0.526786590252617,0.007574881115820603,0.0173853425463103,0.5753751616135739,,0.6016078026665873,0.01661377306134417,0.02809807879212245,,0.015933525306836973,0.0002963739660828709,0.0246259546051798,217650.0,0.4804610866305065,2.6386620672571253,0.1036442800883588,1.103076814528406,0.007483371717463628,0.016125615711183913,1.2526214991655715,1.01389271293897,9.269204265193329,0.6941972812933542,2.1725873221876313,0.017384062678577613,0.09881375702882154,3.846868448136594,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/stress_angle_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/stress_angle_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/stress_angle_rare_sampling_val.xyz"", ""data/stress_angle_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/stress_angle_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""stress_angle_rare_sampling"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/stress_angle_rare_sampling""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressAngleLoss""}, ""name"": ""stress_angle_stress_angle""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressAngleLoss""}, ""name"": ""stress_angle_stress_angle""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,0.11627906976744186,0.02347148383280889,0.027273986539186525,,,,,,,,,,,,,0.29069767441860467,0.02997693928242582,0.07257360028170468,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.4804610866305065,,,,,,,,,0.0246259546051798,,0.09426982260112111,,217650.0,0.4761379597579151,,,0.11627906976744186,0.0002963739660828709,,,0.29069767441860467,0.1036442800883588,,1.2526214991655715,,1.103076814528406,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressAngleLoss""}, ""name"": ""stress_angle_stress_angle""}]}",150.0,0.07257360028170468,,,37098.980714039,,,,,3.846868448136594,,,0.09881375702882154,,,1e-06,,,,,,,1751196012.4193175,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/stress_angle_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/stress_angle_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/stress_angle_rare_sampling_val.xyz"", ""data/stress_angle_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/stress_angle_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""stress_angle_rare_sampling"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/stress_angle_rare_sampling""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressAngleLoss""}, ""name"": ""stress_angle_stress_angle""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_additive_loss_study,1.1819535520417943,,,,,0.6016078026665873,0.5813953488372093,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,43983.0,0.017384062678577613,,9.269204265193329,0.02997693928242582,,0.01661377306134417,1.01389271293897,,0.015933525306836973,0.007574881115820603,0.02347148383280889,,,0.011627906976744186,0.007483371717463628,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 37099},0.526786590252617,,0.0173853425463103,,,2.6386620672571253,,,,,,0.6941972812933542,2.1725873221876313,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.02809807879212245,0.016125615711183913,0.027273986539186525,,,,0.5753751616135739,,allegro_additive_loss_study/stress_angle_rare_sampling,5.0,2.0,2.0,float32,42.0,32.00510198382953,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/stress_angle_rare_sampling_train.xyz,data/stress_angle_rare_sampling_val.xyz|data/stress_angle_rare_sampling_val_b.xyz,data/stress_angle_rare_sampling_test.xyz,6acc4220,train:data/stress_angle_rare_sampling_train.xyz|val:data/stress_angle_rare_sampling_val.xyz|data/stress_angle_rare_sampling_val_b.xyz|test:data/stress_angle_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|forces_auto_stratified_huber(coeff=10)|stress_mse(coeff=50)|stress_angle_stress_angle(coeff=25),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
30,allegro_additive_loss_study,base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1,94163.06687812,224563.0,1751257679.715952,{'runtime': 94163},200.0,,0.010416666666666666,0.5208333333333334,1e-06,0.2495778221759109,0.7098362476467378,0.07939546314087828,0.3576822232262957,0.007213922033182079,0.015562221114381365,0.3610268973291383,,0.20694777936483377,0.010820193950567433,0.05350363680369013,,0.0038772654628556145,2.7222317563424736e-05,0.07116114769977387,1119800.0,0.2606835469509859,1.057022895627351,0.13020098581150044,2.1019363441930743,0.010539029538337429,0.23920973862094416,1.1327229928137896,0.6072346054035452,14.92153571323142,0.9480911086950872,7.853549786144929,0.01344584388500535,0.05282440021973082,7.609303299865359,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [21758, 424, 425, 17662, 17663, 17666, 17667, 17669, 17670, 454, 9479, 6535, 9490, 6544, 470, 9507, 447, 9515, 9517, 20709, 9524, 9526, 9533, 9534, 9535, 20810, 9543, 9544, 20952, 9551, 9552, 9553, 21214, 9560, 9569, 9571, 22539, 9579, 22540, 22554, 5831, 9607, 9614, 9625, 9626, 6108, 9632, 9633, 17803, 17804, 17805, 17806, 23040, 17764, 17664, 17809, 564, 5201, 5221, 5226, 8953, 608, 620, 23148, 3968, 17332, 17346, 17355, 19422, 17458, 17459, 17672, 17673, 3983, 17681, 17687, 17688, 695, 3986, 17695, 19430, 17698, 17719, 19434, 17722, 17723, 17724, 17727, 17728, 3997, 17732, 17736, 719, 17741, 17743, 17745, 17746, 17747, 4005, 17752, 17754, 20385, 17756, 17760, 17761, 17762, 4011, 23291, 17771, 5317, 17775, 5318, 17779, 20392, 17781, 17787, 19451, 5320, 5324, 18148, 19455, 23375, 20398, 18161, 20399, 18165, 18166, 5330, 18172, 18178, 5334, 18181, 4032, 20404, 19462, 19463, 18182, 18186, 4036, 19465, 18190, 5341, 18194, 18198, 18202, 18565, 18567, 18571, 18590, 18593, 18597, 18598, 18603, 18080, 18610, 18612, 18613, 784, 19476, 18618, 4054, 19479, 18630, 18632, 19480, 4058, 2281, 5361, 2285, 5363, 20424, 20425, 18641, 18646, 18647, 18648, 18670, 2296, 18674, 20430, 2299, 18679, 5374, 19490, 18695, 18702, 18708, 4077, 18129, 18130, 18131, 847, 6684, 876, 878, 3403, 823, 859, 21991, 9744, 10314, 10322, 10330, 10340, 10355, 10362, 10370, 10378, 18218, 18221, 18222, 21998, 18224, 18118, 8003, 18226, 18227, 18231, 18134, 18135, 22007, 3412, 3413, 22016, 10755, 22017, 8032, 8041, 6225, 22028, 2459, 2461, 2467, 12637, 6758, 3425, 3426, 3427, 6776, 18337, 18347, 18349, 18352, 18354, 18356, 18360, 18369, 18372, 6819, 20562, 20563, 20564, 5565, 4727, 5584, 15673, 5597, 20594, 8176, 5607, 4308, 8183, 796, 2671, 2674, 2675, 2678, 2679, 2681, 2684, 2686, 2687, 2688, 2690, 12757, 12773, 6903, 12798, 12805, 12813, 12822, 12838, 2692, 6907, 2694, 2697, 19682, 2700, 2702, 18542, 18544, 12869, 18546, 3146, 3148, 3149, 18550, 18551, 19689, 3153, 3154, 3155, 3156, 3157, 18553, 18556, 3158, 3161, 3169, 3172, 3174, 3177, 22168, 3179, 3180, 3181, 3183, 3184, 3185, 8247, 3190, 3191, 3192, 3194, 3195, 3197, 3200, 3201, 3202, 8260, 3214, 3215, 3216, 22185, 3221, 3222, 3225, 3226, 22191, 3228, 3231, 5703, 3234, 3237, 8281, 13158, 3244, 3245, 3246, 3247, 8283, 3249, 3253, 9583, 3254, 3256, 8289, 3259, 3263, 3265, 3268, 3269, 3270, 3277, 3285, 3288, 3291, 3292, 3294, 3296, 3298, 3299, 3301, 3304, 3305, 3306, 3308, 3314, 3315, 3316, 3318, 3319, 3322, 3323, 3328, 3329, 3330, 3331, 3332, 4465, 3334, 3335, 3336, 3337, 3340, 3342, 3345, 3346, 3347, 3350, 3353, 3355, 3357, 22252, 3362, 3363, 3367, 3368, 3369, 3372, 22260, 18785, 18800, 3377, 3378, 3379, 3380, 18803, 18804, 18805, 18806, 18808, 18809, 3387, 18810, 4502, 3390, 3391, 18811, 18815, 18818, 18819, 18822, 4507, 3398, 3399, 3400, 18823, 3402, 18824, 18825, 4512, 18826, 18827, 18828, 3409, 18830, 18836, 18837, 18831, 18832, 18840, 18841, 18835, 4520, 18843, 18845, 3416, 18847, 18848, 3415, 3417, 18853, 3419, 18855, 3420, 18857, 3428, 3421, 3422, 3424, 3430, 18860, 3431, 3434, 3432, 3435, 18861, 19827, 18850, 18862, 18863, 3437, 3438, 3439, 3445, 3443, 3447, 3448, 3451, 3452, 25399, 25407, 3457, 3458, 4549, 3460, 3461, 25415, 3463, 3464, 3466, 25448, 3469, 3470, 25463, 3473, 3475, 3476, 8436, 3478, 3480, 3482, 3483, 3484, 3486, 19851, 3489, 3490, 3491, 3493, 3496, 3497, 4574, 3499, 19856, 3500, 3502, 3503, 3504, 3505, 3508, 3513, 3517, 3523, 3527, 3528, 3529, 3531, 3532, 3151, 3535, 3537, 5902, 3548, 7221, 3554, 3555, 3557, 3559, 19884, 4617, 3562, 4618, 3563, 3564, 3566, 3568, 3570, 19891, 4625, 3572, 19892, 4627, 3574, 3575, 19894, 3576, 3579, 3580, 3583, 3584, 3585, 19898, 3587, 3588, 3589, 3591, 3593, 19902, 3595, 3596, 3600, 4645, 3602, 3603, 19907, 4648, 19908, 3610, 3611, 3612, 3613, 4653, 3615, 3619, 3620, 4658, 3621, 3622, 3624, 3625, 19917, 3626, 3628, 3623, 3633, 3634, 3635, 3636, 3639, 3640, 3641, 19925, 3645, 3646, 3648, 3651, 19930, 3654, 19931, 3656, 3657, 3659, 3660, 19933, 3661, 3662, 3664, 3665, 3666, 3667, 4689, 3668, 3669, 3670, 3671, 3672, 3673, 3675, 3676, 3677, 3678, 24490, 3683, 3684, 3688, 21477, 3690, 3691, 1382, 1383, 1384, 3695, 3696, 1387, 1388, 3699, 3700, 3701, 1390, 3703, 3704, 1391, 1392, 3707, 1394, 11491, 4716, 3711, 1399, 1400, 3716, 19960, 3718, 3719, 3720, 3722, 3723, 3724, 3727, 3729, 3730, 3732, 7304, 3735, 3736, 3737, 3738, 3744, 3746, 3748, 3749, 3753, 3754, 3755, 3757, 3761, 7321, 3763, 3765, 3766, 3767, 21513, 7328, 3774, 3775, 3777, 7332, 3779, 7339, 7345, 19237, 21532, 21535, 19247, 19248, 4788, 20008, 4789, 21538, 20010, 4791, 20011, 19259, 19262, 21543, 19264, 19265, 20015, 19269, 7372, 19271, 19272, 20019, 4810, 4813, 7391, 23, 21562, 20033, 4824, 7399, 7402, 20041, 7407, 4836, 20047, 7415, 20048, 4845, 21579, 63, 64, 14804, 21585, 7428, 4859, 21589, 21590, 7434, 14829, 14868, 14885, 82, 83, 4870, 84, 86, 87, 88, 89, 90, 14893, 14900, 14927, 99, 22262, 4887, 107, 14941, 1657, 1659, 11707, 11715, 11723, 4894, 11747, 11771, 1660, 1662, 1663, 1665, 1669, 24633, 11788, 1670, 1673, 1674, 1675, 4908, 11795, 1676, 1678, 1679, 1680, 1683, 1685, 1686, 1687, 1689, 1693, 1694, 157, 1698, 20105, 1702, 11803, 1705, 1704, 10861, 4929, 1709, 1710, 22269, 178, 1711, 1714, 20112, 8379, 4936, 20114, 4943, 194, 8381, 20122, 4952, 20126, 4957, 20130, 216, 20131, 4961, 20135, 9026, 9027, 9028, 22511, 230, 22513, 233, 22514, 4973, 4974, 9052, 4975, 22515, 22480, 9059, 9060, 9066, 9068, 4981, 9074, 9075, 22519, 256, 4987, 4988, 260, 20153, 4997, 13757, 20164, 15083, 8395, 5016, 20173, 22281, 22282, 328, 330, 7612, 17585, 17586, 17588, 8403, 361, 372, 11242, 375, 377, 16754, 11266, 11274, 11299, 11315, 11331, 11362, 11378, 395], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1""}, ""max_epochs"": 200, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,0.10416666666666669,0.0695166215022844,0.006334448004933777,0.10416666666666669,0.2604166666666667,0.36604481831718433,0.0013110903226543882,0.6733774075488136,0.0011645296919915928,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.2606835469509859,,,,,,,0.6733774075488136,,0.07116114769977387,,0.07939546314087828,,1119800.0,0.2495778221759109,,,,2.7222317563424736e-05,0.0695166215022844,,,0.13020098581150044,,1.1327229928137896,,2.1019363441930743,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}",200.0,,,,94163.06687812,,,,,7.609303299865359,0.006334448004933777,,0.05282440021973082,,,1e-06,,,0.0013110903226543882,,,,1751257679.715952,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [21758, 424, 425, 17662, 17663, 17666, 17667, 17669, 17670, 454, 9479, 6535, 9490, 6544, 470, 9507, 447, 9515, 9517, 20709, 9524, 9526, 9533, 9534, 9535, 20810, 9543, 9544, 20952, 9551, 9552, 9553, 21214, 9560, 9569, 9571, 22539, 9579, 22540, 22554, 5831, 9607, 9614, 9625, 9626, 6108, 9632, 9633, 17803, 17804, 17805, 17806, 23040, 17764, 17664, 17809, 564, 5201, 5221, 5226, 8953, 608, 620, 23148, 3968, 17332, 17346, 17355, 19422, 17458, 17459, 17672, 17673, 3983, 17681, 17687, 17688, 695, 3986, 17695, 19430, 17698, 17719, 19434, 17722, 17723, 17724, 17727, 17728, 3997, 17732, 17736, 719, 17741, 17743, 17745, 17746, 17747, 4005, 17752, 17754, 20385, 17756, 17760, 17761, 17762, 4011, 23291, 17771, 5317, 17775, 5318, 17779, 20392, 17781, 17787, 19451, 5320, 5324, 18148, 19455, 23375, 20398, 18161, 20399, 18165, 18166, 5330, 18172, 18178, 5334, 18181, 4032, 20404, 19462, 19463, 18182, 18186, 4036, 19465, 18190, 5341, 18194, 18198, 18202, 18565, 18567, 18571, 18590, 18593, 18597, 18598, 18603, 18080, 18610, 18612, 18613, 784, 19476, 18618, 4054, 19479, 18630, 18632, 19480, 4058, 2281, 5361, 2285, 5363, 20424, 20425, 18641, 18646, 18647, 18648, 18670, 2296, 18674, 20430, 2299, 18679, 5374, 19490, 18695, 18702, 18708, 4077, 18129, 18130, 18131, 847, 6684, 876, 878, 3403, 823, 859, 21991, 9744, 10314, 10322, 10330, 10340, 10355, 10362, 10370, 10378, 18218, 18221, 18222, 21998, 18224, 18118, 8003, 18226, 18227, 18231, 18134, 18135, 22007, 3412, 3413, 22016, 10755, 22017, 8032, 8041, 6225, 22028, 2459, 2461, 2467, 12637, 6758, 3425, 3426, 3427, 6776, 18337, 18347, 18349, 18352, 18354, 18356, 18360, 18369, 18372, 6819, 20562, 20563, 20564, 5565, 4727, 5584, 15673, 5597, 20594, 8176, 5607, 4308, 8183, 796, 2671, 2674, 2675, 2678, 2679, 2681, 2684, 2686, 2687, 2688, 2690, 12757, 12773, 6903, 12798, 12805, 12813, 12822, 12838, 2692, 6907, 2694, 2697, 19682, 2700, 2702, 18542, 18544, 12869, 18546, 3146, 3148, 3149, 18550, 18551, 19689, 3153, 3154, 3155, 3156, 3157, 18553, 18556, 3158, 3161, 3169, 3172, 3174, 3177, 22168, 3179, 3180, 3181, 3183, 3184, 3185, 8247, 3190, 3191, 3192, 3194, 3195, 3197, 3200, 3201, 3202, 8260, 3214, 3215, 3216, 22185, 3221, 3222, 3225, 3226, 22191, 3228, 3231, 5703, 3234, 3237, 8281, 13158, 3244, 3245, 3246, 3247, 8283, 3249, 3253, 9583, 3254, 3256, 8289, 3259, 3263, 3265, 3268, 3269, 3270, 3277, 3285, 3288, 3291, 3292, 3294, 3296, 3298, 3299, 3301, 3304, 3305, 3306, 3308, 3314, 3315, 3316, 3318, 3319, 3322, 3323, 3328, 3329, 3330, 3331, 3332, 4465, 3334, 3335, 3336, 3337, 3340, 3342, 3345, 3346, 3347, 3350, 3353, 3355, 3357, 22252, 3362, 3363, 3367, 3368, 3369, 3372, 22260, 18785, 18800, 3377, 3378, 3379, 3380, 18803, 18804, 18805, 18806, 18808, 18809, 3387, 18810, 4502, 3390, 3391, 18811, 18815, 18818, 18819, 18822, 4507, 3398, 3399, 3400, 18823, 3402, 18824, 18825, 4512, 18826, 18827, 18828, 3409, 18830, 18836, 18837, 18831, 18832, 18840, 18841, 18835, 4520, 18843, 18845, 3416, 18847, 18848, 3415, 3417, 18853, 3419, 18855, 3420, 18857, 3428, 3421, 3422, 3424, 3430, 18860, 3431, 3434, 3432, 3435, 18861, 19827, 18850, 18862, 18863, 3437, 3438, 3439, 3445, 3443, 3447, 3448, 3451, 3452, 25399, 25407, 3457, 3458, 4549, 3460, 3461, 25415, 3463, 3464, 3466, 25448, 3469, 3470, 25463, 3473, 3475, 3476, 8436, 3478, 3480, 3482, 3483, 3484, 3486, 19851, 3489, 3490, 3491, 3493, 3496, 3497, 4574, 3499, 19856, 3500, 3502, 3503, 3504, 3505, 3508, 3513, 3517, 3523, 3527, 3528, 3529, 3531, 3532, 3151, 3535, 3537, 5902, 3548, 7221, 3554, 3555, 3557, 3559, 19884, 4617, 3562, 4618, 3563, 3564, 3566, 3568, 3570, 19891, 4625, 3572, 19892, 4627, 3574, 3575, 19894, 3576, 3579, 3580, 3583, 3584, 3585, 19898, 3587, 3588, 3589, 3591, 3593, 19902, 3595, 3596, 3600, 4645, 3602, 3603, 19907, 4648, 19908, 3610, 3611, 3612, 3613, 4653, 3615, 3619, 3620, 4658, 3621, 3622, 3624, 3625, 19917, 3626, 3628, 3623, 3633, 3634, 3635, 3636, 3639, 3640, 3641, 19925, 3645, 3646, 3648, 3651, 19930, 3654, 19931, 3656, 3657, 3659, 3660, 19933, 3661, 3662, 3664, 3665, 3666, 3667, 4689, 3668, 3669, 3670, 3671, 3672, 3673, 3675, 3676, 3677, 3678, 24490, 3683, 3684, 3688, 21477, 3690, 3691, 1382, 1383, 1384, 3695, 3696, 1387, 1388, 3699, 3700, 3701, 1390, 3703, 3704, 1391, 1392, 3707, 1394, 11491, 4716, 3711, 1399, 1400, 3716, 19960, 3718, 3719, 3720, 3722, 3723, 3724, 3727, 3729, 3730, 3732, 7304, 3735, 3736, 3737, 3738, 3744, 3746, 3748, 3749, 3753, 3754, 3755, 3757, 3761, 7321, 3763, 3765, 3766, 3767, 21513, 7328, 3774, 3775, 3777, 7332, 3779, 7339, 7345, 19237, 21532, 21535, 19247, 19248, 4788, 20008, 4789, 21538, 20010, 4791, 20011, 19259, 19262, 21543, 19264, 19265, 20015, 19269, 7372, 19271, 19272, 20019, 4810, 4813, 7391, 23, 21562, 20033, 4824, 7399, 7402, 20041, 7407, 4836, 20047, 7415, 20048, 4845, 21579, 63, 64, 14804, 21585, 7428, 4859, 21589, 21590, 7434, 14829, 14868, 14885, 82, 83, 4870, 84, 86, 87, 88, 89, 90, 14893, 14900, 14927, 99, 22262, 4887, 107, 14941, 1657, 1659, 11707, 11715, 11723, 4894, 11747, 11771, 1660, 1662, 1663, 1665, 1669, 24633, 11788, 1670, 1673, 1674, 1675, 4908, 11795, 1676, 1678, 1679, 1680, 1683, 1685, 1686, 1687, 1689, 1693, 1694, 157, 1698, 20105, 1702, 11803, 1705, 1704, 10861, 4929, 1709, 1710, 22269, 178, 1711, 1714, 20112, 8379, 4936, 20114, 4943, 194, 8381, 20122, 4952, 20126, 4957, 20130, 216, 20131, 4961, 20135, 9026, 9027, 9028, 22511, 230, 22513, 233, 22514, 4973, 4974, 9052, 4975, 22515, 22480, 9059, 9060, 9066, 9068, 4981, 9074, 9075, 22519, 256, 4987, 4988, 260, 20153, 4997, 13757, 20164, 15083, 8395, 5016, 20173, 22281, 22282, 328, 330, 7612, 17585, 17586, 17588, 8403, 361, 372, 11242, 375, 377, 16754, 11266, 11274, 11299, 11315, 11331, 11362, 11378, 395], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1""}, ""max_epochs"": 200, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}",allegro_additive_loss_study,0.7098362476467378,,,0.36604481831718433,,0.20694777936483377,0.5208333333333334,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,224563.0,0.01344584388500535,,14.92153571323142,,,0.010820193950567433,0.6072346054035452,,0.0038772654628556145,0.007213922033182079,,,,0.010416666666666666,0.010539029538337429,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 94163},0.3576822232262957,,0.015562221114381365,,,1.057022895627351,,0.2604166666666667,,0.10416666666666669,,0.9480911086950872,7.853549786144929,0.10416666666666669,,,0.0011645296919915928,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.05350363680369013,0.23920973862094416,,,,,0.3610268973291383,,allegro_additive_loss_study/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1,5.0,2.0,2.0,float32,42.0,32.023188572145564,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_train.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_val_b.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_test.xyz,331517ce,train:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_train.xyz|val:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_val_b.xyz|test:data/base_force_angle_focal_stress_shear_rare_sampling_softadapt_nobadid_b1_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_focal_focal_mse(coeff=10)|forces_angle_forces_angle(coeff=10)|stress_shear_stress_shear_mae(coeff=25),val1_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,200.0,200.0
31,allegro_additive_loss_study,base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1,94393.636686226,224563.0,1751258742.4161985,{'runtime': 94394},200.0,,0.1665219359381737,0.21503873807037577,1e-06,0.23754640244737132,0.6024234950602847,0.05601504720718507,0.27717436291892406,0.00796277214845759,0.016796762958991514,0.29879820697940007,,0.195796145451702,0.011033634070380265,0.13033306254814006,,0.0007791740673100845,9.046392255768743e-05,0.1418199309059399,1119800.0,0.25077875755633483,1.3384670096481384,0.10635237295412904,2.0691281425078585,0.011319105502394676,0.2402675330585446,1.2159542284048472,0.5482522516553975,11.388449901074516,0.6884884578759578,7.832561177135141,0.013020812502065672,0.05398817183935355,6.424999750016337,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [21758, 424, 425, 17662, 17663, 17666, 17667, 17669, 17670, 454, 9479, 6535, 9490, 6544, 470, 9507, 447, 9515, 9517, 20709, 9524, 9526, 9533, 9534, 9535, 20810, 9543, 9544, 20952, 9551, 9552, 9553, 21214, 9560, 9569, 9571, 22539, 9579, 22540, 22554, 5831, 9607, 9614, 9625, 9626, 6108, 9632, 9633, 17803, 17804, 17805, 17806, 23040, 17764, 17664, 17809, 564, 5201, 5221, 5226, 8953, 608, 620, 23148, 3968, 17332, 17346, 17355, 19422, 17458, 17459, 17672, 17673, 3983, 17681, 17687, 17688, 695, 3986, 17695, 19430, 17698, 17719, 19434, 17722, 17723, 17724, 17727, 17728, 3997, 17732, 17736, 719, 17741, 17743, 17745, 17746, 17747, 4005, 17752, 17754, 20385, 17756, 17760, 17761, 17762, 4011, 23291, 17771, 5317, 17775, 5318, 17779, 20392, 17781, 17787, 19451, 5320, 5324, 18148, 19455, 23375, 20398, 18161, 20399, 18165, 18166, 5330, 18172, 18178, 5334, 18181, 4032, 20404, 19462, 19463, 18182, 18186, 4036, 19465, 18190, 5341, 18194, 18198, 18202, 18565, 18567, 18571, 18590, 18593, 18597, 18598, 18603, 18080, 18610, 18612, 18613, 784, 19476, 18618, 4054, 19479, 18630, 18632, 19480, 4058, 2281, 5361, 2285, 5363, 20424, 20425, 18641, 18646, 18647, 18648, 18670, 2296, 18674, 20430, 2299, 18679, 5374, 19490, 18695, 18702, 18708, 4077, 18129, 18130, 18131, 847, 6684, 876, 878, 3403, 823, 859, 21991, 9744, 10314, 10322, 10330, 10340, 10355, 10362, 10370, 10378, 18218, 18221, 18222, 21998, 18224, 18118, 8003, 18226, 18227, 18231, 18134, 18135, 22007, 3412, 3413, 22016, 10755, 22017, 8032, 8041, 6225, 22028, 2459, 2461, 2467, 12637, 6758, 3425, 3426, 3427, 6776, 18337, 18347, 18349, 18352, 18354, 18356, 18360, 18369, 18372, 6819, 20562, 20563, 20564, 5565, 4727, 5584, 15673, 5597, 20594, 8176, 5607, 4308, 8183, 796, 2671, 2674, 2675, 2678, 2679, 2681, 2684, 2686, 2687, 2688, 2690, 12757, 12773, 6903, 12798, 12805, 12813, 12822, 12838, 2692, 6907, 2694, 2697, 19682, 2700, 2702, 18542, 18544, 12869, 18546, 3146, 3148, 3149, 18550, 18551, 19689, 3153, 3154, 3155, 3156, 3157, 18553, 18556, 3158, 3161, 3169, 3172, 3174, 3177, 22168, 3179, 3180, 3181, 3183, 3184, 3185, 8247, 3190, 3191, 3192, 3194, 3195, 3197, 3200, 3201, 3202, 8260, 3214, 3215, 3216, 22185, 3221, 3222, 3225, 3226, 22191, 3228, 3231, 5703, 3234, 3237, 8281, 13158, 3244, 3245, 3246, 3247, 8283, 3249, 3253, 9583, 3254, 3256, 8289, 3259, 3263, 3265, 3268, 3269, 3270, 3277, 3285, 3288, 3291, 3292, 3294, 3296, 3298, 3299, 3301, 3304, 3305, 3306, 3308, 3314, 3315, 3316, 3318, 3319, 3322, 3323, 3328, 3329, 3330, 3331, 3332, 4465, 3334, 3335, 3336, 3337, 3340, 3342, 3345, 3346, 3347, 3350, 3353, 3355, 3357, 22252, 3362, 3363, 3367, 3368, 3369, 3372, 22260, 18785, 18800, 3377, 3378, 3379, 3380, 18803, 18804, 18805, 18806, 18808, 18809, 3387, 18810, 4502, 3390, 3391, 18811, 18815, 18818, 18819, 18822, 4507, 3398, 3399, 3400, 18823, 3402, 18824, 18825, 4512, 18826, 18827, 18828, 3409, 18830, 18836, 18837, 18831, 18832, 18840, 18841, 18835, 4520, 18843, 18845, 3416, 18847, 18848, 3415, 3417, 18853, 3419, 18855, 3420, 18857, 3428, 3421, 3422, 3424, 3430, 18860, 3431, 3434, 3432, 3435, 18861, 19827, 18850, 18862, 18863, 3437, 3438, 3439, 3445, 3443, 3447, 3448, 3451, 3452, 25399, 25407, 3457, 3458, 4549, 3460, 3461, 25415, 3463, 3464, 3466, 25448, 3469, 3470, 25463, 3473, 3475, 3476, 8436, 3478, 3480, 3482, 3483, 3484, 3486, 19851, 3489, 3490, 3491, 3493, 3496, 3497, 4574, 3499, 19856, 3500, 3502, 3503, 3504, 3505, 3508, 3513, 3517, 3523, 3527, 3528, 3529, 3531, 3532, 3151, 3535, 3537, 5902, 3548, 7221, 3554, 3555, 3557, 3559, 19884, 4617, 3562, 4618, 3563, 3564, 3566, 3568, 3570, 19891, 4625, 3572, 19892, 4627, 3574, 3575, 19894, 3576, 3579, 3580, 3583, 3584, 3585, 19898, 3587, 3588, 3589, 3591, 3593, 19902, 3595, 3596, 3600, 4645, 3602, 3603, 19907, 4648, 19908, 3610, 3611, 3612, 3613, 4653, 3615, 3619, 3620, 4658, 3621, 3622, 3624, 3625, 19917, 3626, 3628, 3623, 3633, 3634, 3635, 3636, 3639, 3640, 3641, 19925, 3645, 3646, 3648, 3651, 19930, 3654, 19931, 3656, 3657, 3659, 3660, 19933, 3661, 3662, 3664, 3665, 3666, 3667, 4689, 3668, 3669, 3670, 3671, 3672, 3673, 3675, 3676, 3677, 3678, 24490, 3683, 3684, 3688, 21477, 3690, 3691, 1382, 1383, 1384, 3695, 3696, 1387, 1388, 3699, 3700, 3701, 1390, 3703, 3704, 1391, 1392, 3707, 1394, 11491, 4716, 3711, 1399, 1400, 3716, 19960, 3718, 3719, 3720, 3722, 3723, 3724, 3727, 3729, 3730, 3732, 7304, 3735, 3736, 3737, 3738, 3744, 3746, 3748, 3749, 3753, 3754, 3755, 3757, 3761, 7321, 3763, 3765, 3766, 3767, 21513, 7328, 3774, 3775, 3777, 7332, 3779, 7339, 7345, 19237, 21532, 21535, 19247, 19248, 4788, 20008, 4789, 21538, 20010, 4791, 20011, 19259, 19262, 21543, 19264, 19265, 20015, 19269, 7372, 19271, 19272, 20019, 4810, 4813, 7391, 23, 21562, 20033, 4824, 7399, 7402, 20041, 7407, 4836, 20047, 7415, 20048, 4845, 21579, 63, 64, 14804, 21585, 7428, 4859, 21589, 21590, 7434, 14829, 14868, 14885, 82, 83, 4870, 84, 86, 87, 88, 89, 90, 14893, 14900, 14927, 99, 22262, 4887, 107, 14941, 1657, 1659, 11707, 11715, 11723, 4894, 11747, 11771, 1660, 1662, 1663, 1665, 1669, 24633, 11788, 1670, 1673, 1674, 1675, 4908, 11795, 1676, 1678, 1679, 1680, 1683, 1685, 1686, 1687, 1689, 1693, 1694, 157, 1698, 20105, 1702, 11803, 1705, 1704, 10861, 4929, 1709, 1710, 22269, 178, 1711, 1714, 20112, 8379, 4936, 20114, 4943, 194, 8381, 20122, 4952, 20126, 4957, 20130, 216, 20131, 4961, 20135, 9026, 9027, 9028, 22511, 230, 22513, 233, 22514, 4973, 4974, 9052, 4975, 22515, 22480, 9059, 9060, 9066, 9068, 4981, 9074, 9075, 22519, 256, 4987, 4988, 260, 20153, 4997, 13757, 20164, 15083, 8395, 5016, 20173, 22281, 22282, 328, 330, 7612, 17585, 17586, 17588, 8403, 361, 372, 11242, 375, 377, 16754, 11266, 11274, 11299, 11315, 11331, 11362, 11378, 395], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1""}, ""max_epochs"": 200, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,0.19532353393067364,0.07704946245020171,0.00733595094118442,0.2055657540384098,0.21755003802236705,0.3889493434633906,0.001617155527230422,0.6807540976214967,0.0013703276354557169,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.25077875755633483,,,,,,,0.6807540976214967,,0.1418199309059399,,0.05601504720718507,,1119800.0,0.23754640244737132,,,,9.046392255768743e-05,0.07704946245020171,,,0.10635237295412904,,1.2159542284048472,,2.0691281425078585,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}",200.0,,,,94393.636686226,,,,,6.424999750016337,0.00733595094118442,,0.05398817183935355,,,1e-06,,,0.001617155527230422,,,,1751258742.4161985,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [21758, 424, 425, 17662, 17663, 17666, 17667, 17669, 17670, 454, 9479, 6535, 9490, 6544, 470, 9507, 447, 9515, 9517, 20709, 9524, 9526, 9533, 9534, 9535, 20810, 9543, 9544, 20952, 9551, 9552, 9553, 21214, 9560, 9569, 9571, 22539, 9579, 22540, 22554, 5831, 9607, 9614, 9625, 9626, 6108, 9632, 9633, 17803, 17804, 17805, 17806, 23040, 17764, 17664, 17809, 564, 5201, 5221, 5226, 8953, 608, 620, 23148, 3968, 17332, 17346, 17355, 19422, 17458, 17459, 17672, 17673, 3983, 17681, 17687, 17688, 695, 3986, 17695, 19430, 17698, 17719, 19434, 17722, 17723, 17724, 17727, 17728, 3997, 17732, 17736, 719, 17741, 17743, 17745, 17746, 17747, 4005, 17752, 17754, 20385, 17756, 17760, 17761, 17762, 4011, 23291, 17771, 5317, 17775, 5318, 17779, 20392, 17781, 17787, 19451, 5320, 5324, 18148, 19455, 23375, 20398, 18161, 20399, 18165, 18166, 5330, 18172, 18178, 5334, 18181, 4032, 20404, 19462, 19463, 18182, 18186, 4036, 19465, 18190, 5341, 18194, 18198, 18202, 18565, 18567, 18571, 18590, 18593, 18597, 18598, 18603, 18080, 18610, 18612, 18613, 784, 19476, 18618, 4054, 19479, 18630, 18632, 19480, 4058, 2281, 5361, 2285, 5363, 20424, 20425, 18641, 18646, 18647, 18648, 18670, 2296, 18674, 20430, 2299, 18679, 5374, 19490, 18695, 18702, 18708, 4077, 18129, 18130, 18131, 847, 6684, 876, 878, 3403, 823, 859, 21991, 9744, 10314, 10322, 10330, 10340, 10355, 10362, 10370, 10378, 18218, 18221, 18222, 21998, 18224, 18118, 8003, 18226, 18227, 18231, 18134, 18135, 22007, 3412, 3413, 22016, 10755, 22017, 8032, 8041, 6225, 22028, 2459, 2461, 2467, 12637, 6758, 3425, 3426, 3427, 6776, 18337, 18347, 18349, 18352, 18354, 18356, 18360, 18369, 18372, 6819, 20562, 20563, 20564, 5565, 4727, 5584, 15673, 5597, 20594, 8176, 5607, 4308, 8183, 796, 2671, 2674, 2675, 2678, 2679, 2681, 2684, 2686, 2687, 2688, 2690, 12757, 12773, 6903, 12798, 12805, 12813, 12822, 12838, 2692, 6907, 2694, 2697, 19682, 2700, 2702, 18542, 18544, 12869, 18546, 3146, 3148, 3149, 18550, 18551, 19689, 3153, 3154, 3155, 3156, 3157, 18553, 18556, 3158, 3161, 3169, 3172, 3174, 3177, 22168, 3179, 3180, 3181, 3183, 3184, 3185, 8247, 3190, 3191, 3192, 3194, 3195, 3197, 3200, 3201, 3202, 8260, 3214, 3215, 3216, 22185, 3221, 3222, 3225, 3226, 22191, 3228, 3231, 5703, 3234, 3237, 8281, 13158, 3244, 3245, 3246, 3247, 8283, 3249, 3253, 9583, 3254, 3256, 8289, 3259, 3263, 3265, 3268, 3269, 3270, 3277, 3285, 3288, 3291, 3292, 3294, 3296, 3298, 3299, 3301, 3304, 3305, 3306, 3308, 3314, 3315, 3316, 3318, 3319, 3322, 3323, 3328, 3329, 3330, 3331, 3332, 4465, 3334, 3335, 3336, 3337, 3340, 3342, 3345, 3346, 3347, 3350, 3353, 3355, 3357, 22252, 3362, 3363, 3367, 3368, 3369, 3372, 22260, 18785, 18800, 3377, 3378, 3379, 3380, 18803, 18804, 18805, 18806, 18808, 18809, 3387, 18810, 4502, 3390, 3391, 18811, 18815, 18818, 18819, 18822, 4507, 3398, 3399, 3400, 18823, 3402, 18824, 18825, 4512, 18826, 18827, 18828, 3409, 18830, 18836, 18837, 18831, 18832, 18840, 18841, 18835, 4520, 18843, 18845, 3416, 18847, 18848, 3415, 3417, 18853, 3419, 18855, 3420, 18857, 3428, 3421, 3422, 3424, 3430, 18860, 3431, 3434, 3432, 3435, 18861, 19827, 18850, 18862, 18863, 3437, 3438, 3439, 3445, 3443, 3447, 3448, 3451, 3452, 25399, 25407, 3457, 3458, 4549, 3460, 3461, 25415, 3463, 3464, 3466, 25448, 3469, 3470, 25463, 3473, 3475, 3476, 8436, 3478, 3480, 3482, 3483, 3484, 3486, 19851, 3489, 3490, 3491, 3493, 3496, 3497, 4574, 3499, 19856, 3500, 3502, 3503, 3504, 3505, 3508, 3513, 3517, 3523, 3527, 3528, 3529, 3531, 3532, 3151, 3535, 3537, 5902, 3548, 7221, 3554, 3555, 3557, 3559, 19884, 4617, 3562, 4618, 3563, 3564, 3566, 3568, 3570, 19891, 4625, 3572, 19892, 4627, 3574, 3575, 19894, 3576, 3579, 3580, 3583, 3584, 3585, 19898, 3587, 3588, 3589, 3591, 3593, 19902, 3595, 3596, 3600, 4645, 3602, 3603, 19907, 4648, 19908, 3610, 3611, 3612, 3613, 4653, 3615, 3619, 3620, 4658, 3621, 3622, 3624, 3625, 19917, 3626, 3628, 3623, 3633, 3634, 3635, 3636, 3639, 3640, 3641, 19925, 3645, 3646, 3648, 3651, 19930, 3654, 19931, 3656, 3657, 3659, 3660, 19933, 3661, 3662, 3664, 3665, 3666, 3667, 4689, 3668, 3669, 3670, 3671, 3672, 3673, 3675, 3676, 3677, 3678, 24490, 3683, 3684, 3688, 21477, 3690, 3691, 1382, 1383, 1384, 3695, 3696, 1387, 1388, 3699, 3700, 3701, 1390, 3703, 3704, 1391, 1392, 3707, 1394, 11491, 4716, 3711, 1399, 1400, 3716, 19960, 3718, 3719, 3720, 3722, 3723, 3724, 3727, 3729, 3730, 3732, 7304, 3735, 3736, 3737, 3738, 3744, 3746, 3748, 3749, 3753, 3754, 3755, 3757, 3761, 7321, 3763, 3765, 3766, 3767, 21513, 7328, 3774, 3775, 3777, 7332, 3779, 7339, 7345, 19237, 21532, 21535, 19247, 19248, 4788, 20008, 4789, 21538, 20010, 4791, 20011, 19259, 19262, 21543, 19264, 19265, 20015, 19269, 7372, 19271, 19272, 20019, 4810, 4813, 7391, 23, 21562, 20033, 4824, 7399, 7402, 20041, 7407, 4836, 20047, 7415, 20048, 4845, 21579, 63, 64, 14804, 21585, 7428, 4859, 21589, 21590, 7434, 14829, 14868, 14885, 82, 83, 4870, 84, 86, 87, 88, 89, 90, 14893, 14900, 14927, 99, 22262, 4887, 107, 14941, 1657, 1659, 11707, 11715, 11723, 4894, 11747, 11771, 1660, 1662, 1663, 1665, 1669, 24633, 11788, 1670, 1673, 1674, 1675, 4908, 11795, 1676, 1678, 1679, 1680, 1683, 1685, 1686, 1687, 1689, 1693, 1694, 157, 1698, 20105, 1702, 11803, 1705, 1704, 10861, 4929, 1709, 1710, 22269, 178, 1711, 1714, 20112, 8379, 4936, 20114, 4943, 194, 8381, 20122, 4952, 20126, 4957, 20130, 216, 20131, 4961, 20135, 9026, 9027, 9028, 22511, 230, 22513, 233, 22514, 4973, 4974, 9052, 4975, 22515, 22480, 9059, 9060, 9066, 9068, 4981, 9074, 9075, 22519, 256, 4987, 4988, 260, 20153, 4997, 13757, 20164, 15083, 8395, 5016, 20173, 22281, 22282, 328, 330, 7612, 17585, 17586, 17588, 8403, 361, 372, 11242, 375, 377, 16754, 11266, 11274, 11299, 11315, 11331, 11362, 11378, 395], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_val.xyz"", ""data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1""}, ""max_epochs"": 200, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.13698892862497836}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}",allegro_additive_loss_study,0.6024234950602847,,,0.3889493434633906,,0.195796145451702,0.21503873807037577,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,224563.0,0.013020812502065672,,11.388449901074516,,,0.011033634070380265,0.5482522516553975,,0.0007791740673100845,0.00796277214845759,,,,0.1665219359381737,0.011319105502394676,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.023188572145564, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.299859996260031, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 94394},0.27717436291892406,,0.016796762958991514,,,1.3384670096481384,,0.21755003802236705,,0.19532353393067364,,0.6884884578759578,7.832561177135141,0.2055657540384098,,,0.0013703276354557169,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.13033306254814006,0.2402675330585446,,,,,0.29879820697940007,,allegro_additive_loss_study/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1,5.0,2.0,2.0,float32,42.0,32.023188572145564,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_train.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_val_b.xyz,data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_test.xyz,3328f06c,train:data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_train.xyz|val:data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_val.xyz|data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_val_b.xyz|test:data/base_force_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_focal_focal_mse(coeff=10)|forces_angle_forces_angle(coeff=10)|stress_shear_stress_shear_mae(coeff=25),val1_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,200.0,200.0
32,allegro_additive_loss_study,base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_equal,78627.118406619,167061.0,1751256796.699411,{'runtime': 78627},155.0,,0.186824610575438,0.15191006168419202,1.5625e-05,1.0426849308829045,2.50409834827544,10.297113498738549,10.458116490918238,0.2212071481587977,0.4026350379986317,4.454949959064104,,0.7214848937953514,0.01858782585469516,0.222348316427514,,0.0005129343951358716,0.0001352931591205314,0.021511687406847172,832969.0,0.22599503877420885,0.42872486295616347,0.0561961240776599,0.19342952746620723,0.009092729177661725,0.01997199445024314,0.21404212829087127,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_equal"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_equal"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_equal""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010350672528147696, 0.4257718026638031, 2.7886428833007812], ""deltas"": [0.0010350672528147695, 0.0010350672528147695, 0.04257718026638031, 0.27886428833007815]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.07660671785887388}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06493972179287, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.0536854723657, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010350672528147696, 0.4257718026638031, 2.7886428833007812], ""deltas"": [0.0010350672528147695, 0.0010350672528147695, 0.04257718026638031, 0.27886428833007815]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.07660671785887388}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06493972179287, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.0536854723657, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,0.1509926169923328,0.016029103280278127,0.013638890463708288,0.21080698756289715,0.12275711253662344,0.02526913281098678,0.14809398971580645,0.1513717334693336,0.37902755342022626,0.0020047890230377105,0.09393865866060154,0.0006426164518996508,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.22599503877420885,,,,,,,0.09393865866060154,,0.021511687406847172,,10.297113498738549,,832969.0,1.0426849308829045,,,0.1509926169923328,0.0001352931591205314,0.12275711253662344,,,0.0561961240776599,,0.21404212829087127,,0.19342952746620723,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010350672528147696, 0.4257718026638031, 2.7886428833007812], ""deltas"": [0.0010350672528147695, 0.0010350672528147695, 0.04257718026638031, 0.27886428833007815]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.07660671785887388}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}",155.0,,,,78627.118406619,,,,,,0.02526913281098678,,,,,1.5625e-05,,,0.0020047890230377105,,,,1751256796.699411,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_equal"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_equal"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_equal""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.010350672528147696, 0.4257718026638031, 2.7886428833007812], ""deltas"": [0.0010350672528147695, 0.0010350672528147695, 0.04257718026638031, 0.27886428833007815]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.FocalMSELoss"", ""beta"": 0.07660671785887388}, ""name"": ""forces_focal_focal_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.ForceAngleLoss""}, ""name"": ""forces_angle_forces_angle""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06493972179287, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.0536854723657, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_additive_loss_study,2.50409834827544,,,0.37902755342022626,,0.7214848937953514,0.15191006168419202,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,167061.0,,,,,,0.01858782585469516,,,0.0005129343951358716,0.2212071481587977,0.016029103280278127,,,0.186824610575438,0.009092729177661725,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06493972179287, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.0536854723657, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 78627},10.458116490918238,,0.4026350379986317,,,0.42872486295616347,,0.1513717334693336,,0.21080698756289715,,,,0.14809398971580645,,,0.0006426164518996508,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.222348316427514,0.01997199445024314,0.013638890463708288,,,,4.454949959064104,,allegro_additive_loss_study/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_equal,5.0,2.0,2.0,float32,42.0,32.06493972179287,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_train.xyz,data/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_val.xyz,data/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_test.xyz,19ad80fc,train:data/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_train.xyz|val:data/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_val.xyz|test:data/base_force_auto_huber_angle_focal_stress_shear_rare_sampling_softadapton_nobadid_b1_test.xyz,per_atom_energy_mse(coeff=1)|forces_auto_stratified_huber(coeff=1)|stress_mse(coeff=1)|forces_focal_focal_mse(coeff=1)|forces_angle_forces_angle(coeff=1)|stress_shear_stress_shear_mae(coeff=1),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,155.0,155.0
33,allegro_additive_loss_study,stress_shear_rare_sampling,37024.519351962,43983.0,1751233145.1753683,{'runtime': 37025},150.0,,0.011627906976744186,0.5813953488372093,1e-06,0.2960640037645203,0.9947194296007624,0.05537006812664165,0.5676378896807024,0.004049252567149121,0.010899875132795209,0.5244190648047533,,0.5843107605936484,0.01555354300041058,0.01810699988134521,,0.0009917026755375008,3.516630596045149e-05,0.0025101310325704933,217650.0,0.30198901029628433,3.02530655392681,0.05773018919863959,1.1940781371941571,0.004114029575867271,0.010388577825193238,1.4099244229820531,0.6950793135451288,7.651821482816936,0.7053670277606997,2.7887403673091393,0.01198388693288293,0.0917811541466242,3.510781001424233,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/stress_shear_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/stress_shear_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/stress_shear_rare_sampling_val.xyz"", ""data/stress_shear_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/stress_shear_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""stress_shear_rare_sampling"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/stress_shear_rare_sampling""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,0.11627906976744186,0.01644143893163194,0.017455023935917458,,,,,0.29069767441860467,,0.001231987594607653,,0.0015428404587331094,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.30198901029628433,,,,,,,,,0.0025101310325704933,,0.05537006812664165,,217650.0,0.2960640037645203,,,0.11627906976744186,3.516630596045149e-05,,,,0.05773018919863959,,1.4099244229820531,,1.1940781371941571,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}",150.0,,,,37024.519351962,,,,,3.510781001424233,,,0.0917811541466242,,,1e-06,,,0.001231987594607653,,,,1751233145.1753683,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [4228, 11496, 25592, 21486, 21487, 21491, 21492, 21494, 13301, 10357, 13312, 10366, 13319, 13329, 23150, 13337, 24537, 13346, 13348, 13355, 13356, 13357, 24638, 13365, 13366, 24780, 13373, 13375, 25042, 13382, 13391, 13393, 26367, 13401, 26368, 26382, 9653, 13429, 13436, 11556, 13447, 13448, 9930, 13454, 13455, 21629, 77, 21632, 21634, 21590, 21641, 4351, 9023, 9043, 12775, 7790, 21112, 21168, 21176, 21279, 23250, 21280, 21495, 21496, 21497, 21501, 4498, 21514, 4499, 7808, 23258, 21527, 21528, 21529, 4505, 21540, 21541, 21543, 9118, 23262, 21547, 22670, 22671, 21552, 7819, 21557, 21558, 21562, 21565, 21566, 21568, 21570, 21571, 21572, 24213, 7827, 22674, 21581, 21586, 328, 21588, 21591, 21592, 7833, 21598, 9139, 9140, 21608, 23279, 21971, 21975, 21976, 23283, 9147, 21982, 21986, 21980, 21989, 24227, 21993, 9153, 21997, 23288, 22006, 9156, 22010, 7854, 22014, 23290, 23291, 22015, 22025, 7858, 23293, 22030, 9163, 22392, 22393, 22395, 4567, 25763, 22410, 22417, 9168, 22418, 22419, 22422, 22425, 22437, 21907, 22443, 23304, 22445, 7876, 22446, 22448, 23307, 4592, 23308, 7880, 6084, 24250, 6088, 24252, 24253, 22462, 22466, 24254, 22473, 9190, 22474, 22486, 22498, 22499, 4613, 24258, 6102, 9195, 22507, 22511, 23318, 22514, 22523, 22530, 7899, 22546, 21954, 21956, 21957, 7737, 4684, 4685, 10513, 4626, 4649, 25819, 13566, 14136, 25821, 14168, 14177, 14192, 14200, 22046, 7856, 22049, 22050, 11826, 25828, 22054, 22055, 7884, 22056, 22058, 22059, 22060, 21962, 22061, 25834, 412, 14577, 25845, 14608, 11854, 25850, 11863, 10047, 11866, 20508, 2444, 6262, 6264, 6270, 16459, 10598, 22176, 22177, 22178, 22179, 22180, 22181, 10617, 22184, 22186, 22188, 22197, 24390, 24391, 24392, 9387, 9395, 9406, 19495, 9419, 24422, 9429, 12005, 1273, 6474, 6477, 6478, 6481, 6482, 6484, 6487, 6489, 6490, 6491, 6493, 16579, 16595, 10725, 16611, 16620, 16627, 16635, 16651, 16660, 10729, 6496, 23510, 6502, 6503, 18219, 22370, 16675, 22372, 16691, 6950, 6507, 6952, 22373, 22374, 22375, 6956, 8173, 6958, 6960, 6961, 6964, 6965, 6966, 6967, 6968, 6973, 6974, 6975, 6976, 6977, 6979, 25996, 6982, 6983, 6984, 6987, 6989, 6990, 6991, 12069, 6995, 6997, 7000, 7002, 12076, 7004, 7010, 12082, 7013, 7023, 7025, 7027, 7028, 7029, 26019, 7031, 9525, 7035, 7037, 7040, 7043, 7046, 7047, 7048, 7049, 7050, 12105, 7056, 7063, 7065, 7068, 7071, 7073, 7075, 7079, 7080, 7084, 7088, 7091, 7092, 7095, 7101, 7102, 7103, 7105, 7106, 7108, 7109, 7110, 7115, 7116, 7117, 7118, 7119, 7121, 7122, 7123, 6670, 7127, 7129, 7132, 7133, 7134, 7137, 7140, 7142, 7144, 7150, 7151, 7155, 7156, 639, 7159, 7161, 7165, 7166, 7167, 7168, 7170, 7171, 7172, 26085, 7176, 7177, 7178, 7179, 7180, 22628, 7182, 7183, 7184, 7185, 22631, 22632, 22633, 22634, 7190, 7191, 7192, 7193, 22635, 7195, 22636, 22637, 22638, 22640, 22641, 22642, 22643, 8329, 22645, 7205, 22647, 7207, 7208, 7209, 7210, 22652, 23639, 22656, 22657, 23640, 7216, 22658, 7218, 22660, 23643, 7220, 22661, 22662, 7224, 22663, 22665, 7227, 7228, 22667, 7230, 22669, 7232, 8348, 22672, 7235, 7236, 22675, 22679, 22680, 22682, 22683, 22684, 22686, 22687, 22688, 22691, 7239, 7240, 7242, 7243, 7246, 7247, 7248, 7249, 7252, 7254, 7255, 7256, 2405, 2413, 7261, 7263, 2436, 7266, 7267, 17121, 7269, 7270, 7271, 7272, 23666, 7273, 7274, 7275, 7276, 7277, 7279, 7280, 2476, 7282, 7283, 8380, 2484, 7289, 7290, 7292, 7293, 7295, 23679, 7303, 7306, 7307, 8397, 23684, 7311, 7312, 7313, 7318, 7319, 7321, 7322, 7324, 7330, 7334, 7335, 7340, 7341, 7345, 7348, 7349, 7350, 7353, 7356, 8427, 7357, 7358, 7360, 7361, 7362, 7365, 11043, 7366, 7368, 7369, 7371, 7372, 23712, 7373, 7375, 8439, 7377, 8440, 7379, 7381, 23716, 8443, 23717, 7382, 8445, 7386, 7388, 7391, 8449, 7392, 23722, 7396, 7397, 7398, 7399, 7400, 7401, 23725, 23726, 7405, 7406, 18513, 7410, 7412, 23730, 7413, 7414, 23733, 7420, 7421, 7422, 7423, 7425, 23736, 7427, 7428, 23738, 7429, 7431, 23739, 8475, 7433, 7435, 7438, 8480, 17231, 7442, 7443, 7444, 7447, 23746, 7448, 7451, 7453, 7454, 7456, 7457, 7459, 7460, 7462, 7463, 7467, 7468, 7471, 23757, 7472, 7473, 7475, 23759, 7476, 7477, 7479, 7480, 23761, 23763, 7486, 7487, 7488, 8511, 7491, 7492, 7495, 8516, 11088, 7502, 7503, 7505, 7509, 11096, 7512, 7513, 8527, 7515, 7516, 7517, 7518, 5185, 7520, 5186, 7522, 7523, 7524, 5189, 7526, 7527, 5191, 7529, 5193, 7531, 7532, 8539, 25315, 7534, 5199, 15313, 7538, 5202, 8544, 7541, 7543, 7545, 7546, 7548, 7550, 7551, 15939, 11126, 7557, 7559, 7560, 7561, 7562, 7563, 7564, 7566, 7567, 7571, 7574, 7581, 7584, 7582, 7588, 7589, 7591, 11150, 7596, 7598, 25345, 11154, 7602, 11161, 11164, 23055, 11171, 25360, 23075, 8610, 25367, 23838, 8613, 11185, 23839, 23085, 23086, 23087, 23088, 23841, 23090, 25371, 23843, 8620, 23093, 23095, 11192, 8623, 25374, 23098, 23094, 23096, 23097, 8635, 11208, 23858, 11213, 3826, 25390, 23861, 11221, 11227, 8656, 11229, 11230, 23872, 11236, 8665, 11237, 25406, 3865, 23877, 3867, 13443, 13445, 8674, 18626, 11250, 8681, 25417, 18666, 18682, 8688, 18690, 18698, 3884, 3885, 3886, 26088, 3888, 3889, 3890, 3891, 3894, 18730, 18738, 18749, 3904, 26090, 5460, 5461, 912, 5462, 15537, 15545, 15561, 8716, 15569, 15585, 26092, 15593, 5463, 5464, 8721, 5468, 5471, 1670, 3936, 5473, 5474, 23920, 5476, 5477, 15617, 5480, 5481, 5482, 3944, 5486, 5487, 5489, 21193, 5490, 5491, 5494, 5492, 3955, 5500, 5501, 5502, 23933, 5505, 15625, 5510, 5511, 5512, 8751, 5513, 5515, 5516, 3981, 23940, 8758, 8762, 23946, 8765, 12203, 23953, 23954, 26100, 23957, 23958, 4019, 1707, 23959, 8784, 26338, 23963, 12848, 12849, 5187, 26340, 12858, 8793, 20389, 12864, 12866, 26342, 8796, 4040, 8797, 8798, 12874, 12875, 26308, 5190, 26344, 12882, 26345, 12896, 12897, 23975, 12904, 26104, 8810, 5194, 23981, 8819, 17579, 23992, 8830, 4095, 12217, 24001, 4141, 4147, 21408, 21409, 21411, 4160, 21413, 12225, 4164, 5614, 15088, 15112, 15121, 25566, 15137, 15153, 15177, 15184, 4194, 4198], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/stress_shear_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/stress_shear_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/stress_shear_rare_sampling_val.xyz"", ""data/stress_shear_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/stress_shear_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""stress_shear_rare_sampling"", ""project"": ""allegro_additive_loss_study"", ""save_dir"": ""results/stress_shear_rare_sampling""}, ""max_epochs"": 150, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.AutoStratifiedHuberLoss"", ""boundaries"": [0.01020328514277935, 0.37318193912506104, 2.7150564193725586], ""deltas"": [0.0010203285142779352, 0.0010203285142779352, 0.037318193912506105, 0.27150564193725585]}, ""name"": ""forces_auto_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.StressShearMAE""}, ""name"": ""stress_shear_stress_shear_mae""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_additive_loss_study,0.9947194296007624,,,,,0.5843107605936484,0.5813953488372093,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,43983.0,0.01198388693288293,,7.651821482816936,,,0.01555354300041058,0.6950793135451288,,0.0009917026755375008,0.004049252567149121,0.01644143893163194,,,0.011627906976744186,0.004114029575867271,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00510198382953, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.466677732484635, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 37025},0.5676378896807024,,0.010899875132795209,,,3.02530655392681,,0.29069767441860467,,,,0.7053670277606997,2.7887403673091393,,,,0.0015428404587331094,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.01810699988134521,0.010388577825193238,0.017455023935917458,,,,0.5244190648047533,,allegro_additive_loss_study/stress_shear_rare_sampling,5.0,2.0,2.0,float32,42.0,32.00510198382953,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/stress_shear_rare_sampling_train.xyz,data/stress_shear_rare_sampling_val.xyz|data/stress_shear_rare_sampling_val_b.xyz,data/stress_shear_rare_sampling_test.xyz,35418922,train:data/stress_shear_rare_sampling_train.xyz|val:data/stress_shear_rare_sampling_val.xyz|data/stress_shear_rare_sampling_val_b.xyz|test:data/stress_shear_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|forces_auto_stratified_huber(coeff=10)|stress_mse(coeff=50)|stress_shear_stress_shear_mae(coeff=25),val1_epoch/forces_mae,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,150.0,150.0
34,Allegro_MPTraj_Finetune,first_finetune_test,77323.057683626,959.0,1750266815.1280394,{'runtime': 77323},208.0,,,,,0.6409520948916523,1.790698829387355,8.037779299441034,8.0767796772017,0.023293065203829216,0.05838612370033874,32.0134555024316,,,,0.00014667261871886925,,,,0.00013575390504911975,33299.0,0.10288643653836924,0.21678370002516445,0.013498848419581076,0.01857941746529935,0.0010772876099855307,0.003401085110273386,0.10218279244171244,,,,,,,,0.995,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 1, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""accumulate_grad_batches"": 8, ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-17/19-42-53"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""first_finetune_test"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-17/19-42-53""}, ""max_epochs"": 2000, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 0.01}, ""name"": ""peratom_E_Huber""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.metrics.StratifiedHuberForceLoss"", ""delta_dict"": {""0"": 0.01, ""100"": 0.007, ""200"": 0.004, ""300"": 0.001}}, ""name"": ""force_strat_E_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 0.1}, ""name"": ""stress_E_Huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_16_06_25.nequip.zip""}, ""optimizer"": {""_target_"": ""torch.optim.AdamW"", ""amsgrad"": false, ""lr"": 0.001, ""weight_decay"": 1e-08}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_mae"": 10, ""forces_rmse"": 1, ""per_atom_energy_mae"": 10, ""per_atom_energy_rmse"": 1, ""stress_mae"": 5, ""stress_rmse"": 1, ""total_energy_mae"": 1}}, ""train_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_mae"": 10, ""forces_rmse"": 1, ""per_atom_energy_mae"": 10, ""per_atom_energy_rmse"": 1, ""stress_mae"": 5, ""stress_rmse"": 1, ""total_energy_mae"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_mae"": 10, ""forces_rmse"": 1, ""per_atom_energy_mae"": 10, ""per_atom_energy_rmse"": 1, ""stress_mae"": 5, ""stress_rmse"": 1, ""total_energy_mae"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 0.01}, ""name"": ""peratom_E_Huber""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.metrics.StratifiedHuberForceLoss"", ""delta_dict"": {""0"": 0.01, ""100"": 0.007, ""200"": 0.004, ""300"": 0.001}}, ""name"": ""force_strat_E_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 0.1}, ""name"": ""stress_E_Huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_16_06_25.nequip.zip""}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.AdamW"", ""amsgrad"": false, ""lr"": 0.001, ""weight_decay"": 1e-08}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_mae"": 10, ""forces_rmse"": 1, ""per_atom_energy_mae"": 10, ""per_atom_energy_rmse"": 1, ""stress_mae"": 5, ""stress_rmse"": 1, ""total_energy_mae"": 1}}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_mae"": 10, ""forces_rmse"": 1, ""per_atom_energy_mae"": 10, ""per_atom_energy_rmse"": 1, ""stress_mae"": 5, ""stress_rmse"": 1, ""total_energy_mae"": 1}}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_mae"": 10, ""forces_rmse"": 1, ""per_atom_energy_mae"": 10, ""per_atom_energy_rmse"": 1, ""stress_mae"": 5, ""stress_rmse"": 1, ""total_energy_mae"": 1}}",,,,,,,,,,,,,,,,,,,,0.16393442622950818,0.01639344262295082,0.819672131147541,0.001,831.5605656708808,910.9068284338877,0.0008663043973241203,0.00015794507506895858,2.5208138708172375e-06,0.0007942136242771097,0.0001686629726243226,3.403779852017726e-06,0.09145681137168166,0.18692517933207825,0.020277881465016655,0.025958947370538676,0.001106761059067005,0.0022453582568198105,2.083639671324474,2.886310517020299,0.11798792723952514,0.1258679482882761,0.24086991352702955,0.02647285773774355,0.03307477728999288,0.0025095842179817945,0.0046670030874287035,1.4882431595853731,1.8758470047172071,0.1138900287875838,1.5552974905794923,2.26890910000126,,,,,,,,,,,,,,,,,,,,,0.10288643653836924,0.16393442622950818,2.083639671324474,910.9068284338877,,0.025958947370538676,,,,0.00013575390504911975,2.5208138708172375e-06,8.037779299441034,,33299.0,0.6409520948916523,0.0025095842179817945,,,,,0.02647285773774355,,0.013498848419581076,0.1138900287875838,0.10218279244171244,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_mae"": 10, ""forces_rmse"": 1, ""per_atom_energy_mae"": 10, ""per_atom_energy_rmse"": 1, ""stress_mae"": 5, ""stress_rmse"": 1, ""total_energy_mae"": 1}}",0.01857941746529935,,0.001,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 0.01}, ""name"": ""peratom_E_Huber""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.metrics.StratifiedHuberForceLoss"", ""delta_dict"": {""0"": 0.01, ""100"": 0.007, ""200"": 0.004, ""300"": 0.001}}, ""name"": ""force_strat_E_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 0.1}, ""name"": ""stress_E_Huber""}]}",208.0,,,,77323.057683626,,0.020277881465016655,0.1258679482882761,831.5605656708808,,,,,1.4882431595853731,1.8758470047172071,,1.5552974905794923,0.0008663043973241203,,2.886310517020299,0.0007942136242771097,,1750266815.1280394,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 1, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""accumulate_grad_batches"": 8, ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-17/19-42-53"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""first_finetune_test"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-17/19-42-53""}, ""max_epochs"": 2000, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 0.01}, ""name"": ""peratom_E_Huber""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.metrics.StratifiedHuberForceLoss"", ""delta_dict"": {""0"": 0.01, ""100"": 0.007, ""200"": 0.004, ""300"": 0.001}}, ""name"": ""force_strat_E_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 0.1}, ""name"": ""stress_E_Huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_16_06_25.nequip.zip""}, ""optimizer"": {""_target_"": ""torch.optim.AdamW"", ""amsgrad"": false, ""lr"": 0.001, ""weight_decay"": 1e-08}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_mae"": 10, ""forces_rmse"": 1, ""per_atom_energy_mae"": 10, ""per_atom_energy_rmse"": 1, ""stress_mae"": 5, ""stress_rmse"": 1, ""total_energy_mae"": 1}}, ""train_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_mae"": 10, ""forces_rmse"": 1, ""per_atom_energy_mae"": 10, ""per_atom_energy_rmse"": 1, ""stress_mae"": 5, ""stress_rmse"": 1, ""total_energy_mae"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_mae"": 10, ""forces_rmse"": 1, ""per_atom_energy_mae"": 10, ""per_atom_energy_rmse"": 1, ""stress_mae"": 5, ""stress_rmse"": 1, ""total_energy_mae"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}",Allegro_MPTraj_Finetune,1.790698829387355,0.11798792723952514,,,0.03307477728999288,,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",0.0001686629726243226,0.18692517933207825,,0.0046670030874287035,959.0,,,,,,,,0.01639344262295082,,0.023293065203829216,,,,,0.0010772876099855307,"{""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_16_06_25.nequip.zip""}",{'runtime': 77323},8.0767796772017,0.0022453582568198105,0.05838612370033874,,0.09145681137168166,0.21678370002516445,0.819672131147541,,3.403779852017726e-06,,0.24086991352702955,,,,,2.26890910000126,,0.00015794507506895858,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.00014667261871886925,0.003401085110273386,,,0.001106761059067005,,32.0134555024316,,Allegro_MPTraj_Finetune/first_finetune_test,,,,,,,,,,,,,,,,,,,,,,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,peratom_E_Huber(coeff=1)|force_strat_E_huber(coeff=10)|stress_E_Huber(coeff=50),val0_epoch/weighted_sum,,,ModelCheckpoint|EarlyStopping|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,208.0,208.0
35,Allegro_MPTraj_Finetune,fixed_loss_finetune_test,16731.979407446,727.0,1750285017.72555,{'runtime': 16731},45.0,,0.009009009009009007,0.9009009009009008,4.665599999999999e-05,0.640951804770585,1.7906978228293366,8.037779266366847,8.076779660070315,0.023293032136445124,0.05838577252379123,3.3086210851411475,,0.0003212295387879448,4.416209267974379e-06,0.00045432575674382776,,0.0003844938789703303,1.6049208730942586e-06,0.00024606616843312706,58788.0,0.11770642055074182,0.21454625709381112,0.013775793844873414,0.017157232352686642,0.0012300339311091487,0.0028424040497868285,0.07818196449876152,,,,,,,,0.995,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-18/17-36-06"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""fixed_loss_finetune_test"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-18/17-36-06""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_16_06_25.nequip.zip""}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_16_06_25.nequip.zip""}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,831.5605666695774,910.9068308439864,,,,,,,,,,,,,,,,,,,,,,,,,1.5510647982959076,2.052465473998211,0.09009009009009009,0.0049667308532979505,0.0026768358729797347,,,,,,,,,,,,,,,,,,0.11770642055074182,,,910.9068308439864,0.0026768358729797347,,,,,0.00024606616843312706,,8.037779266366847,,58788.0,0.640951804770585,,,,1.6049208730942586e-06,,,,0.013775793844873414,,0.07818196449876152,,0.017157232352686642,0.0049667308532979505,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",45.0,,,,16731.979407446,,,,831.5605666695774,,,,,,,4.665599999999999e-05,1.5510647982959076,,,,,,1750285017.72555,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-18/17-36-06"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""fixed_loss_finetune_test"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-18/17-36-06""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_16_06_25.nequip.zip""}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}",Allegro_MPTraj_Finetune,1.7906978228293366,,,,,0.0003212295387879448,0.9009009009009008,,0.09009009009009009,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,727.0,,,,,,4.416209267974379e-06,,,0.0003844938789703303,0.023293032136445124,,,,0.009009009009009007,0.0012300339311091487,"{""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_16_06_25.nequip.zip""}",{'runtime': 16731},8.076779660070315,,0.05838577252379123,,,0.21454625709381112,,,,,,,,,,2.052465473998211,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.00045432575674382776,0.0028424040497868285,,,,,3.3086210851411475,,Allegro_MPTraj_Finetune/fixed_loss_finetune_test,,,,,,,,,,,,,,,,,,,,,,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/weighted_sum,,,ModelCheckpoint|EarlyStopping|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,45.0,45.0
36,Allegro_MPTraj_Finetune,fixed_loss_finetune_test_default_lrsched,66022.536588554,2870.0,1750352394.1699803,{'runtime': 66022},181.0,,0.009009009009009007,0.9009009009009008,1.953125e-06,0.6409517507164614,1.790698567760369,8.037779151467848,8.076779548000784,0.02329304380767555,0.05838597325963674,3.3086213630069294,,0.00014267106233654695,1.3858588247735377e-06,0.0001515357872590234,,0.00013863891711541205,8.691847544392886e-07,8.501102481824897e-05,232499.0,0.0980178123319889,0.19664869282429095,0.00927480164931289,0.012376717384693162,0.000964241904509535,0.0023571741115364043,0.07046086144017351,,,,,,,,0.995,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-18/22-37-32"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""fixed_loss_finetune_test_default_lrsched"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-18/22-37-32""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_16_06_25.nequip.zip""}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_16_06_25.nequip.zip""}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,831.5605607964377,910.906825241444,,,,,,,,,,,,,,,,,,,,,,,,,1.085377755985632,1.5141956163915815,0.09009009009009009,0.0016539215440937696,0.0009210666362266295,,,,,,,,,,,,,,,,,,0.0980178123319889,,,910.906825241444,0.0009210666362266295,,,,,8.501102481824897e-05,,8.037779151467848,,232499.0,0.6409517507164614,,,,8.691847544392886e-07,,,,0.00927480164931289,,0.07046086144017351,,0.012376717384693162,0.0016539215440937696,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",181.0,,,,66022.536588554,,,,831.5605607964377,,,,,,,1.953125e-06,1.085377755985632,,,,,,1750352394.1699803,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-18/22-37-32"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""fixed_loss_finetune_test_default_lrsched"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-18/22-37-32""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_16_06_25.nequip.zip""}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}",Allegro_MPTraj_Finetune,1.790698567760369,,,,,0.00014267106233654695,0.9009009009009008,,0.09009009009009009,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,2870.0,,,,,,1.3858588247735377e-06,,,0.00013863891711541205,0.02329304380767555,,,,0.009009009009009007,0.000964241904509535,"{""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_16_06_25.nequip.zip""}",{'runtime': 66022},8.076779548000784,,0.05838597325963674,,,0.19664869282429095,,,,,,,,,,1.5141956163915815,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.0001515357872590234,0.0023571741115364043,,,,,3.3086213630069294,,Allegro_MPTraj_Finetune/fixed_loss_finetune_test_default_lrsched,,,,,,,,,,,,,,,,,,,,,,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/weighted_sum,,,ModelCheckpoint|EarlyStopping|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,181.0,181.0
37,Allegro_MPTraj_Finetune,fixed_loss_scalesshift_finetune_test,24306.360275459,1055.0,1750402029.9795637,{'runtime': 24306},66.0,,0.009009009009009007,0.9009009009009008,1.0077695999999996e-05,0.1894028832877434,0.5781300096471569,0.034484838165237515,0.05467761783236863,0.00307998095691919,0.01230929729815458,0.21503897492589336,,0.000273298767646565,3.60030849077227e-06,0.0004109989447945591,,0.00020488939657183324,1.733078499241127e-06,0.00040712368844462337,85499.0,0.1141412407441434,0.21043716639459983,0.013002263065461742,0.01642870406132108,0.0011703293511861278,0.0027186262446556855,0.07652816556685886,,,,,,,,0.995,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-20/00-00-03"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""fixed_loss_scalesshift_finetune_test"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-20/00-00-03""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromCheckpoint"", ""checkpoint_path"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-19/17-24-12/last.ckpt"", ""compile_mode"": ""compile""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales_trainable"": true, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""shifts_trainable"": false}]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromCheckpoint"", ""checkpoint_path"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-19/17-24-12/last.ckpt"", ""compile_mode"": ""compile""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales_trainable"": true, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""shifts_trainable"": false}]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,2.8669657268028397,4.275862683027109,,,,,,,,,,,,,,,,,,,,,,,,,1.4774379731022285,1.9730264620788809,0.09009009009009009,0.0044987553255472264,0.0044812532170857245,,,,,,,,,,,,,,,,,,0.1141412407441434,,,4.275862683027109,0.0044812532170857245,,,,,0.00040712368844462337,,0.034484838165237515,,85499.0,0.1894028832877434,,,,1.733078499241127e-06,,,,0.013002263065461742,,0.07652816556685886,,0.01642870406132108,0.0044987553255472264,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",66.0,,,,24306.360275459,,,,2.8669657268028397,,,,,,,1.0077695999999996e-05,1.4774379731022285,,,,,,1750402029.9795637,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-20/00-00-03"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""fixed_loss_scalesshift_finetune_test"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-20/00-00-03""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromCheckpoint"", ""checkpoint_path"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-19/17-24-12/last.ckpt"", ""compile_mode"": ""compile""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales_trainable"": true, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""shifts_trainable"": false}]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}",Allegro_MPTraj_Finetune,0.5781300096471569,,,,,0.000273298767646565,0.9009009009009008,,0.09009009009009009,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,1055.0,,,,,,3.60030849077227e-06,,,0.00020488939657183324,0.00307998095691919,,,,0.009009009009009007,0.0011703293511861278,"{""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromCheckpoint"", ""checkpoint_path"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-19/17-24-12/last.ckpt"", ""compile_mode"": ""compile""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales_trainable"": true, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""shifts_trainable"": false}]}",{'runtime': 24306},0.05467761783236863,,0.01230929729815458,,,0.21043716639459983,,,,,,,,,,1.9730264620788809,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.0004109989447945591,0.0027186262446556855,,,,,0.21503897492589336,,Allegro_MPTraj_Finetune/fixed_loss_scalesshift_finetune_test,,,,,,,,,,,,,,,,,,,,,,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/weighted_sum,,,ModelCheckpoint|EarlyStopping|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,66.0,66.0
38,Allegro_MPTraj_Finetune,fixed_loss_scalesshift_finetune_test_b1,196735.588088748,10823.0,1750599385.6417615,{'runtime': 196736},200.0,,0.009009009009009007,0.9009009009009008,1e-06,0.085030864209284,0.19726045915035867,0.00860245123574359,0.011334652889710852,0.000907746666038026,0.002591654801832573,0.07039558894730069,,9.922328934113593e-05,5.986656917569949e-07,3.283257474731971e-05,,0.00011437683066406353,5.199932533226968e-07,1.674500763344641e-05,1022000.0,0.0872740248180866,0.18230601763575272,0.00868560394281146,0.011474716446068648,0.000885814729026654,0.002052825827082193,0.06527785330296786,,,,,,,,0.995,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-20/06-53-07"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""fixed_loss_scalesshift_finetune_test_b1"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-20/06-53-07""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromCheckpoint"", ""checkpoint_path"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-19/17-24-12/last.ckpt"", ""compile_mode"": ""eager""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales"": {""Cr"": 1.9156857576313624, ""Ti"": 1.6983142745377566, ""V"": 1.1195999342813023, ""W"": 4.354796520573479, ""Zr"": 1.677008607152608}, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromCheckpoint"", ""checkpoint_path"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-19/17-24-12/last.ckpt"", ""compile_mode"": ""eager""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales"": {""Cr"": 1.9156857576313624, ""Ti"": 1.6983142745377566, ""V"": 1.1195999342813023, ""W"": 4.354796520573479, ""Zr"": 1.677008607152608}, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,0.9778231942679008,1.353221587306234,,,,,,,,,,,,,,,,,,,,,,,,,0.9974791351208552,1.3883641303514769,0.09009009009009009,0.0003485325938435652,0.00016923196913162182,,,,,,,,,,,,,,,,,,0.0872740248180866,,,1.353221587306234,0.00016923196913162182,,,,,1.674500763344641e-05,,0.00860245123574359,,1022000.0,0.085030864209284,,,,5.199932533226968e-07,,,,0.00868560394281146,,0.06527785330296786,,0.011474716446068648,0.0003485325938435652,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",200.0,,,,196735.588088748,,,,0.9778231942679008,,,,,,,1e-06,0.9974791351208552,,,,,,1750599385.6417615,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-20/06-53-07"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""fixed_loss_scalesshift_finetune_test_b1"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-20/06-53-07""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromCheckpoint"", ""checkpoint_path"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-19/17-24-12/last.ckpt"", ""compile_mode"": ""eager""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales"": {""Cr"": 1.9156857576313624, ""Ti"": 1.6983142745377566, ""V"": 1.1195999342813023, ""W"": 4.354796520573479, ""Zr"": 1.677008607152608}, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}",Allegro_MPTraj_Finetune,0.19726045915035867,,,,,9.922328934113593e-05,0.9009009009009008,,0.09009009009009009,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,10823.0,,,,,,5.986656917569949e-07,,,0.00011437683066406353,0.000907746666038026,,,,0.009009009009009007,0.000885814729026654,"{""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromCheckpoint"", ""checkpoint_path"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-19/17-24-12/last.ckpt"", ""compile_mode"": ""eager""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales"": {""Cr"": 1.9156857576313624, ""Ti"": 1.6983142745377566, ""V"": 1.1195999342813023, ""W"": 4.354796520573479, ""Zr"": 1.677008607152608}, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}",{'runtime': 196736},0.011334652889710852,,0.002591654801832573,,,0.18230601763575272,,,,,,,,,,1.3883641303514769,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",3.283257474731971e-05,0.002052825827082193,,,,,0.07039558894730069,,Allegro_MPTraj_Finetune/fixed_loss_scalesshift_finetune_test_b1,,,,,,,,,,,,,,,,,,,,,,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/weighted_sum,,,ModelCheckpoint|EarlyStopping|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,200.0,200.0
39,Allegro_MPTraj_Finetune,from_scratch_loss_scalesshift_b1,201869.278353891,10823.0,1750822169.7472217,{'runtime': 201869},200.0,,0.009009009009009007,0.9009009009009008,1e-06,0.08381763616680657,0.18701181873883985,0.007850377652723738,0.01067826599649018,0.0008286965279579641,0.001950049623171599,0.06654671145283386,,9.021926626675368e-05,5.590731375181456e-07,1.9840950179578142e-05,,0.00010318777512331886,2.7219650765891725e-07,1.0151858233347437e-05,1022000.0,0.08593281029154909,0.18579044278901533,0.008044244585947484,0.012345530591959532,0.0008347726618633673,0.0020637323709944855,0.06673323525065644,,,,,,,,0.995,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-22/19-20-39"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""from_scratch_loss_scalesshift_b1"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-22/19-20-39""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""allegro.model.allegro_models.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 3, ""allegro_mlp_hidden_layers_width"": 1024, ""avg_num_neighbors"": 32.045134666432375, ""compile_mode"": ""compile"", ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 5, ""num_scalar_features"": 256, ""num_tensor_features"": 96, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839283, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 12, ""polynomial_cutoff_p"": 8}, ""radial_chemical_embed_dim"": 512, ""readout_mlp_hidden_layers_depth"": 1, ""readout_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_hidden_layers_width"": 512, ""seed"": 0, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales"": {""Cr"": 1.9156857576313624, ""Ti"": 1.6983142745377566, ""V"": 1.1195999342813023, ""W"": 4.354796520573479, ""Zr"": 1.677008607152608}, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""allegro.model.allegro_models.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 3, ""allegro_mlp_hidden_layers_width"": 1024, ""avg_num_neighbors"": 32.045134666432375, ""compile_mode"": ""compile"", ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 5, ""num_scalar_features"": 256, ""num_tensor_features"": 96, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839283, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 12, ""polynomial_cutoff_p"": 8}, ""radial_chemical_embed_dim"": 512, ""readout_mlp_hidden_layers_depth"": 1, ""readout_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_hidden_layers_width"": 512, ""seed"": 0, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales"": {""Cr"": 1.9156857576313624, ""Ti"": 1.6983142745377566, ""V"": 1.1195999342813023, ""W"": 4.354796520573479, ""Zr"": 1.677008607152608}, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,0.8914078493190261,1.271454029171529,,,,,,,,,,,,,,,,,,,,,,,,,0.919522972185545,1.5190334175709248,0.09009009009009009,0.00020562188899146057,9.964488380123548e-05,,,,,,,,,,,,,,,,,,0.08593281029154909,,,1.271454029171529,9.964488380123548e-05,,,,,1.0151858233347437e-05,,0.007850377652723738,,1022000.0,0.08381763616680657,,,,2.7219650765891725e-07,,,,0.008044244585947484,,0.06673323525065644,,0.012345530591959532,0.00020562188899146057,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",200.0,,,,201869.278353891,,,,0.8914078493190261,,,,,,,1e-06,0.919522972185545,,,,,,1750822169.7472217,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-22/19-20-39"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""from_scratch_loss_scalesshift_b1"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/MPTrj_Finetune_Allegro/outputs/2025-06-22/19-20-39""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""allegro.model.allegro_models.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 3, ""allegro_mlp_hidden_layers_width"": 1024, ""avg_num_neighbors"": 32.045134666432375, ""compile_mode"": ""compile"", ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 5, ""num_scalar_features"": 256, ""num_tensor_features"": 96, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839283, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 12, ""polynomial_cutoff_p"": 8}, ""radial_chemical_embed_dim"": 512, ""readout_mlp_hidden_layers_depth"": 1, ""readout_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_hidden_layers_width"": 512, ""seed"": 0, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales"": {""Cr"": 1.9156857576313624, ""Ti"": 1.6983142745377566, ""V"": 1.1195999342813023, ""W"": 4.354796520573479, ""Zr"": 1.677008607152608}, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",Allegro_MPTraj_Finetune,0.18701181873883985,,,,,9.021926626675368e-05,0.9009009009009008,,0.09009009009009009,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,10823.0,,,,,,5.590731375181456e-07,,,0.00010318777512331886,0.0008286965279579641,,,,0.009009009009009007,0.0008347726618633673,"{""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""allegro.model.allegro_models.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 3, ""allegro_mlp_hidden_layers_width"": 1024, ""avg_num_neighbors"": 32.045134666432375, ""compile_mode"": ""compile"", ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 5, ""num_scalar_features"": 256, ""num_tensor_features"": 96, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839283, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 12, ""polynomial_cutoff_p"": 8}, ""radial_chemical_embed_dim"": 512, ""readout_mlp_hidden_layers_depth"": 1, ""readout_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_hidden_layers_width"": 512, ""seed"": 0, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales"": {""Cr"": 1.9156857576313624, ""Ti"": 1.6983142745377566, ""V"": 1.1195999342813023, ""W"": 4.354796520573479, ""Zr"": 1.677008607152608}, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}",{'runtime': 201869},0.01067826599649018,,0.001950049623171599,,,0.18579044278901533,,,,,,,,,,1.5190334175709248,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",1.9840950179578142e-05,0.0020637323709944855,,,,,0.06654671145283386,,Allegro_MPTraj_Finetune/from_scratch_loss_scalesshift_b1,,,,,,,,,,,,,,,,,,,,,,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/weighted_sum,,,ModelCheckpoint|EarlyStopping|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,200.0,200.0
40,Allegro_MPTraj_Finetune,fixed_loss_scalesshift_finetune_test_b1_modify_compile,2905.910401281,152.0,1750619988.4356196,{'runtime': 2905},2.0,,0.009009009009009007,0.9009009009009008,0.001,0.6409516053094899,1.7907007710481873,8.03777949842246,8.076779719250506,0.02329277149251696,0.05838527798988794,3.3086219227628604,,18082.94383666919,39207.96728059732,35485.88882021761,,0.019944825228189005,0.0007322827084454693,0.008777886504309954,14399.0,0.38066020142998314,73.77693153798892,0.03480365897629293,0.22181945959131188,0.00996092363578364,0.499223326328789,24.83265810796967,,,,,,,,0.995,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/Test_MPTrj_Finetune_Allegro/outputs/2025-06-22/18-27-00"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""fixed_loss_scalesshift_finetune_test_b1_modify_compile"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/Test_MPTrj_Finetune_Allegro/outputs/2025-06-22/18-27-00""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/Test_MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_20_06_25_modify_compile.nequip.zip""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales"": {""Cr"": 1.9156857576313624, ""Ti"": 1.6983142745377566, ""V"": 1.1195999342813023, ""W"": 4.354796520573479, ""Zr"": 1.677008607152608}, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/Test_MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_20_06_25_modify_compile.nequip.zip""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales"": {""Cr"": 1.9156857576313624, ""Ti"": 1.6983142745377566, ""V"": 1.1195999342813023, ""W"": 4.354796520573479, ""Zr"": 1.677008607152608}, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,831.5605903795231,910.9068645237608,,,,,,,,,,,,,,,,,,,,,,,,,3.0630947415411054,12.53174202632114,0.09009009009009009,5.398714775331586,0.0881172305905669,,,,,,,,,,,,,,,,,,0.38066020142998314,,,910.9068645237608,0.0881172305905669,,,,,0.008777886504309954,,8.03777949842246,,14399.0,0.6409516053094899,,,,0.0007322827084454693,,,,0.03480365897629293,,24.83265810796967,,0.22181945959131188,5.398714775331586,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",2.0,,,,2905.910401281,,,,831.5605903795231,,,,,,,0.001,3.0630947415411054,,,,,,1750619988.4356196,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/Test_MPTrj_Finetune_Allegro/outputs/2025-06-22/18-27-00"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""fixed_loss_scalesshift_finetune_test_b1_modify_compile"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/Test_MPTrj_Finetune_Allegro/outputs/2025-06-22/18-27-00""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/Test_MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_20_06_25_modify_compile.nequip.zip""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales"": {""Cr"": 1.9156857576313624, ""Ti"": 1.6983142745377566, ""V"": 1.1195999342813023, ""W"": 4.354796520573479, ""Zr"": 1.677008607152608}, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",Allegro_MPTraj_Finetune,1.7907007710481873,,,,,18082.94383666919,0.9009009009009008,,0.09009009009009009,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,152.0,,,,,,39207.96728059732,,,0.019944825228189005,0.02329277149251696,,,,0.009009009009009007,0.00996092363578364,"{""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/Test_MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_20_06_25_modify_compile.nequip.zip""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""scales"": {""Cr"": 1.9156857576313624, ""Ti"": 1.6983142745377566, ""V"": 1.1195999342813023, ""W"": 4.354796520573479, ""Zr"": 1.677008607152608}, ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}",{'runtime': 2905},8.076779719250506,,0.05838527798988794,,,73.77693153798892,,,,,,,,,,12.53174202632114,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",35485.88882021761,0.499223326328789,,,,,3.3086219227628604,,Allegro_MPTraj_Finetune/fixed_loss_scalesshift_finetune_test_b1_modify_compile,,,,,,,,,,,,,,,,,,,,,,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/weighted_sum,,,ModelCheckpoint|EarlyStopping|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,2.0,2.0
41,Allegro_MPTraj_Finetune,fixed_loss_noscales_shift_finetune_test_b1_modify_compile,201956.246469139,10823.0,1751032023.1852643,{'runtime': 201956},200.0,,0.009009009009009007,0.9009009009009008,1e-06,0.08615511598841108,0.18677646430706585,0.008128885543898817,0.01122597504307458,0.0008723849795509756,0.0026273183677387674,0.06687658590595974,,0.00010370770096151088,6.805286272596725e-07,4.4197700572908066e-05,,0.00012652977094931487,2.703446951266588e-07,2.0820918958945375e-05,1022000.0,0.08840731015747766,0.18531509411434063,0.008233671696017119,0.011336788614444551,0.0008570902738542762,0.00200668709185664,0.06621952327354727,,,,,,,,0.995,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/Test_MPTrj_Finetune_Allegro/outputs/2025-06-25/05-36-44"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""fixed_loss_noscales_shift_finetune_test_b1_modify_compile"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/Test_MPTrj_Finetune_Allegro/outputs/2025-06-25/05-36-44""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/Test_MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_20_06_25_modify_compile.nequip.zip""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/Test_MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_20_06_25_modify_compile.nequip.zip""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,0.9428931286485046,1.3549871114639045,,,,,,,,,,,,,,,,,,,,,,,,,0.9614145329520496,1.3895312027913451,0.09009009009009009,0.00047341841999053175,0.00021575577639809565,,,,,,,,,,,,,,,,,,0.08840731015747766,,,1.3549871114639045,0.00021575577639809565,,,,,2.0820918958945375e-05,,0.008128885543898817,,1022000.0,0.08615511598841108,,,,2.703446951266588e-07,,,,0.008233671696017119,,0.06621952327354727,,0.011336788614444551,0.00047341841999053175,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",200.0,,,,201956.246469139,,,,0.9428931286485046,,,,,,,1e-06,0.9614145329520496,,,,,,1751032023.1852643,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": true}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""/workspace/Test_MPTrj_Finetune_Allegro/outputs/2025-06-25/05-36-44"", ""filename"": ""best"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true}, {""_target_"": ""lightning.pytorch.callbacks.EarlyStopping"", ""min_delta"": 0.0001, ""monitor"": ""val0_epoch/weighted_sum"", ""patience"": 200, ""verbose"": true}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""enable_checkpointing"": true, ""gradient_clip_val"": 0.015, ""log_every_n_steps"": 100, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""fixed_loss_noscales_shift_finetune_test_b1_modify_compile"", ""project"": ""Allegro_MPTraj_Finetune"", ""save_dir"": ""/workspace/Test_MPTrj_Finetune_Allegro/outputs/2025-06-25/05-36-44""}, ""max_epochs"": 200, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""ema_decay"": 0.995, ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/Test_MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_20_06_25_modify_compile.nequip.zip""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",Allegro_MPTraj_Finetune,0.18677646430706585,,,,,0.00010370770096151088,0.9009009009009008,,0.09009009009009009,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,10823.0,,,,,,6.805286272596725e-07,,,0.00012652977094931487,0.0008723849795509756,,,,0.009009009009009007,0.0008570902738542762,"{""_target_"": ""nequip.model.modify"", ""model"": {""_target_"": ""nequip.model.ModelFromPackage"", ""compile_mode"": ""compile"", ""package_path"": ""/workspace/Test_MPTrj_Finetune_Allegro/Allegro_MPTrj_SK_20_06_25_modify_compile.nequip.zip""}, ""modifiers"": [{""modifier"": ""modify_PerTypeScaleShift"", ""shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}}]}",{'runtime': 201956},0.01122597504307458,,0.0026273183677387674,,,0.18531509411434063,,,,,,,,,,1.3895312027913451,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",4.4197700572908066e-05,0.00200668709185664,,,,,0.06687658590595974,,Allegro_MPTraj_Finetune/fixed_loss_noscales_shift_finetune_test_b1_modify_compile,,,,,,,,,,,,,,,,,,,,,,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/weighted_sum,,,ModelCheckpoint|EarlyStopping|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,200.0,200.0
42,allegro_training_study_1,phase1_loss_schedule,99890.086795553,108403.0,1750673918.7185118,{'runtime': 99891},400.0,,,,1e-06,0.14124010869069675,0.7927183494667007,0.9194354898475644,1.0812386031484238,0.005673263328445454,0.013060538910778303,0.6290058305086342,,,,0.0230147476755766,,,,0.024027388761069017,536000.0,0.13363144897863022,0.9523641459170328,0.9321153016474594,1.0803060892484493,0.0058193675884672105,0.01097829433700618,0.6812161765008293,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/phase1_loss_schedule_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/phase1_loss_schedule_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/phase1_loss_schedule_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/phase1_loss_schedule"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.LossCoefficientScheduler"", ""schedule"": {""0"": {""forces_huber"": 10, ""stress_huber"": 100}, ""150"": {""forces_huber"": 50, ""stress_huber"": 50}, ""300"": {""forces_huber"": 100, ""stress_huber"": 10}}}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""phase1_loss_schedule"", ""project"": ""allegro_training_study_1"", ""save_dir"": ""results/phase1_loss_schedule""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""per_atom_energy_huber""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""forces_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""stress_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.02631043608555, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 14.781276500595284, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""per_atom_energy_huber""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""forces_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""stress_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.02631043608555, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 14.781276500595284, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.9090909090909092,0.09090909090909093,0.02523009212599224,0.4878773645014031,0.0008613031714201871,0.026425627509157855,0.4740223050598681,4.5001280180626914e-05,,,,,,,,,,0.13363144897863022,,,,,,,,,0.024027388761069017,,0.9194354898475644,,536000.0,0.14124010869069675,,,,,,,,0.9321153016474594,,0.6812161765008293,,1.0803060892484493,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""per_atom_energy_huber""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""forces_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""stress_huber""}]}",400.0,,0.02523009212599224,0.0008613031714201871,99890.086795553,0.4878773645014031,,,,,,0.026425627509157855,,,,1e-06,,,,,,,1750673918.7185118,,0.4740223050598681,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/phase1_loss_schedule_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/phase1_loss_schedule_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/phase1_loss_schedule_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/phase1_loss_schedule"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.LossCoefficientScheduler"", ""schedule"": {""0"": {""forces_huber"": 10, ""stress_huber"": 100}, ""150"": {""forces_huber"": 50, ""stress_huber"": 50}, ""300"": {""forces_huber"": 100, ""stress_huber"": 10}}}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""phase1_loss_schedule"", ""project"": ""allegro_training_study_1"", ""save_dir"": ""results/phase1_loss_schedule""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""per_atom_energy_huber""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""forces_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""stress_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.02631043608555, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 14.781276500595284, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_training_study_1,0.7927183494667007,,,,,,,4.5001280180626914e-05,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,108403.0,,,,,0.9090909090909092,,,,,0.005673263328445454,,0.09090909090909093,,,0.0058193675884672105,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.02631043608555, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 14.781276500595284, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 99891},1.0812386031484238,,0.013060538910778303,,,0.9523641459170328,,,,,,,,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.0230147476755766,0.01097829433700618,,,,,0.6290058305086342,,allegro_training_study_1/phase1_loss_schedule,5.0,2.0,2.0,float32,42.0,32.02631043608555,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/phase1_loss_schedule_train.xyz,data/phase1_loss_schedule_val.xyz,data/phase1_loss_schedule_test.xyz,a6e4ec8c,train:data/phase1_loss_schedule_train.xyz|val:data/phase1_loss_schedule_val.xyz|test:data/phase1_loss_schedule_test.xyz,per_atom_energy_huber(coeff=1)|forces_huber(coeff=10)|stress_huber(coeff=100),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|LossCoefficientScheduler|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,400.0,400.0
43,allegro_training_study_1,phase2_rare_sampling_v3,112995.970847006,125603.0,1750825512.6640322,{'runtime': 112996},400.0,,0.009009009009009007,0.9009009009009008,1e-06,0.2057828649305414,0.3919468892365347,0.06840446878896171,0.1977256605558108,0.004874293683429087,0.011466195216281646,0.2003795816695424,,0.6307754692877475,0.01563691644361759,0.035661224671134716,,0.0028981293052508586,6.284641168231393e-05,0.006989846663777577,622000.0,0.2005855429594514,0.5178576593863153,0.07082793165438289,0.1981596693885028,0.0049543067344558845,0.01767367342180296,0.24456366739887367,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""alpha"": 0.25, ""rare_idx"": [14161, 6877, 4353, 4354, 4355, 1409, 4362, 4363, 4364, 1418, 4371, 4372, 4373, 1495, 4380, 4381, 4382, 14202, 4389, 4390, 4391, 15589, 4398, 4399, 4400, 15618, 4407, 4408, 4409, 15690, 4416, 4417, 4418, 15832, 4425, 4426, 4427, 16094, 4434, 4435, 4436, 16246, 4443, 4444, 4445, 17419, 4452, 4453, 4454, 17420, 4462, 4463, 4464, 17434, 4470, 4471, 4472, 705, 4479, 4480, 4481, 713, 4488, 4489, 4490, 839, 4498, 4499, 4500, 982, 4506, 4507, 25633, 14296, 14302, 25648, 25651, 14310, 25654, 25656, 14314, 25658, 14316, 25662, 14320, 25669, 25670, 14324, 14325, 25676, 14327, 14331, 14335, 14337, 14338, 14340, 25695, 25697, 14342, 14343, 25701, 14345, 25707, 25712, 14353, 25714, 25716, 14356, 25719, 14359, 25722, 14360, 25723, 23927, 23929, 23931, 14362, 23933, 23935, 25729, 23940, 23942, 25733, 23943, 14368, 23945, 14370, 14372, 25742, 25744, 14376, 25747, 24104, 24105, 24107, 24108, 24109, 24110, 7495, 24111, 24112, 24113, 24114, 7504, 7511, 7520, 24115, 19915, 10547, 25973, 24317, 24318, 24319, 24320, 24321, 24322, 24324, 24325, 24326, 24327, 24328, 24329, 7623, 24330, 24331, 24332, 24333, 24334, 24335, 24336, 24337, 7631, 7639, 7647, 25996, 7655, 7663, 7672, 7679, 7687, 7696, 7703, 7712, 24338, 24339, 24340, 24341, 24342, 24343, 14562, 24344, 24345, 24346, 24347, 24348, 7719, 7727, 24349, 7735, 7743, 24350, 14569, 26016, 24506, 24513, 26130, 14678, 26167, 26172, 26177, 14691, 14692, 14695, 26184, 26185, 14697, 14700, 26191, 14704, 14707, 26205, 26214, 14718, 26223, 14731, 24789, 26239, 26240, 14736, 24792, 24793, 24794, 24795, 24796, 26270, 2095, 14764, 26282, 26283, 14768, 26286, 14769, 14770, 26288, 14771, 26290, 14772, 26292, 14774, 14777, 14778, 14779, 14780, 14782, 26306, 14783, 14785, 26310, 14787, 26313, 14788, 14790, 14791, 26318, 14792, 14795, 26323, 14796, 14797, 14798, 14805, 14809, 14810, 14811, 26348, 14813, 14815, 26351, 26354, 26359, 26366, 26370, 26381, 26382, 14840, 26387, 5546, 26453, 14888, 26454, 14890, 26456, 14891, 14893, 14895, 26463, 14896, 26466, 14899, 26471, 26475, 26478, 14909, 14910, 14913, 26489, 14919, 26499, 14921, 26501, 14923, 14924, 26508, 14927, 14928, 26510, 14929, 26517, 26524, 14939, 26528, 26531, 26535, 26552, 14960, 26559, 26564, 3285, 14972, 26572, 26573, 26582, 14984, 14985, 14986, 5735, 26594, 14991, 14992, 26601, 14994, 26605, 14998, 26608, 26611, 15002, 15005, 26617, 15006, 26622, 15009, 15010, 15011, 26626, 26627, 15015, 26636, 26638, 26639, 15021, 26640, 26641, 26646, 15027, 26652, 26653, 26657, 15033, 26662, 26667, 15044, 26673, 26681, 15053, 26774, 75, 95, 100, 3827, 170, 15265, 25021, 191, 192, 25022, 15272, 194, 25023, 15274, 198, 25024, 199, 15278, 25025, 15279, 204, 205, 25026, 208, 25027, 15284, 25028, 215, 25029, 15289, 25030, 220, 25031, 25032, 25033, 25034, 15301, 25035, 235, 15302, 237, 15304, 15305, 25036, 15306, 25037, 242, 25038, 15309, 15310, 247, 25039, 248, 25040, 25041, 25042, 25043, 25044, 25045, 25046, 25047, 25048, 25049, 25050, 25051, 25052, 25053, 25054, 25055, 25056, 25057, 25058, 25059, 25060, 25061, 25062, 25063, 25064, 25065, 25066, 25067, 25068, 25069, 25070, 11560, 25071, 25072, 25073, 25074, 25075, 25076, 25077, 25078, 15401, 25079, 430, 15442, 15443, 433, 15444, 439, 447, 25102, 456, 458, 471, 475, 15474, 481, 15478, 484, 486, 524, 577, 4457, 4511, 776, 4851, 6991, 25275, 12245, 12246, 25418, 1125, 25332, 17991, 25343, 7335, 25344, 12455, 12456, 12457, 12458, 12459, 12460, 12461, 12462, 12463, 12464, 12465, 25345, 12538, 12539, 12542, 12543, 12544, 12545, 12546, 25366, 25367, 12681, 12682, 12683, 12684, 12685, 12686, 12641, 12642, 12532, 12540, 12687, 12688, 12689, 12690, 12691, 12692, 12693, 25391, 25415, 12164, 12171, 12206, 12220, 12228, 12229, 12330, 12331, 12332, 12333, 12334, 12339, 12547, 12548, 12549, 12551, 12552, 12553, 12557, 12563, 12564, 12566, 12567, 12571, 12574, 12576, 12579, 12580, 12581, 25420, 25421, 12592, 12593, 12595, 12598, 12599, 12600, 12601, 12603, 12604, 12608, 12609, 12610, 12613, 12614, 12616, 12617, 12618, 12619, 12620, 12622, 12623, 12624, 12628, 12629, 12631, 12632, 12633, 12634, 12638, 12639, 12640, 12643, 12644, 12645, 12650, 12651, 12654, 12655, 12658, 12659, 12660, 12666, 25429, 13023, 13024, 13027, 13028, 13031, 13032, 13034, 13038, 13039, 13041, 13042, 13045, 13046, 13049, 13052, 13058, 13059, 13061, 13062, 13066, 13067, 13070, 13073, 13074, 13077, 13078, 13079, 13082, 13083, 13444, 13445, 13447, 13451, 13461, 13462, 13469, 13470, 13471, 13472, 13473, 13474, 13477, 13478, 13483, 13484, 13489, 12959, 13490, 13492, 13493, 13495, 13496, 13497, 13498, 13500, 13504, 13509, 13510, 13512, 13513, 13514, 13518, 13521, 13525, 13526, 13527, 13528, 13529, 13532, 13538, 13539, 13549, 13550, 13551, 13554, 13556, 13557, 13559, 13563, 13566, 13574, 13575, 13570, 13582, 13583, 13588, 25446, 13598, 13006, 13007, 13008, 13009, 13010, 25580, 1558, 1565, 13098, 13099, 13100, 25699, 13101, 13102, 13103, 13104, 12997, 13105, 13106, 25727, 13107, 13108, 13109, 13110, 13111, 13013, 13014, 13113, 13114, 13112, 13012, 1593, 1099, 1632, 1650, 13216, 13217, 13227, 13228, 13229, 13230, 13231, 13232, 13233, 1669, 13234, 13235, 13236, 13237, 13238, 13239, 13240, 13249, 13252, 1693, 26392, 1777, 1781, 24787, 13422, 13423, 13424, 13425, 13426, 13427, 13428, 13429, 13430, 13431, 13432, 13433, 13435, 13436, 24797, 24798, 24799, 24800, 24801, 24802, 24803, 24804, 24807, 24808, 24809, 24810, 24811, 24812, 24813, 24814, 24815, 24816, 24817, 24818, 24819, 24820, 24822, 24823, 24825, 24826, 24827, 24829, 24830, 24831, 24832, 24833, 24834, 24835, 24836, 24837, 24838, 24840, 24841, 24843, 24845, 24846, 24847, 24848, 24853, 24855, 24856, 24860, 24861, 24862, 24863, 24864, 24866, 24867, 24868, 24870, 24871, 24872, 24873, 24874, 24875, 24877, 24878, 24880, 24883, 24884, 24885, 24886, 24887, 8032, 24889, 24890, 24891, 24892, 24893, 24894, 24895, 24897, 24898, 24899, 24900, 24902, 24903, 24904, 24905, 24906, 24908, 24909, 24911, 24914, 24915, 24916, 24917, 24918, 24921, 24922, 24923, 24926, 24927, 24928, 24930, 24931, 24934, 24935, 24937, 24938, 24939, 24940, 24941, 24942, 24943, 24944, 24945, 24946, 24947, 24948, 24949, 24950, 24951, 24952, 24953, 24954, 24955, 24956, 24957, 24958, 24959, 24960, 24961, 24962, 24963, 24964, 24965, 24966, 24967, 24968, 24969, 24970, 24971, 24972, 24973, 24974, 24975, 24976, 24977, 24978, 24979, 24980, 24981, 24982, 24983, 24984, 24985, 24986, 24987, 24988, 24989, 24990, 24991, 24992, 24993, 24994, 24995, 24996, 24997, 24998, 24999, 18482, 25000, 25001, 25002, 25003, 25004, 25005, 25006, 25007, 25008, 25009, 25010, 25011, 25012, 25013, 25014, 25015, 25016, 25017, 25018, 25019, 25020, 13664, 13665, 13680, 13681, 13682, 13683, 13684, 13685, 13686, 13687, 13688, 13689, 13690, 13691, 13692, 13693, 13694, 13695, 13696, 13697, 13698, 13699, 13700, 13702, 13703, 13704, 13705, 13706, 13707, 13708, 13709, 13701, 13710, 13711, 13712, 13713, 13714, 13715, 13716, 13717, 13718, 13719, 13720, 13721, 13722, 13723, 13724, 13725, 13726, 13727, 13728, 13731, 13732, 13733, 13734, 13735, 13736, 13737, 13738, 13739, 13740, 13741, 13729, 13730, 13742, 13743, 13744, 25080, 25081, 25082, 25083, 25084, 25085, 25086, 25087, 25088, 25089, 25090, 25091, 25092, 25093, 25094, 25095, 25096, 25097, 25098, 25099, 25100, 25101, 8173, 25103, 25104, 25105, 25106, 25107, 25108, 25109, 25110, 25111, 25112, 25113, 25114, 25115, 25116, 25117, 25118, 25119, 25120, 25121, 25122, 25123, 25124, 25125, 25126, 25127, 25128, 25129, 25130, 25131, 25132, 25133, 25134, 25135, 25136, 25137, 25138, 25139, 25140, 25141, 25142, 25143, 25144, 25145, 25146, 25147, 25148, 25149, 25150, 25151, 25152, 25153, 25154, 25155, 25156, 25157, 25158, 25159, 25160, 25161, 25162, 25163, 25164, 25165, 25166, 25167, 25168, 25169, 25170, 25171, 25172, 25173, 25174, 25175, 25176, 25177, 25178, 25179, 25180, 25181, 25182, 25183, 25184, 25185, 25186, 25187, 25188, 25189, 25190, 25191, 25192, 25193, 25194, 25195, 25196, 25197, 25198, 25199, 25200, 25201, 25202, 25203, 25204, 25205, 25206, 25207, 25208, 25209, 25210, 25211, 25212, 25213, 25214, 25215, 25216, 25217, 25218, 25219, 25220, 25221, 25222, 25223, 25224, 25225, 25226, 25227, 25228, 25229, 25230, 25231, 25232, 25233, 25234, 25235, 25236, 25237, 25238, 25239, 25240, 25241, 25242, 25243, 25244, 25245, 25246, 25247, 25248, 25249, 25250, 25251, 25252, 25253, 25254, 25255, 25256, 25257, 25258, 25259, 25260, 25261, 25262, 25263, 25264, 25265, 25266, 25267, 25268, 25269, 25270, 25271, 25272, 25273, 25274, 8283, 25276, 25277, 25278, 25279, 25280, 25281, 25282, 25283, 25284, 25285, 25286, 25287, 25288, 25289, 25290, 25291, 25292, 25293, 25294, 25295, 25296, 25297, 25298, 25299, 25300, 25301, 25302, 25303, 25304, 25305, 25306, 25307, 25308, 25309, 25310, 25311, 25312, 25313, 25314, 25315, 25316, 25317, 25318, 25319, 25320, 25321, 25322, 25323, 25324, 25325, 25326, 25327, 25328, 25329, 25330, 25331, 2140, 25333, 25334, 25335, 25336, 25337, 25338, 25339, 25340, 25341, 25342, 18632, 2148, 16357, 25346, 25347, 25348, 25349, 25350, 25351, 25352, 25353, 25354, 25355, 25356, 25357, 25358, 25359, 25360, 25361, 25362, 25363, 25364, 25365, 2162, 16367, 25368, 25369, 25370, 25371, 25372, 25373, 25374, 25375, 25376, 25377, 25378, 25379, 25380, 25381, 25382, 25383, 25384, 25385, 25386, 25387, 25388, 25389, 25390, 2178, 25392, 25393, 25394, 25395, 25396, 25397, 25398, 25399, 25400, 25401, 25402, 25403, 25404, 25405, 25406, 25407, 25408, 25409, 25410, 25411, 25412, 25413, 25414, 25416, 2195, 25419, 25422, 25423, 25424, 16393, 25426, 25427, 25428, 2202, 25430, 25431, 25432, 16397, 2205, 2206, 25436, 25437, 25438, 25439, 25440, 25441, 25442, 25443, 25444, 25445, 2213, 25447, 2216, 14107, 2219, 2223, 25417, 14117, 16412, 16415, 14127, 14128, 16418, 16419, 14132, 14134, 2237, 14137, 14138, 14139, 14140, 14141, 14142, 14143, 14144, 16423, 14145, 14147, 2244, 16426, 14150, 14151, 2246, 16427, 14146, 14148, 14149, 14152, 16431, 2260, 2265, 21669, 16442, 2272, 4006, 2273, 2276, 2279, 2281, 2282, 2288, 2289, 16458, 16459, 21708, 21709, 21710, 4486, 4495, 4497, 9678, 16465, 2302, 16467, 16469, 16470, 2308, 21726, 9703, 9710, 9718, 9726, 9734, 16475, 9742, 9750, 9759, 21727, 21728, 21729, 21730, 21731, 21732, 21733, 21734, 21735, 21736, 21737, 9767, 9774, 9782, 9790, 9801, 21745, 21747, 21753, 9815, 18755, 21767, 21768, 21779, 25425, 21787, 21790, 21798, 21803, 21824, 21826, 21840, 21862, 21876, 21879, 11441, 21881, 21883, 21893, 21902, 21906, 8631, 21938, 21963, 25433, 21973, 21974, 21976, 2486, 21984, 21990, 25434, 22003, 22007, 22012, 22018, 22021, 22023, 11628, 25435, 16618, 21986, 22037, 22041, 22056, 16638, 22070, 22071, 2548, 16644, 2554, 22100, 22109, 22116, 22093, 22127, 2608, 17920, 16698, 22186, 22194, 22210, 683, 22254, 22266, 18028, 8888, 22337, 22341, 22342, 22348, 22360, 22365, 18171, 18232, 22386, 18255, 22393, 22410, 16815, 22420, 22428, 22430, 22431, 22435, 22442, 22456, 22474, 22493, 22507, 22522, 22523, 22524, 22525, 22526, 22527, 22528, 22529, 22530, 22531, 22469, 22492, 22505, 22513, 16871, 4618, 5180, 5188, 5196, 5204, 16873, 5214, 5220, 5229, 5236, 5244, 5252, 16877, 2876, 16878, 2877, 2878, 16880, 16886, 16887, 16888, 16896, 5629, 16897, 2903, 16898, 5660, 2906, 16902, 16904, 2915, 2918, 16908, 16911, 3050, 3057, 19116, 9271, 17048, 3121, 3128, 3133, 3134, 17065, 17071, 3147, 3155, 3157, 3163, 17132, 3235, 17137, 17138, 17140, 17142, 17144, 3248, 17149, 3253, 3255, 17152, 17156, 3267, 3269, 17161, 17162, 17164, 3277, 20248, 20256, 20271, 20279, 20287, 20295, 20319, 20327, 20328, 20335, 20343, 3310, 3328, 9565, 19370, 23028, 23029, 23030, 23031, 23032, 23033, 23034, 23035, 23036, 23037, 23038, 23039, 23040, 23041, 23042, 6365, 23043, 23044, 23045, 23046, 6677, 23302, 23303, 23304, 23305, 6581, 6589, 6597, 6605, 6613, 6621, 6629, 6637, 6645, 23306, 23307, 23308, 23309, 23310, 23311, 23312, 23313, 23314, 23315, 19513, 6653, 6662, 23316, 23317, 23319, 23318, 23320, 6669, 23321, 23323, 23324, 23322, 23326, 23325, 23329, 23327, 23330, 23332, 23333, 23331, 23334, 23337, 23338, 23339, 23340, 23342, 23335, 23343, 23344, 23347, 23348, 23345, 23351, 23352, 23353, 23346, 23355, 23349, 23350, 23358, 23359, 23354, 23356, 23357, 23360, 23361, 19550, 17390, 3900, 3901, 3902, 17391, 3909, 17392, 3910, 17393, 3916, 3917, 3918, 17394, 3926, 17395, 3927, 17360, 3933, 17396, 3934, 17397, 3940, 3941, 3942, 17398, 3947, 3948, 3949, 17399, 3956, 9957, 23457, 6116, 6124, 6132, 6140, 6148, 6157, 6164, 6173, 6181, 6189, 6197, 6205, 6213, 6221, 6229, 6236, 6245, 6252], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 16}, ""test_file_path"": ""data/phase2_rare_sampling_v3_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 16}, ""train_file_path"": ""data/phase2_rare_sampling_v3_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 16}, ""val_file_path"": ""data/phase2_rare_sampling_v3_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/phase2_rare_sampling_v3"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""phase2_rare_sampling_v3"", ""project"": ""allegro_training_study_1"", ""save_dir"": ""results/phase2_rare_sampling_v3""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""forces_mse""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03164488944631, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.783765071055388, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""forces_mse""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03164488944631, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.783765071055388, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.09009009009009009,0.17639288248464466,0.07666902092058288,,,,,,,0.2005855429594514,,,,,,,,,0.006989846663777577,,0.06840446878896171,,622000.0,0.2057828649305414,,,,6.284641168231393e-05,,,,0.07082793165438289,,0.24456366739887367,,0.1981596693885028,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""forces_mse""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",400.0,,,,112995.970847006,,,,,,,,,,,1e-06,,,,,,0.07666902092058288,1750825512.6640322,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""alpha"": 0.25, ""rare_idx"": [14161, 6877, 4353, 4354, 4355, 1409, 4362, 4363, 4364, 1418, 4371, 4372, 4373, 1495, 4380, 4381, 4382, 14202, 4389, 4390, 4391, 15589, 4398, 4399, 4400, 15618, 4407, 4408, 4409, 15690, 4416, 4417, 4418, 15832, 4425, 4426, 4427, 16094, 4434, 4435, 4436, 16246, 4443, 4444, 4445, 17419, 4452, 4453, 4454, 17420, 4462, 4463, 4464, 17434, 4470, 4471, 4472, 705, 4479, 4480, 4481, 713, 4488, 4489, 4490, 839, 4498, 4499, 4500, 982, 4506, 4507, 25633, 14296, 14302, 25648, 25651, 14310, 25654, 25656, 14314, 25658, 14316, 25662, 14320, 25669, 25670, 14324, 14325, 25676, 14327, 14331, 14335, 14337, 14338, 14340, 25695, 25697, 14342, 14343, 25701, 14345, 25707, 25712, 14353, 25714, 25716, 14356, 25719, 14359, 25722, 14360, 25723, 23927, 23929, 23931, 14362, 23933, 23935, 25729, 23940, 23942, 25733, 23943, 14368, 23945, 14370, 14372, 25742, 25744, 14376, 25747, 24104, 24105, 24107, 24108, 24109, 24110, 7495, 24111, 24112, 24113, 24114, 7504, 7511, 7520, 24115, 19915, 10547, 25973, 24317, 24318, 24319, 24320, 24321, 24322, 24324, 24325, 24326, 24327, 24328, 24329, 7623, 24330, 24331, 24332, 24333, 24334, 24335, 24336, 24337, 7631, 7639, 7647, 25996, 7655, 7663, 7672, 7679, 7687, 7696, 7703, 7712, 24338, 24339, 24340, 24341, 24342, 24343, 14562, 24344, 24345, 24346, 24347, 24348, 7719, 7727, 24349, 7735, 7743, 24350, 14569, 26016, 24506, 24513, 26130, 14678, 26167, 26172, 26177, 14691, 14692, 14695, 26184, 26185, 14697, 14700, 26191, 14704, 14707, 26205, 26214, 14718, 26223, 14731, 24789, 26239, 26240, 14736, 24792, 24793, 24794, 24795, 24796, 26270, 2095, 14764, 26282, 26283, 14768, 26286, 14769, 14770, 26288, 14771, 26290, 14772, 26292, 14774, 14777, 14778, 14779, 14780, 14782, 26306, 14783, 14785, 26310, 14787, 26313, 14788, 14790, 14791, 26318, 14792, 14795, 26323, 14796, 14797, 14798, 14805, 14809, 14810, 14811, 26348, 14813, 14815, 26351, 26354, 26359, 26366, 26370, 26381, 26382, 14840, 26387, 5546, 26453, 14888, 26454, 14890, 26456, 14891, 14893, 14895, 26463, 14896, 26466, 14899, 26471, 26475, 26478, 14909, 14910, 14913, 26489, 14919, 26499, 14921, 26501, 14923, 14924, 26508, 14927, 14928, 26510, 14929, 26517, 26524, 14939, 26528, 26531, 26535, 26552, 14960, 26559, 26564, 3285, 14972, 26572, 26573, 26582, 14984, 14985, 14986, 5735, 26594, 14991, 14992, 26601, 14994, 26605, 14998, 26608, 26611, 15002, 15005, 26617, 15006, 26622, 15009, 15010, 15011, 26626, 26627, 15015, 26636, 26638, 26639, 15021, 26640, 26641, 26646, 15027, 26652, 26653, 26657, 15033, 26662, 26667, 15044, 26673, 26681, 15053, 26774, 75, 95, 100, 3827, 170, 15265, 25021, 191, 192, 25022, 15272, 194, 25023, 15274, 198, 25024, 199, 15278, 25025, 15279, 204, 205, 25026, 208, 25027, 15284, 25028, 215, 25029, 15289, 25030, 220, 25031, 25032, 25033, 25034, 15301, 25035, 235, 15302, 237, 15304, 15305, 25036, 15306, 25037, 242, 25038, 15309, 15310, 247, 25039, 248, 25040, 25041, 25042, 25043, 25044, 25045, 25046, 25047, 25048, 25049, 25050, 25051, 25052, 25053, 25054, 25055, 25056, 25057, 25058, 25059, 25060, 25061, 25062, 25063, 25064, 25065, 25066, 25067, 25068, 25069, 25070, 11560, 25071, 25072, 25073, 25074, 25075, 25076, 25077, 25078, 15401, 25079, 430, 15442, 15443, 433, 15444, 439, 447, 25102, 456, 458, 471, 475, 15474, 481, 15478, 484, 486, 524, 577, 4457, 4511, 776, 4851, 6991, 25275, 12245, 12246, 25418, 1125, 25332, 17991, 25343, 7335, 25344, 12455, 12456, 12457, 12458, 12459, 12460, 12461, 12462, 12463, 12464, 12465, 25345, 12538, 12539, 12542, 12543, 12544, 12545, 12546, 25366, 25367, 12681, 12682, 12683, 12684, 12685, 12686, 12641, 12642, 12532, 12540, 12687, 12688, 12689, 12690, 12691, 12692, 12693, 25391, 25415, 12164, 12171, 12206, 12220, 12228, 12229, 12330, 12331, 12332, 12333, 12334, 12339, 12547, 12548, 12549, 12551, 12552, 12553, 12557, 12563, 12564, 12566, 12567, 12571, 12574, 12576, 12579, 12580, 12581, 25420, 25421, 12592, 12593, 12595, 12598, 12599, 12600, 12601, 12603, 12604, 12608, 12609, 12610, 12613, 12614, 12616, 12617, 12618, 12619, 12620, 12622, 12623, 12624, 12628, 12629, 12631, 12632, 12633, 12634, 12638, 12639, 12640, 12643, 12644, 12645, 12650, 12651, 12654, 12655, 12658, 12659, 12660, 12666, 25429, 13023, 13024, 13027, 13028, 13031, 13032, 13034, 13038, 13039, 13041, 13042, 13045, 13046, 13049, 13052, 13058, 13059, 13061, 13062, 13066, 13067, 13070, 13073, 13074, 13077, 13078, 13079, 13082, 13083, 13444, 13445, 13447, 13451, 13461, 13462, 13469, 13470, 13471, 13472, 13473, 13474, 13477, 13478, 13483, 13484, 13489, 12959, 13490, 13492, 13493, 13495, 13496, 13497, 13498, 13500, 13504, 13509, 13510, 13512, 13513, 13514, 13518, 13521, 13525, 13526, 13527, 13528, 13529, 13532, 13538, 13539, 13549, 13550, 13551, 13554, 13556, 13557, 13559, 13563, 13566, 13574, 13575, 13570, 13582, 13583, 13588, 25446, 13598, 13006, 13007, 13008, 13009, 13010, 25580, 1558, 1565, 13098, 13099, 13100, 25699, 13101, 13102, 13103, 13104, 12997, 13105, 13106, 25727, 13107, 13108, 13109, 13110, 13111, 13013, 13014, 13113, 13114, 13112, 13012, 1593, 1099, 1632, 1650, 13216, 13217, 13227, 13228, 13229, 13230, 13231, 13232, 13233, 1669, 13234, 13235, 13236, 13237, 13238, 13239, 13240, 13249, 13252, 1693, 26392, 1777, 1781, 24787, 13422, 13423, 13424, 13425, 13426, 13427, 13428, 13429, 13430, 13431, 13432, 13433, 13435, 13436, 24797, 24798, 24799, 24800, 24801, 24802, 24803, 24804, 24807, 24808, 24809, 24810, 24811, 24812, 24813, 24814, 24815, 24816, 24817, 24818, 24819, 24820, 24822, 24823, 24825, 24826, 24827, 24829, 24830, 24831, 24832, 24833, 24834, 24835, 24836, 24837, 24838, 24840, 24841, 24843, 24845, 24846, 24847, 24848, 24853, 24855, 24856, 24860, 24861, 24862, 24863, 24864, 24866, 24867, 24868, 24870, 24871, 24872, 24873, 24874, 24875, 24877, 24878, 24880, 24883, 24884, 24885, 24886, 24887, 8032, 24889, 24890, 24891, 24892, 24893, 24894, 24895, 24897, 24898, 24899, 24900, 24902, 24903, 24904, 24905, 24906, 24908, 24909, 24911, 24914, 24915, 24916, 24917, 24918, 24921, 24922, 24923, 24926, 24927, 24928, 24930, 24931, 24934, 24935, 24937, 24938, 24939, 24940, 24941, 24942, 24943, 24944, 24945, 24946, 24947, 24948, 24949, 24950, 24951, 24952, 24953, 24954, 24955, 24956, 24957, 24958, 24959, 24960, 24961, 24962, 24963, 24964, 24965, 24966, 24967, 24968, 24969, 24970, 24971, 24972, 24973, 24974, 24975, 24976, 24977, 24978, 24979, 24980, 24981, 24982, 24983, 24984, 24985, 24986, 24987, 24988, 24989, 24990, 24991, 24992, 24993, 24994, 24995, 24996, 24997, 24998, 24999, 18482, 25000, 25001, 25002, 25003, 25004, 25005, 25006, 25007, 25008, 25009, 25010, 25011, 25012, 25013, 25014, 25015, 25016, 25017, 25018, 25019, 25020, 13664, 13665, 13680, 13681, 13682, 13683, 13684, 13685, 13686, 13687, 13688, 13689, 13690, 13691, 13692, 13693, 13694, 13695, 13696, 13697, 13698, 13699, 13700, 13702, 13703, 13704, 13705, 13706, 13707, 13708, 13709, 13701, 13710, 13711, 13712, 13713, 13714, 13715, 13716, 13717, 13718, 13719, 13720, 13721, 13722, 13723, 13724, 13725, 13726, 13727, 13728, 13731, 13732, 13733, 13734, 13735, 13736, 13737, 13738, 13739, 13740, 13741, 13729, 13730, 13742, 13743, 13744, 25080, 25081, 25082, 25083, 25084, 25085, 25086, 25087, 25088, 25089, 25090, 25091, 25092, 25093, 25094, 25095, 25096, 25097, 25098, 25099, 25100, 25101, 8173, 25103, 25104, 25105, 25106, 25107, 25108, 25109, 25110, 25111, 25112, 25113, 25114, 25115, 25116, 25117, 25118, 25119, 25120, 25121, 25122, 25123, 25124, 25125, 25126, 25127, 25128, 25129, 25130, 25131, 25132, 25133, 25134, 25135, 25136, 25137, 25138, 25139, 25140, 25141, 25142, 25143, 25144, 25145, 25146, 25147, 25148, 25149, 25150, 25151, 25152, 25153, 25154, 25155, 25156, 25157, 25158, 25159, 25160, 25161, 25162, 25163, 25164, 25165, 25166, 25167, 25168, 25169, 25170, 25171, 25172, 25173, 25174, 25175, 25176, 25177, 25178, 25179, 25180, 25181, 25182, 25183, 25184, 25185, 25186, 25187, 25188, 25189, 25190, 25191, 25192, 25193, 25194, 25195, 25196, 25197, 25198, 25199, 25200, 25201, 25202, 25203, 25204, 25205, 25206, 25207, 25208, 25209, 25210, 25211, 25212, 25213, 25214, 25215, 25216, 25217, 25218, 25219, 25220, 25221, 25222, 25223, 25224, 25225, 25226, 25227, 25228, 25229, 25230, 25231, 25232, 25233, 25234, 25235, 25236, 25237, 25238, 25239, 25240, 25241, 25242, 25243, 25244, 25245, 25246, 25247, 25248, 25249, 25250, 25251, 25252, 25253, 25254, 25255, 25256, 25257, 25258, 25259, 25260, 25261, 25262, 25263, 25264, 25265, 25266, 25267, 25268, 25269, 25270, 25271, 25272, 25273, 25274, 8283, 25276, 25277, 25278, 25279, 25280, 25281, 25282, 25283, 25284, 25285, 25286, 25287, 25288, 25289, 25290, 25291, 25292, 25293, 25294, 25295, 25296, 25297, 25298, 25299, 25300, 25301, 25302, 25303, 25304, 25305, 25306, 25307, 25308, 25309, 25310, 25311, 25312, 25313, 25314, 25315, 25316, 25317, 25318, 25319, 25320, 25321, 25322, 25323, 25324, 25325, 25326, 25327, 25328, 25329, 25330, 25331, 2140, 25333, 25334, 25335, 25336, 25337, 25338, 25339, 25340, 25341, 25342, 18632, 2148, 16357, 25346, 25347, 25348, 25349, 25350, 25351, 25352, 25353, 25354, 25355, 25356, 25357, 25358, 25359, 25360, 25361, 25362, 25363, 25364, 25365, 2162, 16367, 25368, 25369, 25370, 25371, 25372, 25373, 25374, 25375, 25376, 25377, 25378, 25379, 25380, 25381, 25382, 25383, 25384, 25385, 25386, 25387, 25388, 25389, 25390, 2178, 25392, 25393, 25394, 25395, 25396, 25397, 25398, 25399, 25400, 25401, 25402, 25403, 25404, 25405, 25406, 25407, 25408, 25409, 25410, 25411, 25412, 25413, 25414, 25416, 2195, 25419, 25422, 25423, 25424, 16393, 25426, 25427, 25428, 2202, 25430, 25431, 25432, 16397, 2205, 2206, 25436, 25437, 25438, 25439, 25440, 25441, 25442, 25443, 25444, 25445, 2213, 25447, 2216, 14107, 2219, 2223, 25417, 14117, 16412, 16415, 14127, 14128, 16418, 16419, 14132, 14134, 2237, 14137, 14138, 14139, 14140, 14141, 14142, 14143, 14144, 16423, 14145, 14147, 2244, 16426, 14150, 14151, 2246, 16427, 14146, 14148, 14149, 14152, 16431, 2260, 2265, 21669, 16442, 2272, 4006, 2273, 2276, 2279, 2281, 2282, 2288, 2289, 16458, 16459, 21708, 21709, 21710, 4486, 4495, 4497, 9678, 16465, 2302, 16467, 16469, 16470, 2308, 21726, 9703, 9710, 9718, 9726, 9734, 16475, 9742, 9750, 9759, 21727, 21728, 21729, 21730, 21731, 21732, 21733, 21734, 21735, 21736, 21737, 9767, 9774, 9782, 9790, 9801, 21745, 21747, 21753, 9815, 18755, 21767, 21768, 21779, 25425, 21787, 21790, 21798, 21803, 21824, 21826, 21840, 21862, 21876, 21879, 11441, 21881, 21883, 21893, 21902, 21906, 8631, 21938, 21963, 25433, 21973, 21974, 21976, 2486, 21984, 21990, 25434, 22003, 22007, 22012, 22018, 22021, 22023, 11628, 25435, 16618, 21986, 22037, 22041, 22056, 16638, 22070, 22071, 2548, 16644, 2554, 22100, 22109, 22116, 22093, 22127, 2608, 17920, 16698, 22186, 22194, 22210, 683, 22254, 22266, 18028, 8888, 22337, 22341, 22342, 22348, 22360, 22365, 18171, 18232, 22386, 18255, 22393, 22410, 16815, 22420, 22428, 22430, 22431, 22435, 22442, 22456, 22474, 22493, 22507, 22522, 22523, 22524, 22525, 22526, 22527, 22528, 22529, 22530, 22531, 22469, 22492, 22505, 22513, 16871, 4618, 5180, 5188, 5196, 5204, 16873, 5214, 5220, 5229, 5236, 5244, 5252, 16877, 2876, 16878, 2877, 2878, 16880, 16886, 16887, 16888, 16896, 5629, 16897, 2903, 16898, 5660, 2906, 16902, 16904, 2915, 2918, 16908, 16911, 3050, 3057, 19116, 9271, 17048, 3121, 3128, 3133, 3134, 17065, 17071, 3147, 3155, 3157, 3163, 17132, 3235, 17137, 17138, 17140, 17142, 17144, 3248, 17149, 3253, 3255, 17152, 17156, 3267, 3269, 17161, 17162, 17164, 3277, 20248, 20256, 20271, 20279, 20287, 20295, 20319, 20327, 20328, 20335, 20343, 3310, 3328, 9565, 19370, 23028, 23029, 23030, 23031, 23032, 23033, 23034, 23035, 23036, 23037, 23038, 23039, 23040, 23041, 23042, 6365, 23043, 23044, 23045, 23046, 6677, 23302, 23303, 23304, 23305, 6581, 6589, 6597, 6605, 6613, 6621, 6629, 6637, 6645, 23306, 23307, 23308, 23309, 23310, 23311, 23312, 23313, 23314, 23315, 19513, 6653, 6662, 23316, 23317, 23319, 23318, 23320, 6669, 23321, 23323, 23324, 23322, 23326, 23325, 23329, 23327, 23330, 23332, 23333, 23331, 23334, 23337, 23338, 23339, 23340, 23342, 23335, 23343, 23344, 23347, 23348, 23345, 23351, 23352, 23353, 23346, 23355, 23349, 23350, 23358, 23359, 23354, 23356, 23357, 23360, 23361, 19550, 17390, 3900, 3901, 3902, 17391, 3909, 17392, 3910, 17393, 3916, 3917, 3918, 17394, 3926, 17395, 3927, 17360, 3933, 17396, 3934, 17397, 3940, 3941, 3942, 17398, 3947, 3948, 3949, 17399, 3956, 9957, 23457, 6116, 6124, 6132, 6140, 6148, 6157, 6164, 6173, 6181, 6189, 6197, 6205, 6213, 6221, 6229, 6236, 6245, 6252], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 16}, ""test_file_path"": ""data/phase2_rare_sampling_v3_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 16}, ""train_file_path"": ""data/phase2_rare_sampling_v3_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 16}, ""val_file_path"": ""data/phase2_rare_sampling_v3_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/phase2_rare_sampling_v3"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""phase2_rare_sampling_v3"", ""project"": ""allegro_training_study_1"", ""save_dir"": ""results/phase2_rare_sampling_v3""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""forces_mse""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03164488944631, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.783765071055388, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_training_study_1,0.3919468892365347,,,,,0.6307754692877475,0.9009009009009008,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,125603.0,,,,,,0.01563691644361759,,,0.0028981293052508586,0.004874293683429087,,,0.17639288248464466,0.009009009009009007,0.0049543067344558845,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03164488944631, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.783765071055388, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 112996},0.1977256605558108,,0.011466195216281646,,,0.5178576593863153,,,,,,,,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.035661224671134716,0.01767367342180296,,0.09009009009009009,,,0.2003795816695424,,allegro_training_study_1/phase2_rare_sampling_v3,5.0,2.0,2.0,float32,42.0,32.03164488944631,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/phase2_rare_sampling_v3_train.xyz,data/phase2_rare_sampling_v3_val.xyz,data/phase2_rare_sampling_v3_test.xyz,2758c87a,train:data/phase2_rare_sampling_v3_train.xyz|val:data/phase2_rare_sampling_v3_val.xyz|test:data/phase2_rare_sampling_v3_test.xyz,per_atom_energy_mse(coeff=1)|forces_mse(coeff=10)|stress_mse(coeff=100),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,400.0,400.0
44,allegro_training_study_1,phase3_large_batch,96205.830949607,14643.0,1750960753.412339,{'runtime': 96206},400.0,,0.009009009009009007,0.9009009009009008,1e-06,0.24154554067200443,0.4593586741804424,0.0846011724611128,0.2320605028906053,0.006548030028281246,0.015540676324285206,0.23565328446511097,,0.7377552172857363,0.0181968459549426,0.04390459359376742,,0.009778334991803108,0.00018288004684756964,0.017623405308970164,67200.0,0.23650114229756575,0.872203008963281,0.08593982692186027,0.24087103840520857,0.006619466441852919,0.02135354346546678,0.3781425302779854,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 8, ""num_workers"": 8}, ""test_file_path"": ""data/phase3_large_batch_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 8, ""num_workers"": 8}, ""train_file_path"": ""data/phase3_large_batch_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 8, ""num_workers"": 8}, ""val_file_path"": ""data/phase3_large_batch_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""accumulate_grad_batches"": 4, ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/phase3_large_batch"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""phase3_large_batch"", ""project"": ""allegro_training_study_1"", ""save_dir"": ""results/phase3_large_batch_b32""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""forces_mse""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.031644889446376, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.783765071055344, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""forces_mse""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.031644889446376, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.783765071055344, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.09009009009009009,0.23159700761281876,0.19281316496191284,,,,,,,0.23650114229756575,,,,,,,,,0.017623405308970164,,0.0846011724611128,,67200.0,0.24154554067200443,,,,0.00018288004684756964,,,,0.08593982692186027,,0.3781425302779854,,0.24087103840520857,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""forces_mse""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",400.0,,,,96205.830949607,,,,,,,,,,,1e-06,,,,,,0.19281316496191284,1750960753.412339,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 8, ""num_workers"": 8}, ""test_file_path"": ""data/phase3_large_batch_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 8, ""num_workers"": 8}, ""train_file_path"": ""data/phase3_large_batch_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 8, ""num_workers"": 8}, ""val_file_path"": ""data/phase3_large_batch_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""accumulate_grad_batches"": 4, ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/phase3_large_batch"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""phase3_large_batch"", ""project"": ""allegro_training_study_1"", ""save_dir"": ""results/phase3_large_batch_b32""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""forces_mse""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.031644889446376, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.783765071055344, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_training_study_1,0.4593586741804424,,,,,0.7377552172857363,0.9009009009009008,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,14643.0,,,,,,0.0181968459549426,,,0.009778334991803108,0.006548030028281246,,,0.23159700761281876,0.009009009009009007,0.006619466441852919,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.031644889446376, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.783765071055344, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 96206},0.2320605028906053,,0.015540676324285206,,,0.872203008963281,,,,,,,,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.04390459359376742,0.02135354346546678,,0.09009009009009009,,,0.23565328446511097,,allegro_training_study_1/phase3_large_batch,5.0,2.0,2.0,float32,42.0,32.031644889446376,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/phase3_large_batch_train.xyz,data/phase3_large_batch_val.xyz,data/phase3_large_batch_test.xyz,396d1d7e,train:data/phase3_large_batch_train.xyz|val:data/phase3_large_batch_val.xyz|test:data/phase3_large_batch_test.xyz,per_atom_energy_mse(coeff=1)|forces_mse(coeff=10)|stress_mse(coeff=100),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,400.0,400.0
45,allegro_training_study_1,phase4_integrated_final,101040.35585108,30163.0,1751062777.7366235,{'runtime': 101041},400.0,,,,1e-06,0.17861208177176768,0.33238989845455397,0.04849324472489977,0.18203025785558424,0.0036482309432151034,0.008137859437186467,0.1741860052491082,,,,0.004511856978685438,,,,0.0020428436177215995,144800.0,0.17582870753651825,1.042823347533821,0.05349096783776589,0.2391534926094549,0.003730057801124701,0.013244682446463967,0.43174050752991344,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [14161, 6877, 4353, 4354, 4355, 1409, 4362, 4363, 4364, 1418, 4371, 4372, 4373, 1495, 4380, 4381, 4382, 14202, 4389, 4390, 4391, 15589, 4398, 4399, 4400, 15618, 4407, 4408, 4409, 15690, 4416, 4417, 4418, 15832, 4425, 4426, 4427, 16094, 4434, 4435, 4436, 16246, 4443, 4444, 4445, 17419, 4452, 4453, 4454, 17420, 4462, 4463, 4464, 17434, 4470, 4471, 4472, 705, 4479, 4480, 4481, 713, 4488, 4489, 4490, 839, 4498, 4499, 4500, 982, 4506, 4507, 25633, 14296, 14302, 25648, 25651, 14310, 25654, 25656, 14314, 25658, 14316, 25662, 14320, 25669, 25670, 14324, 14325, 25676, 14327, 14331, 14335, 14337, 14338, 14340, 25695, 25697, 14342, 14343, 25701, 14345, 25707, 25712, 14353, 25714, 25716, 14356, 25719, 14359, 25722, 14360, 25723, 23927, 23929, 23931, 14362, 23933, 23935, 25729, 23940, 23942, 25733, 23943, 14368, 23945, 14370, 14372, 25742, 25744, 14376, 25747, 24104, 24105, 24107, 24108, 24109, 24110, 7495, 24111, 24112, 24113, 24114, 7504, 7511, 7520, 24115, 19915, 10547, 25973, 24317, 24318, 24319, 24320, 24321, 24322, 24324, 24325, 24326, 24327, 24328, 24329, 7623, 24330, 24331, 24332, 24333, 24334, 24335, 24336, 24337, 7631, 7639, 7647, 25996, 7655, 7663, 7672, 7679, 7687, 7696, 7703, 7712, 24338, 24339, 24340, 24341, 24342, 24343, 14562, 24344, 24345, 24346, 24347, 24348, 7719, 7727, 24349, 7735, 7743, 24350, 14569, 26016, 24506, 24513, 26130, 14678, 26167, 26172, 26177, 14691, 14692, 14695, 26184, 26185, 14697, 14700, 26191, 14704, 14707, 26205, 26214, 14718, 26223, 14731, 24789, 26239, 26240, 14736, 24792, 24793, 24794, 24795, 24796, 26270, 2095, 14764, 26282, 26283, 14768, 26286, 14769, 14770, 26288, 14771, 26290, 14772, 26292, 14774, 14777, 14778, 14779, 14780, 14782, 26306, 14783, 14785, 26310, 14787, 26313, 14788, 14790, 14791, 26318, 14792, 14795, 26323, 14796, 14797, 14798, 14805, 14809, 14810, 14811, 26348, 14813, 14815, 26351, 26354, 26359, 26366, 26370, 26381, 26382, 14840, 26387, 5546, 26453, 14888, 26454, 14890, 26456, 14891, 14893, 14895, 26463, 14896, 26466, 14899, 26471, 26475, 26478, 14909, 14910, 14913, 26489, 14919, 26499, 14921, 26501, 14923, 14924, 26508, 14927, 14928, 26510, 14929, 26517, 26524, 14939, 26528, 26531, 26535, 26552, 14960, 26559, 26564, 3285, 14972, 26572, 26573, 26582, 14984, 14985, 14986, 5735, 26594, 14991, 14992, 26601, 14994, 26605, 14998, 26608, 26611, 15002, 15005, 26617, 15006, 26622, 15009, 15010, 15011, 26626, 26627, 15015, 26636, 26638, 26639, 15021, 26640, 26641, 26646, 15027, 26652, 26653, 26657, 15033, 26662, 26667, 15044, 26673, 26681, 15053, 26774, 75, 95, 100, 3827, 170, 15265, 25021, 191, 192, 25022, 15272, 194, 25023, 15274, 198, 25024, 199, 15278, 25025, 15279, 204, 205, 25026, 208, 25027, 15284, 25028, 215, 25029, 15289, 25030, 220, 25031, 25032, 25033, 25034, 15301, 25035, 235, 15302, 237, 15304, 15305, 25036, 15306, 25037, 242, 25038, 15309, 15310, 247, 25039, 248, 25040, 25041, 25042, 25043, 25044, 25045, 25046, 25047, 25048, 25049, 25050, 25051, 25052, 25053, 25054, 25055, 25056, 25057, 25058, 25059, 25060, 25061, 25062, 25063, 25064, 25065, 25066, 25067, 25068, 25069, 25070, 11560, 25071, 25072, 25073, 25074, 25075, 25076, 25077, 25078, 15401, 25079, 430, 15442, 15443, 433, 15444, 439, 447, 25102, 456, 458, 471, 475, 15474, 481, 15478, 484, 486, 524, 577, 4457, 4511, 776, 4851, 6991, 25275, 12245, 12246, 25418, 1125, 25332, 17991, 25343, 7335, 25344, 12455, 12456, 12457, 12458, 12459, 12460, 12461, 12462, 12463, 12464, 12465, 25345, 12538, 12539, 12542, 12543, 12544, 12545, 12546, 25366, 25367, 12681, 12682, 12683, 12684, 12685, 12686, 12641, 12642, 12532, 12540, 12687, 12688, 12689, 12690, 12691, 12692, 12693, 25391, 25415, 12164, 12171, 12206, 12220, 12228, 12229, 12330, 12331, 12332, 12333, 12334, 12339, 12547, 12548, 12549, 12551, 12552, 12553, 12557, 12563, 12564, 12566, 12567, 12571, 12574, 12576, 12579, 12580, 12581, 25420, 25421, 12592, 12593, 12595, 12598, 12599, 12600, 12601, 12603, 12604, 12608, 12609, 12610, 12613, 12614, 12616, 12617, 12618, 12619, 12620, 12622, 12623, 12624, 12628, 12629, 12631, 12632, 12633, 12634, 12638, 12639, 12640, 12643, 12644, 12645, 12650, 12651, 12654, 12655, 12658, 12659, 12660, 12666, 25429, 13023, 13024, 13027, 13028, 13031, 13032, 13034, 13038, 13039, 13041, 13042, 13045, 13046, 13049, 13052, 13058, 13059, 13061, 13062, 13066, 13067, 13070, 13073, 13074, 13077, 13078, 13079, 13082, 13083, 13444, 13445, 13447, 13451, 13461, 13462, 13469, 13470, 13471, 13472, 13473, 13474, 13477, 13478, 13483, 13484, 13489, 12959, 13490, 13492, 13493, 13495, 13496, 13497, 13498, 13500, 13504, 13509, 13510, 13512, 13513, 13514, 13518, 13521, 13525, 13526, 13527, 13528, 13529, 13532, 13538, 13539, 13549, 13550, 13551, 13554, 13556, 13557, 13559, 13563, 13566, 13574, 13575, 13570, 13582, 13583, 13588, 25446, 13598, 13006, 13007, 13008, 13009, 13010, 25580, 1558, 1565, 13098, 13099, 13100, 25699, 13101, 13102, 13103, 13104, 12997, 13105, 13106, 25727, 13107, 13108, 13109, 13110, 13111, 13013, 13014, 13113, 13114, 13112, 13012, 1593, 1099, 1632, 1650, 13216, 13217, 13227, 13228, 13229, 13230, 13231, 13232, 13233, 1669, 13234, 13235, 13236, 13237, 13238, 13239, 13240, 13249, 13252, 1693, 26392, 1777, 1781, 24787, 13422, 13423, 13424, 13425, 13426, 13427, 13428, 13429, 13430, 13431, 13432, 13433, 13435, 13436, 24797, 24798, 24799, 24800, 24801, 24802, 24803, 24804, 24807, 24808, 24809, 24810, 24811, 24812, 24813, 24814, 24815, 24816, 24817, 24818, 24819, 24820, 24822, 24823, 24825, 24826, 24827, 24829, 24830, 24831, 24832, 24833, 24834, 24835, 24836, 24837, 24838, 24840, 24841, 24843, 24845, 24846, 24847, 24848, 24853, 24855, 24856, 24860, 24861, 24862, 24863, 24864, 24866, 24867, 24868, 24870, 24871, 24872, 24873, 24874, 24875, 24877, 24878, 24880, 24883, 24884, 24885, 24886, 24887, 8032, 24889, 24890, 24891, 24892, 24893, 24894, 24895, 24897, 24898, 24899, 24900, 24902, 24903, 24904, 24905, 24906, 24908, 24909, 24911, 24914, 24915, 24916, 24917, 24918, 24921, 24922, 24923, 24926, 24927, 24928, 24930, 24931, 24934, 24935, 24937, 24938, 24939, 24940, 24941, 24942, 24943, 24944, 24945, 24946, 24947, 24948, 24949, 24950, 24951, 24952, 24953, 24954, 24955, 24956, 24957, 24958, 24959, 24960, 24961, 24962, 24963, 24964, 24965, 24966, 24967, 24968, 24969, 24970, 24971, 24972, 24973, 24974, 24975, 24976, 24977, 24978, 24979, 24980, 24981, 24982, 24983, 24984, 24985, 24986, 24987, 24988, 24989, 24990, 24991, 24992, 24993, 24994, 24995, 24996, 24997, 24998, 24999, 18482, 25000, 25001, 25002, 25003, 25004, 25005, 25006, 25007, 25008, 25009, 25010, 25011, 25012, 25013, 25014, 25015, 25016, 25017, 25018, 25019, 25020, 13664, 13665, 13680, 13681, 13682, 13683, 13684, 13685, 13686, 13687, 13688, 13689, 13690, 13691, 13692, 13693, 13694, 13695, 13696, 13697, 13698, 13699, 13700, 13702, 13703, 13704, 13705, 13706, 13707, 13708, 13709, 13701, 13710, 13711, 13712, 13713, 13714, 13715, 13716, 13717, 13718, 13719, 13720, 13721, 13722, 13723, 13724, 13725, 13726, 13727, 13728, 13731, 13732, 13733, 13734, 13735, 13736, 13737, 13738, 13739, 13740, 13741, 13729, 13730, 13742, 13743, 13744, 25080, 25081, 25082, 25083, 25084, 25085, 25086, 25087, 25088, 25089, 25090, 25091, 25092, 25093, 25094, 25095, 25096, 25097, 25098, 25099, 25100, 25101, 8173, 25103, 25104, 25105, 25106, 25107, 25108, 25109, 25110, 25111, 25112, 25113, 25114, 25115, 25116, 25117, 25118, 25119, 25120, 25121, 25122, 25123, 25124, 25125, 25126, 25127, 25128, 25129, 25130, 25131, 25132, 25133, 25134, 25135, 25136, 25137, 25138, 25139, 25140, 25141, 25142, 25143, 25144, 25145, 25146, 25147, 25148, 25149, 25150, 25151, 25152, 25153, 25154, 25155, 25156, 25157, 25158, 25159, 25160, 25161, 25162, 25163, 25164, 25165, 25166, 25167, 25168, 25169, 25170, 25171, 25172, 25173, 25174, 25175, 25176, 25177, 25178, 25179, 25180, 25181, 25182, 25183, 25184, 25185, 25186, 25187, 25188, 25189, 25190, 25191, 25192, 25193, 25194, 25195, 25196, 25197, 25198, 25199, 25200, 25201, 25202, 25203, 25204, 25205, 25206, 25207, 25208, 25209, 25210, 25211, 25212, 25213, 25214, 25215, 25216, 25217, 25218, 25219, 25220, 25221, 25222, 25223, 25224, 25225, 25226, 25227, 25228, 25229, 25230, 25231, 25232, 25233, 25234, 25235, 25236, 25237, 25238, 25239, 25240, 25241, 25242, 25243, 25244, 25245, 25246, 25247, 25248, 25249, 25250, 25251, 25252, 25253, 25254, 25255, 25256, 25257, 25258, 25259, 25260, 25261, 25262, 25263, 25264, 25265, 25266, 25267, 25268, 25269, 25270, 25271, 25272, 25273, 25274, 8283, 25276, 25277, 25278, 25279, 25280, 25281, 25282, 25283, 25284, 25285, 25286, 25287, 25288, 25289, 25290, 25291, 25292, 25293, 25294, 25295, 25296, 25297, 25298, 25299, 25300, 25301, 25302, 25303, 25304, 25305, 25306, 25307, 25308, 25309, 25310, 25311, 25312, 25313, 25314, 25315, 25316, 25317, 25318, 25319, 25320, 25321, 25322, 25323, 25324, 25325, 25326, 25327, 25328, 25329, 25330, 25331, 2140, 25333, 25334, 25335, 25336, 25337, 25338, 25339, 25340, 25341, 25342, 18632, 2148, 16357, 25346, 25347, 25348, 25349, 25350, 25351, 25352, 25353, 25354, 25355, 25356, 25357, 25358, 25359, 25360, 25361, 25362, 25363, 25364, 25365, 2162, 16367, 25368, 25369, 25370, 25371, 25372, 25373, 25374, 25375, 25376, 25377, 25378, 25379, 25380, 25381, 25382, 25383, 25384, 25385, 25386, 25387, 25388, 25389, 25390, 2178, 25392, 25393, 25394, 25395, 25396, 25397, 25398, 25399, 25400, 25401, 25402, 25403, 25404, 25405, 25406, 25407, 25408, 25409, 25410, 25411, 25412, 25413, 25414, 25416, 2195, 25419, 25422, 25423, 25424, 16393, 25426, 25427, 25428, 2202, 25430, 25431, 25432, 16397, 2205, 2206, 25436, 25437, 25438, 25439, 25440, 25441, 25442, 25443, 25444, 25445, 2213, 25447, 2216, 14107, 2219, 2223, 25417, 14117, 16412, 16415, 14127, 14128, 16418, 16419, 14132, 14134, 2237, 14137, 14138, 14139, 14140, 14141, 14142, 14143, 14144, 16423, 14145, 14147, 2244, 16426, 14150, 14151, 2246, 16427, 14146, 14148, 14149, 14152, 16431, 2260, 2265, 21669, 16442, 2272, 4006, 2273, 2276, 2279, 2281, 2282, 2288, 2289, 16458, 16459, 21708, 21709, 21710, 4486, 4495, 4497, 9678, 16465, 2302, 16467, 16469, 16470, 2308, 21726, 9703, 9710, 9718, 9726, 9734, 16475, 9742, 9750, 9759, 21727, 21728, 21729, 21730, 21731, 21732, 21733, 21734, 21735, 21736, 21737, 9767, 9774, 9782, 9790, 9801, 21745, 21747, 21753, 9815, 18755, 21767, 21768, 21779, 25425, 21787, 21790, 21798, 21803, 21824, 21826, 21840, 21862, 21876, 21879, 11441, 21881, 21883, 21893, 21902, 21906, 8631, 21938, 21963, 25433, 21973, 21974, 21976, 2486, 21984, 21990, 25434, 22003, 22007, 22012, 22018, 22021, 22023, 11628, 25435, 16618, 21986, 22037, 22041, 22056, 16638, 22070, 22071, 2548, 16644, 2554, 22100, 22109, 22116, 22093, 22127, 2608, 17920, 16698, 22186, 22194, 22210, 683, 22254, 22266, 18028, 8888, 22337, 22341, 22342, 22348, 22360, 22365, 18171, 18232, 22386, 18255, 22393, 22410, 16815, 22420, 22428, 22430, 22431, 22435, 22442, 22456, 22474, 22493, 22507, 22522, 22523, 22524, 22525, 22526, 22527, 22528, 22529, 22530, 22531, 22469, 22492, 22505, 22513, 16871, 4618, 5180, 5188, 5196, 5204, 16873, 5214, 5220, 5229, 5236, 5244, 5252, 16877, 2876, 16878, 2877, 2878, 16880, 16886, 16887, 16888, 16896, 5629, 16897, 2903, 16898, 5660, 2906, 16902, 16904, 2915, 2918, 16908, 16911, 3050, 3057, 19116, 9271, 17048, 3121, 3128, 3133, 3134, 17065, 17071, 3147, 3155, 3157, 3163, 17132, 3235, 17137, 17138, 17140, 17142, 17144, 3248, 17149, 3253, 3255, 17152, 17156, 3267, 3269, 17161, 17162, 17164, 3277, 20248, 20256, 20271, 20279, 20287, 20295, 20319, 20327, 20328, 20335, 20343, 3310, 3328, 9565, 19370, 23028, 23029, 23030, 23031, 23032, 23033, 23034, 23035, 23036, 23037, 23038, 23039, 23040, 23041, 23042, 6365, 23043, 23044, 23045, 23046, 6677, 23302, 23303, 23304, 23305, 6581, 6589, 6597, 6605, 6613, 6621, 6629, 6637, 6645, 23306, 23307, 23308, 23309, 23310, 23311, 23312, 23313, 23314, 23315, 19513, 6653, 6662, 23316, 23317, 23319, 23318, 23320, 6669, 23321, 23323, 23324, 23322, 23326, 23325, 23329, 23327, 23330, 23332, 23333, 23331, 23334, 23337, 23338, 23339, 23340, 23342, 23335, 23343, 23344, 23347, 23348, 23345, 23351, 23352, 23353, 23346, 23355, 23349, 23350, 23358, 23359, 23354, 23356, 23357, 23360, 23361, 19550, 17390, 3900, 3901, 3902, 17391, 3909, 17392, 3910, 17393, 3916, 3917, 3918, 17394, 3926, 17395, 3927, 17360, 3933, 17396, 3934, 17397, 3940, 3941, 3942, 17398, 3947, 3948, 3949, 17399, 3956, 9957, 23457, 6116, 6124, 6132, 6140, 6148, 6157, 6164, 6173, 6181, 6189, 6197, 6205, 6213, 6221, 6229, 6236, 6245, 6252], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/phase4_integrated_final_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/phase4_integrated_final_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/phase4_integrated_final_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""accumulate_grad_batches"": 4, ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/phase4_integrated_final"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""phase4_integrated_final"", ""project"": ""allegro_training_study_1"", ""save_dir"": ""results/phase4_integrated_final""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""per_atom_energy_huber""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""forces_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""stress_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03164488944631, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.783765071055388, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""per_atom_energy_huber""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""forces_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""stress_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03164488944631, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.783765071055388, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.09009009009009009,0.9009009009009008,0.04019842395963296,0.019578681341588876,0.0007925320369616519,0.022345101393229535,0.0011359585301584925,2.168669104643733e-05,,,,0.009009009009009007,,,,,,0.17582870753651825,,,,,,,,,0.0020428436177215995,,0.04849324472489977,,144800.0,0.17861208177176768,,,,,,,,0.05349096783776589,,0.43174050752991344,,0.2391534926094549,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""per_atom_energy_huber""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""forces_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""stress_huber""}]}",400.0,,0.04019842395963296,0.0007925320369616519,101040.35585108,0.019578681341588876,,,,,,0.022345101393229535,,,,1e-06,,,,,,,1751062777.7366235,,0.0011359585301584925,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [14161, 6877, 4353, 4354, 4355, 1409, 4362, 4363, 4364, 1418, 4371, 4372, 4373, 1495, 4380, 4381, 4382, 14202, 4389, 4390, 4391, 15589, 4398, 4399, 4400, 15618, 4407, 4408, 4409, 15690, 4416, 4417, 4418, 15832, 4425, 4426, 4427, 16094, 4434, 4435, 4436, 16246, 4443, 4444, 4445, 17419, 4452, 4453, 4454, 17420, 4462, 4463, 4464, 17434, 4470, 4471, 4472, 705, 4479, 4480, 4481, 713, 4488, 4489, 4490, 839, 4498, 4499, 4500, 982, 4506, 4507, 25633, 14296, 14302, 25648, 25651, 14310, 25654, 25656, 14314, 25658, 14316, 25662, 14320, 25669, 25670, 14324, 14325, 25676, 14327, 14331, 14335, 14337, 14338, 14340, 25695, 25697, 14342, 14343, 25701, 14345, 25707, 25712, 14353, 25714, 25716, 14356, 25719, 14359, 25722, 14360, 25723, 23927, 23929, 23931, 14362, 23933, 23935, 25729, 23940, 23942, 25733, 23943, 14368, 23945, 14370, 14372, 25742, 25744, 14376, 25747, 24104, 24105, 24107, 24108, 24109, 24110, 7495, 24111, 24112, 24113, 24114, 7504, 7511, 7520, 24115, 19915, 10547, 25973, 24317, 24318, 24319, 24320, 24321, 24322, 24324, 24325, 24326, 24327, 24328, 24329, 7623, 24330, 24331, 24332, 24333, 24334, 24335, 24336, 24337, 7631, 7639, 7647, 25996, 7655, 7663, 7672, 7679, 7687, 7696, 7703, 7712, 24338, 24339, 24340, 24341, 24342, 24343, 14562, 24344, 24345, 24346, 24347, 24348, 7719, 7727, 24349, 7735, 7743, 24350, 14569, 26016, 24506, 24513, 26130, 14678, 26167, 26172, 26177, 14691, 14692, 14695, 26184, 26185, 14697, 14700, 26191, 14704, 14707, 26205, 26214, 14718, 26223, 14731, 24789, 26239, 26240, 14736, 24792, 24793, 24794, 24795, 24796, 26270, 2095, 14764, 26282, 26283, 14768, 26286, 14769, 14770, 26288, 14771, 26290, 14772, 26292, 14774, 14777, 14778, 14779, 14780, 14782, 26306, 14783, 14785, 26310, 14787, 26313, 14788, 14790, 14791, 26318, 14792, 14795, 26323, 14796, 14797, 14798, 14805, 14809, 14810, 14811, 26348, 14813, 14815, 26351, 26354, 26359, 26366, 26370, 26381, 26382, 14840, 26387, 5546, 26453, 14888, 26454, 14890, 26456, 14891, 14893, 14895, 26463, 14896, 26466, 14899, 26471, 26475, 26478, 14909, 14910, 14913, 26489, 14919, 26499, 14921, 26501, 14923, 14924, 26508, 14927, 14928, 26510, 14929, 26517, 26524, 14939, 26528, 26531, 26535, 26552, 14960, 26559, 26564, 3285, 14972, 26572, 26573, 26582, 14984, 14985, 14986, 5735, 26594, 14991, 14992, 26601, 14994, 26605, 14998, 26608, 26611, 15002, 15005, 26617, 15006, 26622, 15009, 15010, 15011, 26626, 26627, 15015, 26636, 26638, 26639, 15021, 26640, 26641, 26646, 15027, 26652, 26653, 26657, 15033, 26662, 26667, 15044, 26673, 26681, 15053, 26774, 75, 95, 100, 3827, 170, 15265, 25021, 191, 192, 25022, 15272, 194, 25023, 15274, 198, 25024, 199, 15278, 25025, 15279, 204, 205, 25026, 208, 25027, 15284, 25028, 215, 25029, 15289, 25030, 220, 25031, 25032, 25033, 25034, 15301, 25035, 235, 15302, 237, 15304, 15305, 25036, 15306, 25037, 242, 25038, 15309, 15310, 247, 25039, 248, 25040, 25041, 25042, 25043, 25044, 25045, 25046, 25047, 25048, 25049, 25050, 25051, 25052, 25053, 25054, 25055, 25056, 25057, 25058, 25059, 25060, 25061, 25062, 25063, 25064, 25065, 25066, 25067, 25068, 25069, 25070, 11560, 25071, 25072, 25073, 25074, 25075, 25076, 25077, 25078, 15401, 25079, 430, 15442, 15443, 433, 15444, 439, 447, 25102, 456, 458, 471, 475, 15474, 481, 15478, 484, 486, 524, 577, 4457, 4511, 776, 4851, 6991, 25275, 12245, 12246, 25418, 1125, 25332, 17991, 25343, 7335, 25344, 12455, 12456, 12457, 12458, 12459, 12460, 12461, 12462, 12463, 12464, 12465, 25345, 12538, 12539, 12542, 12543, 12544, 12545, 12546, 25366, 25367, 12681, 12682, 12683, 12684, 12685, 12686, 12641, 12642, 12532, 12540, 12687, 12688, 12689, 12690, 12691, 12692, 12693, 25391, 25415, 12164, 12171, 12206, 12220, 12228, 12229, 12330, 12331, 12332, 12333, 12334, 12339, 12547, 12548, 12549, 12551, 12552, 12553, 12557, 12563, 12564, 12566, 12567, 12571, 12574, 12576, 12579, 12580, 12581, 25420, 25421, 12592, 12593, 12595, 12598, 12599, 12600, 12601, 12603, 12604, 12608, 12609, 12610, 12613, 12614, 12616, 12617, 12618, 12619, 12620, 12622, 12623, 12624, 12628, 12629, 12631, 12632, 12633, 12634, 12638, 12639, 12640, 12643, 12644, 12645, 12650, 12651, 12654, 12655, 12658, 12659, 12660, 12666, 25429, 13023, 13024, 13027, 13028, 13031, 13032, 13034, 13038, 13039, 13041, 13042, 13045, 13046, 13049, 13052, 13058, 13059, 13061, 13062, 13066, 13067, 13070, 13073, 13074, 13077, 13078, 13079, 13082, 13083, 13444, 13445, 13447, 13451, 13461, 13462, 13469, 13470, 13471, 13472, 13473, 13474, 13477, 13478, 13483, 13484, 13489, 12959, 13490, 13492, 13493, 13495, 13496, 13497, 13498, 13500, 13504, 13509, 13510, 13512, 13513, 13514, 13518, 13521, 13525, 13526, 13527, 13528, 13529, 13532, 13538, 13539, 13549, 13550, 13551, 13554, 13556, 13557, 13559, 13563, 13566, 13574, 13575, 13570, 13582, 13583, 13588, 25446, 13598, 13006, 13007, 13008, 13009, 13010, 25580, 1558, 1565, 13098, 13099, 13100, 25699, 13101, 13102, 13103, 13104, 12997, 13105, 13106, 25727, 13107, 13108, 13109, 13110, 13111, 13013, 13014, 13113, 13114, 13112, 13012, 1593, 1099, 1632, 1650, 13216, 13217, 13227, 13228, 13229, 13230, 13231, 13232, 13233, 1669, 13234, 13235, 13236, 13237, 13238, 13239, 13240, 13249, 13252, 1693, 26392, 1777, 1781, 24787, 13422, 13423, 13424, 13425, 13426, 13427, 13428, 13429, 13430, 13431, 13432, 13433, 13435, 13436, 24797, 24798, 24799, 24800, 24801, 24802, 24803, 24804, 24807, 24808, 24809, 24810, 24811, 24812, 24813, 24814, 24815, 24816, 24817, 24818, 24819, 24820, 24822, 24823, 24825, 24826, 24827, 24829, 24830, 24831, 24832, 24833, 24834, 24835, 24836, 24837, 24838, 24840, 24841, 24843, 24845, 24846, 24847, 24848, 24853, 24855, 24856, 24860, 24861, 24862, 24863, 24864, 24866, 24867, 24868, 24870, 24871, 24872, 24873, 24874, 24875, 24877, 24878, 24880, 24883, 24884, 24885, 24886, 24887, 8032, 24889, 24890, 24891, 24892, 24893, 24894, 24895, 24897, 24898, 24899, 24900, 24902, 24903, 24904, 24905, 24906, 24908, 24909, 24911, 24914, 24915, 24916, 24917, 24918, 24921, 24922, 24923, 24926, 24927, 24928, 24930, 24931, 24934, 24935, 24937, 24938, 24939, 24940, 24941, 24942, 24943, 24944, 24945, 24946, 24947, 24948, 24949, 24950, 24951, 24952, 24953, 24954, 24955, 24956, 24957, 24958, 24959, 24960, 24961, 24962, 24963, 24964, 24965, 24966, 24967, 24968, 24969, 24970, 24971, 24972, 24973, 24974, 24975, 24976, 24977, 24978, 24979, 24980, 24981, 24982, 24983, 24984, 24985, 24986, 24987, 24988, 24989, 24990, 24991, 24992, 24993, 24994, 24995, 24996, 24997, 24998, 24999, 18482, 25000, 25001, 25002, 25003, 25004, 25005, 25006, 25007, 25008, 25009, 25010, 25011, 25012, 25013, 25014, 25015, 25016, 25017, 25018, 25019, 25020, 13664, 13665, 13680, 13681, 13682, 13683, 13684, 13685, 13686, 13687, 13688, 13689, 13690, 13691, 13692, 13693, 13694, 13695, 13696, 13697, 13698, 13699, 13700, 13702, 13703, 13704, 13705, 13706, 13707, 13708, 13709, 13701, 13710, 13711, 13712, 13713, 13714, 13715, 13716, 13717, 13718, 13719, 13720, 13721, 13722, 13723, 13724, 13725, 13726, 13727, 13728, 13731, 13732, 13733, 13734, 13735, 13736, 13737, 13738, 13739, 13740, 13741, 13729, 13730, 13742, 13743, 13744, 25080, 25081, 25082, 25083, 25084, 25085, 25086, 25087, 25088, 25089, 25090, 25091, 25092, 25093, 25094, 25095, 25096, 25097, 25098, 25099, 25100, 25101, 8173, 25103, 25104, 25105, 25106, 25107, 25108, 25109, 25110, 25111, 25112, 25113, 25114, 25115, 25116, 25117, 25118, 25119, 25120, 25121, 25122, 25123, 25124, 25125, 25126, 25127, 25128, 25129, 25130, 25131, 25132, 25133, 25134, 25135, 25136, 25137, 25138, 25139, 25140, 25141, 25142, 25143, 25144, 25145, 25146, 25147, 25148, 25149, 25150, 25151, 25152, 25153, 25154, 25155, 25156, 25157, 25158, 25159, 25160, 25161, 25162, 25163, 25164, 25165, 25166, 25167, 25168, 25169, 25170, 25171, 25172, 25173, 25174, 25175, 25176, 25177, 25178, 25179, 25180, 25181, 25182, 25183, 25184, 25185, 25186, 25187, 25188, 25189, 25190, 25191, 25192, 25193, 25194, 25195, 25196, 25197, 25198, 25199, 25200, 25201, 25202, 25203, 25204, 25205, 25206, 25207, 25208, 25209, 25210, 25211, 25212, 25213, 25214, 25215, 25216, 25217, 25218, 25219, 25220, 25221, 25222, 25223, 25224, 25225, 25226, 25227, 25228, 25229, 25230, 25231, 25232, 25233, 25234, 25235, 25236, 25237, 25238, 25239, 25240, 25241, 25242, 25243, 25244, 25245, 25246, 25247, 25248, 25249, 25250, 25251, 25252, 25253, 25254, 25255, 25256, 25257, 25258, 25259, 25260, 25261, 25262, 25263, 25264, 25265, 25266, 25267, 25268, 25269, 25270, 25271, 25272, 25273, 25274, 8283, 25276, 25277, 25278, 25279, 25280, 25281, 25282, 25283, 25284, 25285, 25286, 25287, 25288, 25289, 25290, 25291, 25292, 25293, 25294, 25295, 25296, 25297, 25298, 25299, 25300, 25301, 25302, 25303, 25304, 25305, 25306, 25307, 25308, 25309, 25310, 25311, 25312, 25313, 25314, 25315, 25316, 25317, 25318, 25319, 25320, 25321, 25322, 25323, 25324, 25325, 25326, 25327, 25328, 25329, 25330, 25331, 2140, 25333, 25334, 25335, 25336, 25337, 25338, 25339, 25340, 25341, 25342, 18632, 2148, 16357, 25346, 25347, 25348, 25349, 25350, 25351, 25352, 25353, 25354, 25355, 25356, 25357, 25358, 25359, 25360, 25361, 25362, 25363, 25364, 25365, 2162, 16367, 25368, 25369, 25370, 25371, 25372, 25373, 25374, 25375, 25376, 25377, 25378, 25379, 25380, 25381, 25382, 25383, 25384, 25385, 25386, 25387, 25388, 25389, 25390, 2178, 25392, 25393, 25394, 25395, 25396, 25397, 25398, 25399, 25400, 25401, 25402, 25403, 25404, 25405, 25406, 25407, 25408, 25409, 25410, 25411, 25412, 25413, 25414, 25416, 2195, 25419, 25422, 25423, 25424, 16393, 25426, 25427, 25428, 2202, 25430, 25431, 25432, 16397, 2205, 2206, 25436, 25437, 25438, 25439, 25440, 25441, 25442, 25443, 25444, 25445, 2213, 25447, 2216, 14107, 2219, 2223, 25417, 14117, 16412, 16415, 14127, 14128, 16418, 16419, 14132, 14134, 2237, 14137, 14138, 14139, 14140, 14141, 14142, 14143, 14144, 16423, 14145, 14147, 2244, 16426, 14150, 14151, 2246, 16427, 14146, 14148, 14149, 14152, 16431, 2260, 2265, 21669, 16442, 2272, 4006, 2273, 2276, 2279, 2281, 2282, 2288, 2289, 16458, 16459, 21708, 21709, 21710, 4486, 4495, 4497, 9678, 16465, 2302, 16467, 16469, 16470, 2308, 21726, 9703, 9710, 9718, 9726, 9734, 16475, 9742, 9750, 9759, 21727, 21728, 21729, 21730, 21731, 21732, 21733, 21734, 21735, 21736, 21737, 9767, 9774, 9782, 9790, 9801, 21745, 21747, 21753, 9815, 18755, 21767, 21768, 21779, 25425, 21787, 21790, 21798, 21803, 21824, 21826, 21840, 21862, 21876, 21879, 11441, 21881, 21883, 21893, 21902, 21906, 8631, 21938, 21963, 25433, 21973, 21974, 21976, 2486, 21984, 21990, 25434, 22003, 22007, 22012, 22018, 22021, 22023, 11628, 25435, 16618, 21986, 22037, 22041, 22056, 16638, 22070, 22071, 2548, 16644, 2554, 22100, 22109, 22116, 22093, 22127, 2608, 17920, 16698, 22186, 22194, 22210, 683, 22254, 22266, 18028, 8888, 22337, 22341, 22342, 22348, 22360, 22365, 18171, 18232, 22386, 18255, 22393, 22410, 16815, 22420, 22428, 22430, 22431, 22435, 22442, 22456, 22474, 22493, 22507, 22522, 22523, 22524, 22525, 22526, 22527, 22528, 22529, 22530, 22531, 22469, 22492, 22505, 22513, 16871, 4618, 5180, 5188, 5196, 5204, 16873, 5214, 5220, 5229, 5236, 5244, 5252, 16877, 2876, 16878, 2877, 2878, 16880, 16886, 16887, 16888, 16896, 5629, 16897, 2903, 16898, 5660, 2906, 16902, 16904, 2915, 2918, 16908, 16911, 3050, 3057, 19116, 9271, 17048, 3121, 3128, 3133, 3134, 17065, 17071, 3147, 3155, 3157, 3163, 17132, 3235, 17137, 17138, 17140, 17142, 17144, 3248, 17149, 3253, 3255, 17152, 17156, 3267, 3269, 17161, 17162, 17164, 3277, 20248, 20256, 20271, 20279, 20287, 20295, 20319, 20327, 20328, 20335, 20343, 3310, 3328, 9565, 19370, 23028, 23029, 23030, 23031, 23032, 23033, 23034, 23035, 23036, 23037, 23038, 23039, 23040, 23041, 23042, 6365, 23043, 23044, 23045, 23046, 6677, 23302, 23303, 23304, 23305, 6581, 6589, 6597, 6605, 6613, 6621, 6629, 6637, 6645, 23306, 23307, 23308, 23309, 23310, 23311, 23312, 23313, 23314, 23315, 19513, 6653, 6662, 23316, 23317, 23319, 23318, 23320, 6669, 23321, 23323, 23324, 23322, 23326, 23325, 23329, 23327, 23330, 23332, 23333, 23331, 23334, 23337, 23338, 23339, 23340, 23342, 23335, 23343, 23344, 23347, 23348, 23345, 23351, 23352, 23353, 23346, 23355, 23349, 23350, 23358, 23359, 23354, 23356, 23357, 23360, 23361, 19550, 17390, 3900, 3901, 3902, 17391, 3909, 17392, 3910, 17393, 3916, 3917, 3918, 17394, 3926, 17395, 3927, 17360, 3933, 17396, 3934, 17397, 3940, 3941, 3942, 17398, 3947, 3948, 3949, 17399, 3956, 9957, 23457, 6116, 6124, 6132, 6140, 6148, 6157, 6164, 6173, 6181, 6189, 6197, 6205, 6213, 6221, 6229, 6236, 6245, 6252], ""replica"": 3}, ""seed"": 42, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/phase4_integrated_final_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/phase4_integrated_final_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/phase4_integrated_final_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""accumulate_grad_batches"": 4, ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/phase4_integrated_final"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""phase4_integrated_final"", ""project"": ""allegro_training_study_1"", ""save_dir"": ""results/phase4_integrated_final""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""per_atom_energy_huber""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""forces_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.HuberLoss"", ""delta"": 1}, ""name"": ""stress_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03164488944631, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.783765071055388, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_training_study_1,0.33238989845455397,,,,,,,2.168669104643733e-05,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,0.009009009009009007,,30163.0,,,,,0.09009009009009009,,,,,0.0036482309432151034,,0.9009009009009008,,,0.003730057801124701,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03164488944631, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.783765071055388, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 101041},0.18203025785558424,,0.008137859437186467,,,1.042823347533821,,,,,,,,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.004511856978685438,0.013244682446463967,,,,,0.1741860052491082,,allegro_training_study_1/phase4_integrated_final,5.0,2.0,2.0,float32,42.0,32.03164488944631,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/phase4_integrated_final_train.xyz,data/phase4_integrated_final_val.xyz,data/phase4_integrated_final_test.xyz,ad4f4e61,train:data/phase4_integrated_final_train.xyz|val:data/phase4_integrated_final_val.xyz|test:data/phase4_integrated_final_test.xyz,per_atom_energy_huber(coeff=1)|forces_huber(coeff=10)|stress_huber(coeff=100),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,400.0,400.0
46,allegro_huber_loss_study_no_dimers_no_sr_no_val_b,base_huber_q0.75_rare_sampling,21957.0,117163.0,1751443241.361758,{'runtime': 21957},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.0005,0.10700740559857132,0.20545144909598131,0.019372245099430953,0.023300801262591896,0.002150387585049,0.004879041206476031,0.07787709718834974,0.02206854956930009,0.0008980968466555684,2.5757420097215103e-05,0.003653630549910117,0.03013387800251086,0.0016286238781057815,1.9046378982179095e-05,0.004982290538562677,584300.0,0.10962293467426144,0.2043019471292036,0.019200024670881225,0.023290913727081676,0.0022664556672577427,0.0055653764716371125,0.07771941244264077,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [11120, 18268, 23718, 14354, 14382, 25719, 8853, 21535, 8859, 8860, 8861, 8862, 21536, 8867, 8868, 8869, 21537, 21538, 8874, 8875, 8876, 8881, 8882, 8883, 8888, 8889, 8890, 21541, 8894, 8895, 8896, 8897, 16932, 8901, 8902, 8903, 8904, 16934, 8909, 21545, 8910, 8911, 21546, 8915, 8916, 8917, 8918, 21547, 8922, 8923, 8924, 8925, 21549, 8930, 21550, 8931, 8932, 21552, 8936, 8937, 8938, 5773, 8939, 8943, 8944, 8945, 8946, 21554, 8951, 8952, 8953, 21555, 21556, 21557, 21558, 21559, 8960, 21560, 8966, 21561, 8967, 8968, 21562, 8972, 8973, 8974, 8975, 21563, 8980, 21564, 8981, 8982, 21565, 8986, 8987, 8988, 8989, 17008, 17010, 18402, 16523, 16624, 16626, 16832, 3283, 16850, 18416, 9134, 3293, 16873, 18422, 16881, 5869, 3305, 16886, 3330, 3332, 18448, 3336, 5908, 3342, 22291, 11993, 9145, 3367, 3381, 5953, 3215, 5982, 3334, 17322, 17323, 6010, 17325, 17264, 17326, 17327, 17328, 17329, 17330, 17331, 17332, 17333, 17335, 17336, 17337, 17338, 17339, 17340, 17341, 17342, 17343, 17344, 17345, 17346, 17347, 17348, 17349, 17350, 17351, 17352, 22359, 12101, 14730, 14733, 17386, 23999, 17399, 17409, 6067, 17414, 17415, 6084, 6086, 21765, 18628, 18632, 14843, 6157, 18648, 4229, 9401, 3628, 6198, 6200, 18668, 2536, 2537, 2538, 2539, 18675, 2540, 2375, 3650, 12288, 2444, 2477, 2487, 2521, 2528, 2541, 2542, 2543, 2544, 21825, 2545, 2546, 2547, 2548, 2549, 2550, 2551, 2552, 2553, 2554, 2555, 2556, 2557, 2558, 2559, 2560, 2561, 2562, 2563, 2564, 2565, 2566, 2567, 2568, 2569, 2570, 2571, 2572, 2573, 2574, 2575, 2576, 2577, 2578, 2579, 2580, 2333, 2581, 2582, 2583, 2584, 2585, 2586, 2587, 2588, 2589, 2590, 2591, 2592, 2593, 2594, 3028, 3029, 3691, 3032, 3043, 12343, 3049, 3052, 21539, 21540, 3056, 21869, 3068, 3069, 25486, 21542, 14953, 3079, 3082, 21543, 21544, 3758, 22567, 18784, 18806, 21551, 17871, 17872, 6398, 17873, 17874, 17875, 17876, 3839, 17877, 17878, 17879, 17880, 17881, 17882, 17883, 17884, 17885, 17886, 17887, 17888, 17895, 17896, 17889, 17890, 17900, 17892, 17893, 17894, 3854, 17905, 17898, 17899, 17901, 17911, 17903, 17904, 17906, 17915, 17907, 17908, 17909, 17910, 17912, 17913, 17914, 17916, 17924, 17917, 17918, 17919, 17920, 17921, 17922, 17932, 17934, 17926, 17927, 17928, 17929, 17930, 17931, 17933, 17943, 17944, 17937, 17938, 17939, 17940, 17941, 17951, 17945, 17946, 17947, 17948, 17949, 17959, 17960, 3890, 17953, 17954, 17955, 17965, 17957, 17958, 17961, 17962, 17963, 17964, 17967, 3901, 6512, 12547, 20392, 3917, 3922, 18880, 2988, 6624, 2989, 18889, 2990, 2991, 3947, 2992, 2994, 12594, 2995, 22687, 2998, 18911, 18915, 18916, 9798, 16928, 3982, 16929, 16930, 3003, 16931, 3993, 6557, 4000, 22717, 6565, 4004, 16935, 16936, 16937, 16938, 6579, 20467, 16940, 16941, 16942, 16943, 16944, 16945, 3010, 16946, 16947, 6609, 16948, 16949, 6613, 21548, 3014, 16950, 20493, 16951, 16952, 3017, 16953, 9891, 16954, 20502, 16955, 16956, 16957, 16958, 16959, 3023, 16960, 16961, 20518, 16962, 18996, 4091, 6661, 19001, 4109, 19016, 20542, 19019, 6689, 6691, 4133, 20551, 19033, 19035, 20560, 9993, 20567, 20569, 19045, 20570, 80, 81, 22840, 103, 19070, 4193, 7702, 4216, 142, 19090, 19091, 145, 169, 171, 186, 19111, 4256, 199, 204, 159, 4272, 4287, 4291, 242, 245, 4296, 250, 251, 15444, 19150, 266, 277, 299, 311, 313, 317, 15478, 6913, 328, 19184, 347, 22953, 19193, 274, 21553, 6937, 365, 376, 377, 384, 4399, 385, 396, 6965, 400, 402, 15532, 415, 422, 432, 437, 20764, 442, 446, 455, 471, 7025, 481, 492, 494, 503, 506, 524, 519, 528, 7061, 20813, 20815, 4503, 550, 4520, 4524, 8244, 578, 10439, 4542, 595, 597, 13189, 612, 19336, 619, 13199, 605, 649, 8341, 662, 4595, 673, 19366, 19371, 698, 699, 15711, 8386, 15715, 714, 20910, 19403, 745, 15739, 19412, 8438, 771, 4672, 710, 19423, 791, 795, 796, 799, 820, 821, 20971, 7293, 17891, 9813, 7307, 9821, 9845, 20991, 7313, 7316, 17897, 20997, 7323, 20999, 17902, 10693, 7335, 10696, 21008, 15856, 15859, 17923, 17925, 15926, 13494, 15941, 4869, 19558, 17935, 15961, 17936, 17942, 19580, 23201, 21116, 17950, 17952, 17956, 7515, 8771, 23239, 16046, 5002, 7572, 13981, 7574, 7580, 8830, 8843, 19690, 16135, 7659, 21242, 7670, 16172, 5108, 21256, 21258, 7684, 21261, 7699, 19748, 25223, 20061, 22352, 7762, 21317, 5198, 11204, 19835, 11247, 9196, 19879, 11322, 16384, 23501, 25156, 11471, 23597, 1357, 1402, 1485, 1522, 1588, 1589, 1591, 1592, 1593, 1594, 1595, 1596, 1597, 23622, 1599, 1600, 1601, 1602, 1603, 1604, 1607, 1608, 1609, 1611, 1612, 1614, 1615, 1616, 1617, 1619, 1620, 1622, 1623, 1624, 23634, 1625, 1626, 1627, 1629, 1630, 1631, 1632, 5545, 1633, 1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 1651, 1652, 1653, 1654, 1655, 1656, 1657, 1658, 1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667, 1671, 1669, 1670, 1674, 1672, 1673, 1676, 1677, 1678, 1679, 1680, 1681, 1675, 1682, 1683, 1643, 14253, 5610, 11666, 1659, 1668], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.7.0"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10962293467426144,,,,,,0.03013387800251086,,,0.004982290538562677,,0.019372245099430953,,584300.0,0.10700740559857132,,,,1.9046378982179095e-05,,,,0.019200024670881225,,0.07771941244264077,,0.023290913727081676,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",100.0,,,,21957.0,,,,,,,,,,,0.0005,,,,,,,1751443241.361758,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [11120, 18268, 23718, 14354, 14382, 25719, 8853, 21535, 8859, 8860, 8861, 8862, 21536, 8867, 8868, 8869, 21537, 21538, 8874, 8875, 8876, 8881, 8882, 8883, 8888, 8889, 8890, 21541, 8894, 8895, 8896, 8897, 16932, 8901, 8902, 8903, 8904, 16934, 8909, 21545, 8910, 8911, 21546, 8915, 8916, 8917, 8918, 21547, 8922, 8923, 8924, 8925, 21549, 8930, 21550, 8931, 8932, 21552, 8936, 8937, 8938, 5773, 8939, 8943, 8944, 8945, 8946, 21554, 8951, 8952, 8953, 21555, 21556, 21557, 21558, 21559, 8960, 21560, 8966, 21561, 8967, 8968, 21562, 8972, 8973, 8974, 8975, 21563, 8980, 21564, 8981, 8982, 21565, 8986, 8987, 8988, 8989, 17008, 17010, 18402, 16523, 16624, 16626, 16832, 3283, 16850, 18416, 9134, 3293, 16873, 18422, 16881, 5869, 3305, 16886, 3330, 3332, 18448, 3336, 5908, 3342, 22291, 11993, 9145, 3367, 3381, 5953, 3215, 5982, 3334, 17322, 17323, 6010, 17325, 17264, 17326, 17327, 17328, 17329, 17330, 17331, 17332, 17333, 17335, 17336, 17337, 17338, 17339, 17340, 17341, 17342, 17343, 17344, 17345, 17346, 17347, 17348, 17349, 17350, 17351, 17352, 22359, 12101, 14730, 14733, 17386, 23999, 17399, 17409, 6067, 17414, 17415, 6084, 6086, 21765, 18628, 18632, 14843, 6157, 18648, 4229, 9401, 3628, 6198, 6200, 18668, 2536, 2537, 2538, 2539, 18675, 2540, 2375, 3650, 12288, 2444, 2477, 2487, 2521, 2528, 2541, 2542, 2543, 2544, 21825, 2545, 2546, 2547, 2548, 2549, 2550, 2551, 2552, 2553, 2554, 2555, 2556, 2557, 2558, 2559, 2560, 2561, 2562, 2563, 2564, 2565, 2566, 2567, 2568, 2569, 2570, 2571, 2572, 2573, 2574, 2575, 2576, 2577, 2578, 2579, 2580, 2333, 2581, 2582, 2583, 2584, 2585, 2586, 2587, 2588, 2589, 2590, 2591, 2592, 2593, 2594, 3028, 3029, 3691, 3032, 3043, 12343, 3049, 3052, 21539, 21540, 3056, 21869, 3068, 3069, 25486, 21542, 14953, 3079, 3082, 21543, 21544, 3758, 22567, 18784, 18806, 21551, 17871, 17872, 6398, 17873, 17874, 17875, 17876, 3839, 17877, 17878, 17879, 17880, 17881, 17882, 17883, 17884, 17885, 17886, 17887, 17888, 17895, 17896, 17889, 17890, 17900, 17892, 17893, 17894, 3854, 17905, 17898, 17899, 17901, 17911, 17903, 17904, 17906, 17915, 17907, 17908, 17909, 17910, 17912, 17913, 17914, 17916, 17924, 17917, 17918, 17919, 17920, 17921, 17922, 17932, 17934, 17926, 17927, 17928, 17929, 17930, 17931, 17933, 17943, 17944, 17937, 17938, 17939, 17940, 17941, 17951, 17945, 17946, 17947, 17948, 17949, 17959, 17960, 3890, 17953, 17954, 17955, 17965, 17957, 17958, 17961, 17962, 17963, 17964, 17967, 3901, 6512, 12547, 20392, 3917, 3922, 18880, 2988, 6624, 2989, 18889, 2990, 2991, 3947, 2992, 2994, 12594, 2995, 22687, 2998, 18911, 18915, 18916, 9798, 16928, 3982, 16929, 16930, 3003, 16931, 3993, 6557, 4000, 22717, 6565, 4004, 16935, 16936, 16937, 16938, 6579, 20467, 16940, 16941, 16942, 16943, 16944, 16945, 3010, 16946, 16947, 6609, 16948, 16949, 6613, 21548, 3014, 16950, 20493, 16951, 16952, 3017, 16953, 9891, 16954, 20502, 16955, 16956, 16957, 16958, 16959, 3023, 16960, 16961, 20518, 16962, 18996, 4091, 6661, 19001, 4109, 19016, 20542, 19019, 6689, 6691, 4133, 20551, 19033, 19035, 20560, 9993, 20567, 20569, 19045, 20570, 80, 81, 22840, 103, 19070, 4193, 7702, 4216, 142, 19090, 19091, 145, 169, 171, 186, 19111, 4256, 199, 204, 159, 4272, 4287, 4291, 242, 245, 4296, 250, 251, 15444, 19150, 266, 277, 299, 311, 313, 317, 15478, 6913, 328, 19184, 347, 22953, 19193, 274, 21553, 6937, 365, 376, 377, 384, 4399, 385, 396, 6965, 400, 402, 15532, 415, 422, 432, 437, 20764, 442, 446, 455, 471, 7025, 481, 492, 494, 503, 506, 524, 519, 528, 7061, 20813, 20815, 4503, 550, 4520, 4524, 8244, 578, 10439, 4542, 595, 597, 13189, 612, 19336, 619, 13199, 605, 649, 8341, 662, 4595, 673, 19366, 19371, 698, 699, 15711, 8386, 15715, 714, 20910, 19403, 745, 15739, 19412, 8438, 771, 4672, 710, 19423, 791, 795, 796, 799, 820, 821, 20971, 7293, 17891, 9813, 7307, 9821, 9845, 20991, 7313, 7316, 17897, 20997, 7323, 20999, 17902, 10693, 7335, 10696, 21008, 15856, 15859, 17923, 17925, 15926, 13494, 15941, 4869, 19558, 17935, 15961, 17936, 17942, 19580, 23201, 21116, 17950, 17952, 17956, 7515, 8771, 23239, 16046, 5002, 7572, 13981, 7574, 7580, 8830, 8843, 19690, 16135, 7659, 21242, 7670, 16172, 5108, 21256, 21258, 7684, 21261, 7699, 19748, 25223, 20061, 22352, 7762, 21317, 5198, 11204, 19835, 11247, 9196, 19879, 11322, 16384, 23501, 25156, 11471, 23597, 1357, 1402, 1485, 1522, 1588, 1589, 1591, 1592, 1593, 1594, 1595, 1596, 1597, 23622, 1599, 1600, 1601, 1602, 1603, 1604, 1607, 1608, 1609, 1611, 1612, 1614, 1615, 1616, 1617, 1619, 1620, 1622, 1623, 1624, 23634, 1625, 1626, 1627, 1629, 1630, 1631, 1632, 5545, 1633, 1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 1651, 1652, 1653, 1654, 1655, 1656, 1657, 1658, 1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667, 1671, 1669, 1670, 1674, 1672, 1673, 1676, 1677, 1678, 1679, 1680, 1681, 1675, 1682, 1683, 1643, 14253, 5610, 11666, 1659, 1668], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.7.0"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b,0.20545144909598131,,,,,0.0008980968466555684,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,117163.0,,0.02206854956930009,,,,2.5757420097215103e-05,,,0.0016286238781057815,0.002150387585049,,,,0.01639344262295082,0.0022664556672577427,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 21957},0.023300801262591896,,0.004879041206476031,,,0.2043019471292036,,,,,,,,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.003653630549910117,0.0055653764716371125,,,,,0.07787709718834974,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b/base_huber_q0.75_rare_sampling,5.0,2.0,1.0,float32,42.0,32.068671760720726,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_huber_q0.75_rare_sampling_train.xyz,data/base_huber_q0.75_rare_sampling_val.xyz,data/base_huber_q0.75_rare_sampling_test.xyz,d6bea18f,train:data/base_huber_q0.75_rare_sampling_train.xyz|val:data/base_huber_q0.75_rare_sampling_val.xyz|test:data/base_huber_q0.75_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
47,allegro_huber_loss_study_no_dimers_no_sr_no_val_b,base_huber_q0.75_rare_sampling,21957.0,117163.0,1751443241.361758,{'runtime': 21957},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.0005,0.10700740559857132,0.20545144909598131,0.019372245099430953,0.023300801262591896,0.002150387585049,0.004879041206476031,0.07787709718834974,0.02206854956930009,0.0008980968466555684,2.5757420097215103e-05,0.003653630549910117,0.03013387800251086,0.0016286238781057815,1.9046378982179095e-05,0.004982290538562677,584300.0,0.10962293467426144,0.2043019471292036,0.019200024670881225,0.023290913727081676,0.0022664556672577427,0.0055653764716371125,0.07771941244264077,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [11120, 18268, 23718, 14354, 14382, 25719, 8853, 21535, 8859, 8860, 8861, 8862, 21536, 8867, 8868, 8869, 21537, 21538, 8874, 8875, 8876, 8881, 8882, 8883, 8888, 8889, 8890, 21541, 8894, 8895, 8896, 8897, 16932, 8901, 8902, 8903, 8904, 16934, 8909, 21545, 8910, 8911, 21546, 8915, 8916, 8917, 8918, 21547, 8922, 8923, 8924, 8925, 21549, 8930, 21550, 8931, 8932, 21552, 8936, 8937, 8938, 5773, 8939, 8943, 8944, 8945, 8946, 21554, 8951, 8952, 8953, 21555, 21556, 21557, 21558, 21559, 8960, 21560, 8966, 21561, 8967, 8968, 21562, 8972, 8973, 8974, 8975, 21563, 8980, 21564, 8981, 8982, 21565, 8986, 8987, 8988, 8989, 17008, 17010, 18402, 16523, 16624, 16626, 16832, 3283, 16850, 18416, 9134, 3293, 16873, 18422, 16881, 5869, 3305, 16886, 3330, 3332, 18448, 3336, 5908, 3342, 22291, 11993, 9145, 3367, 3381, 5953, 3215, 5982, 3334, 17322, 17323, 6010, 17325, 17264, 17326, 17327, 17328, 17329, 17330, 17331, 17332, 17333, 17335, 17336, 17337, 17338, 17339, 17340, 17341, 17342, 17343, 17344, 17345, 17346, 17347, 17348, 17349, 17350, 17351, 17352, 22359, 12101, 14730, 14733, 17386, 23999, 17399, 17409, 6067, 17414, 17415, 6084, 6086, 21765, 18628, 18632, 14843, 6157, 18648, 4229, 9401, 3628, 6198, 6200, 18668, 2536, 2537, 2538, 2539, 18675, 2540, 2375, 3650, 12288, 2444, 2477, 2487, 2521, 2528, 2541, 2542, 2543, 2544, 21825, 2545, 2546, 2547, 2548, 2549, 2550, 2551, 2552, 2553, 2554, 2555, 2556, 2557, 2558, 2559, 2560, 2561, 2562, 2563, 2564, 2565, 2566, 2567, 2568, 2569, 2570, 2571, 2572, 2573, 2574, 2575, 2576, 2577, 2578, 2579, 2580, 2333, 2581, 2582, 2583, 2584, 2585, 2586, 2587, 2588, 2589, 2590, 2591, 2592, 2593, 2594, 3028, 3029, 3691, 3032, 3043, 12343, 3049, 3052, 21539, 21540, 3056, 21869, 3068, 3069, 25486, 21542, 14953, 3079, 3082, 21543, 21544, 3758, 22567, 18784, 18806, 21551, 17871, 17872, 6398, 17873, 17874, 17875, 17876, 3839, 17877, 17878, 17879, 17880, 17881, 17882, 17883, 17884, 17885, 17886, 17887, 17888, 17895, 17896, 17889, 17890, 17900, 17892, 17893, 17894, 3854, 17905, 17898, 17899, 17901, 17911, 17903, 17904, 17906, 17915, 17907, 17908, 17909, 17910, 17912, 17913, 17914, 17916, 17924, 17917, 17918, 17919, 17920, 17921, 17922, 17932, 17934, 17926, 17927, 17928, 17929, 17930, 17931, 17933, 17943, 17944, 17937, 17938, 17939, 17940, 17941, 17951, 17945, 17946, 17947, 17948, 17949, 17959, 17960, 3890, 17953, 17954, 17955, 17965, 17957, 17958, 17961, 17962, 17963, 17964, 17967, 3901, 6512, 12547, 20392, 3917, 3922, 18880, 2988, 6624, 2989, 18889, 2990, 2991, 3947, 2992, 2994, 12594, 2995, 22687, 2998, 18911, 18915, 18916, 9798, 16928, 3982, 16929, 16930, 3003, 16931, 3993, 6557, 4000, 22717, 6565, 4004, 16935, 16936, 16937, 16938, 6579, 20467, 16940, 16941, 16942, 16943, 16944, 16945, 3010, 16946, 16947, 6609, 16948, 16949, 6613, 21548, 3014, 16950, 20493, 16951, 16952, 3017, 16953, 9891, 16954, 20502, 16955, 16956, 16957, 16958, 16959, 3023, 16960, 16961, 20518, 16962, 18996, 4091, 6661, 19001, 4109, 19016, 20542, 19019, 6689, 6691, 4133, 20551, 19033, 19035, 20560, 9993, 20567, 20569, 19045, 20570, 80, 81, 22840, 103, 19070, 4193, 7702, 4216, 142, 19090, 19091, 145, 169, 171, 186, 19111, 4256, 199, 204, 159, 4272, 4287, 4291, 242, 245, 4296, 250, 251, 15444, 19150, 266, 277, 299, 311, 313, 317, 15478, 6913, 328, 19184, 347, 22953, 19193, 274, 21553, 6937, 365, 376, 377, 384, 4399, 385, 396, 6965, 400, 402, 15532, 415, 422, 432, 437, 20764, 442, 446, 455, 471, 7025, 481, 492, 494, 503, 506, 524, 519, 528, 7061, 20813, 20815, 4503, 550, 4520, 4524, 8244, 578, 10439, 4542, 595, 597, 13189, 612, 19336, 619, 13199, 605, 649, 8341, 662, 4595, 673, 19366, 19371, 698, 699, 15711, 8386, 15715, 714, 20910, 19403, 745, 15739, 19412, 8438, 771, 4672, 710, 19423, 791, 795, 796, 799, 820, 821, 20971, 7293, 17891, 9813, 7307, 9821, 9845, 20991, 7313, 7316, 17897, 20997, 7323, 20999, 17902, 10693, 7335, 10696, 21008, 15856, 15859, 17923, 17925, 15926, 13494, 15941, 4869, 19558, 17935, 15961, 17936, 17942, 19580, 23201, 21116, 17950, 17952, 17956, 7515, 8771, 23239, 16046, 5002, 7572, 13981, 7574, 7580, 8830, 8843, 19690, 16135, 7659, 21242, 7670, 16172, 5108, 21256, 21258, 7684, 21261, 7699, 19748, 25223, 20061, 22352, 7762, 21317, 5198, 11204, 19835, 11247, 9196, 19879, 11322, 16384, 23501, 25156, 11471, 23597, 1357, 1402, 1485, 1522, 1588, 1589, 1591, 1592, 1593, 1594, 1595, 1596, 1597, 23622, 1599, 1600, 1601, 1602, 1603, 1604, 1607, 1608, 1609, 1611, 1612, 1614, 1615, 1616, 1617, 1619, 1620, 1622, 1623, 1624, 23634, 1625, 1626, 1627, 1629, 1630, 1631, 1632, 5545, 1633, 1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 1651, 1652, 1653, 1654, 1655, 1656, 1657, 1658, 1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667, 1671, 1669, 1670, 1674, 1672, 1673, 1676, 1677, 1678, 1679, 1680, 1681, 1675, 1682, 1683, 1643, 14253, 5610, 11666, 1659, 1668], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.7.0"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10962293467426144,,,,,,0.05071668770754759,,,0.016932118807217168,,0.06115765444384013,,516200.0,0.19257872399574963,,,,0.00027041754105836587,,,,0.06003576762272479,,0.20629050889303605,,0.10555773094735955,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27121.977153299,,,,,,,,,,,3.90625e-06,,,,,,,1751493553.0339444,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,1.2488243759753863,,,,,0.08187640202251499,0.3055978319668887,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103543.0,,0.12835003405296955,,,,0.017836293362737992,,,0.0005656502102194162,0.012115759535048927,,,,0.36625958351537513,0.012425451058132106,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27122},0.10902587132008336,,0.02474292029733767,,,0.4861497890485908,,,,,,,,,0.32814258451773615,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.07755586138356277,0.0271640066831578,,,,,0.4608643891976026,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b/base_huber_q0.75_rare_sampling,5.0,2.0,1.0,float32,42.0,32.068671760720726,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_huber_q0.75_rare_sampling_train.xyz,data/base_huber_q0.75_rare_sampling_val.xyz,data/base_huber_q0.75_rare_sampling_test.xyz,d6bea18f,train:data/base_huber_q0.75_rare_sampling_train.xyz|val:data/base_huber_q0.75_rare_sampling_val.xyz|test:data/base_huber_q0.75_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
48,allegro_huber_loss_study_no_dimers_no_sr_no_val_b,base_huber_q0.75_rare_sampling,21957.0,117163.0,1751443241.361758,{'runtime': 21957},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.0005,0.10700740559857132,0.20545144909598131,0.019372245099430953,0.023300801262591896,0.002150387585049,0.004879041206476031,0.07787709718834974,0.02206854956930009,0.0008980968466555684,2.5757420097215103e-05,0.003653630549910117,0.03013387800251086,0.0016286238781057815,1.9046378982179095e-05,0.004982290538562677,584300.0,0.10962293467426144,0.2043019471292036,0.019200024670881225,0.023290913727081676,0.0022664556672577427,0.0055653764716371125,0.07771941244264077,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [11120, 18268, 23718, 14354, 14382, 25719, 8853, 21535, 8859, 8860, 8861, 8862, 21536, 8867, 8868, 8869, 21537, 21538, 8874, 8875, 8876, 8881, 8882, 8883, 8888, 8889, 8890, 21541, 8894, 8895, 8896, 8897, 16932, 8901, 8902, 8903, 8904, 16934, 8909, 21545, 8910, 8911, 21546, 8915, 8916, 8917, 8918, 21547, 8922, 8923, 8924, 8925, 21549, 8930, 21550, 8931, 8932, 21552, 8936, 8937, 8938, 5773, 8939, 8943, 8944, 8945, 8946, 21554, 8951, 8952, 8953, 21555, 21556, 21557, 21558, 21559, 8960, 21560, 8966, 21561, 8967, 8968, 21562, 8972, 8973, 8974, 8975, 21563, 8980, 21564, 8981, 8982, 21565, 8986, 8987, 8988, 8989, 17008, 17010, 18402, 16523, 16624, 16626, 16832, 3283, 16850, 18416, 9134, 3293, 16873, 18422, 16881, 5869, 3305, 16886, 3330, 3332, 18448, 3336, 5908, 3342, 22291, 11993, 9145, 3367, 3381, 5953, 3215, 5982, 3334, 17322, 17323, 6010, 17325, 17264, 17326, 17327, 17328, 17329, 17330, 17331, 17332, 17333, 17335, 17336, 17337, 17338, 17339, 17340, 17341, 17342, 17343, 17344, 17345, 17346, 17347, 17348, 17349, 17350, 17351, 17352, 22359, 12101, 14730, 14733, 17386, 23999, 17399, 17409, 6067, 17414, 17415, 6084, 6086, 21765, 18628, 18632, 14843, 6157, 18648, 4229, 9401, 3628, 6198, 6200, 18668, 2536, 2537, 2538, 2539, 18675, 2540, 2375, 3650, 12288, 2444, 2477, 2487, 2521, 2528, 2541, 2542, 2543, 2544, 21825, 2545, 2546, 2547, 2548, 2549, 2550, 2551, 2552, 2553, 2554, 2555, 2556, 2557, 2558, 2559, 2560, 2561, 2562, 2563, 2564, 2565, 2566, 2567, 2568, 2569, 2570, 2571, 2572, 2573, 2574, 2575, 2576, 2577, 2578, 2579, 2580, 2333, 2581, 2582, 2583, 2584, 2585, 2586, 2587, 2588, 2589, 2590, 2591, 2592, 2593, 2594, 3028, 3029, 3691, 3032, 3043, 12343, 3049, 3052, 21539, 21540, 3056, 21869, 3068, 3069, 25486, 21542, 14953, 3079, 3082, 21543, 21544, 3758, 22567, 18784, 18806, 21551, 17871, 17872, 6398, 17873, 17874, 17875, 17876, 3839, 17877, 17878, 17879, 17880, 17881, 17882, 17883, 17884, 17885, 17886, 17887, 17888, 17895, 17896, 17889, 17890, 17900, 17892, 17893, 17894, 3854, 17905, 17898, 17899, 17901, 17911, 17903, 17904, 17906, 17915, 17907, 17908, 17909, 17910, 17912, 17913, 17914, 17916, 17924, 17917, 17918, 17919, 17920, 17921, 17922, 17932, 17934, 17926, 17927, 17928, 17929, 17930, 17931, 17933, 17943, 17944, 17937, 17938, 17939, 17940, 17941, 17951, 17945, 17946, 17947, 17948, 17949, 17959, 17960, 3890, 17953, 17954, 17955, 17965, 17957, 17958, 17961, 17962, 17963, 17964, 17967, 3901, 6512, 12547, 20392, 3917, 3922, 18880, 2988, 6624, 2989, 18889, 2990, 2991, 3947, 2992, 2994, 12594, 2995, 22687, 2998, 18911, 18915, 18916, 9798, 16928, 3982, 16929, 16930, 3003, 16931, 3993, 6557, 4000, 22717, 6565, 4004, 16935, 16936, 16937, 16938, 6579, 20467, 16940, 16941, 16942, 16943, 16944, 16945, 3010, 16946, 16947, 6609, 16948, 16949, 6613, 21548, 3014, 16950, 20493, 16951, 16952, 3017, 16953, 9891, 16954, 20502, 16955, 16956, 16957, 16958, 16959, 3023, 16960, 16961, 20518, 16962, 18996, 4091, 6661, 19001, 4109, 19016, 20542, 19019, 6689, 6691, 4133, 20551, 19033, 19035, 20560, 9993, 20567, 20569, 19045, 20570, 80, 81, 22840, 103, 19070, 4193, 7702, 4216, 142, 19090, 19091, 145, 169, 171, 186, 19111, 4256, 199, 204, 159, 4272, 4287, 4291, 242, 245, 4296, 250, 251, 15444, 19150, 266, 277, 299, 311, 313, 317, 15478, 6913, 328, 19184, 347, 22953, 19193, 274, 21553, 6937, 365, 376, 377, 384, 4399, 385, 396, 6965, 400, 402, 15532, 415, 422, 432, 437, 20764, 442, 446, 455, 471, 7025, 481, 492, 494, 503, 506, 524, 519, 528, 7061, 20813, 20815, 4503, 550, 4520, 4524, 8244, 578, 10439, 4542, 595, 597, 13189, 612, 19336, 619, 13199, 605, 649, 8341, 662, 4595, 673, 19366, 19371, 698, 699, 15711, 8386, 15715, 714, 20910, 19403, 745, 15739, 19412, 8438, 771, 4672, 710, 19423, 791, 795, 796, 799, 820, 821, 20971, 7293, 17891, 9813, 7307, 9821, 9845, 20991, 7313, 7316, 17897, 20997, 7323, 20999, 17902, 10693, 7335, 10696, 21008, 15856, 15859, 17923, 17925, 15926, 13494, 15941, 4869, 19558, 17935, 15961, 17936, 17942, 19580, 23201, 21116, 17950, 17952, 17956, 7515, 8771, 23239, 16046, 5002, 7572, 13981, 7574, 7580, 8830, 8843, 19690, 16135, 7659, 21242, 7670, 16172, 5108, 21256, 21258, 7684, 21261, 7699, 19748, 25223, 20061, 22352, 7762, 21317, 5198, 11204, 19835, 11247, 9196, 19879, 11322, 16384, 23501, 25156, 11471, 23597, 1357, 1402, 1485, 1522, 1588, 1589, 1591, 1592, 1593, 1594, 1595, 1596, 1597, 23622, 1599, 1600, 1601, 1602, 1603, 1604, 1607, 1608, 1609, 1611, 1612, 1614, 1615, 1616, 1617, 1619, 1620, 1622, 1623, 1624, 23634, 1625, 1626, 1627, 1629, 1630, 1631, 1632, 5545, 1633, 1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 1651, 1652, 1653, 1654, 1655, 1656, 1657, 1658, 1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667, 1671, 1669, 1670, 1674, 1672, 1673, 1676, 1677, 1678, 1679, 1680, 1681, 1675, 1682, 1683, 1643, 14253, 5610, 11666, 1659, 1668], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.7.0"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.1947615926329772,,,,,,0.03013387800251086,,,0.004982290538562677,,0.019372245099430953,,584300.0,0.10700740559857132,,,,1.9046378982179095e-05,,,,0.019200024670881225,,0.07771941244264077,,0.023290913727081676,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",100.0,,,,21957.0,,,,,,,,,,,0.0005,,,,,,,1751443241.361758,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [11120, 18268, 23718, 14354, 14382, 25719, 8853, 21535, 8859, 8860, 8861, 8862, 21536, 8867, 8868, 8869, 21537, 21538, 8874, 8875, 8876, 8881, 8882, 8883, 8888, 8889, 8890, 21541, 8894, 8895, 8896, 8897, 16932, 8901, 8902, 8903, 8904, 16934, 8909, 21545, 8910, 8911, 21546, 8915, 8916, 8917, 8918, 21547, 8922, 8923, 8924, 8925, 21549, 8930, 21550, 8931, 8932, 21552, 8936, 8937, 8938, 5773, 8939, 8943, 8944, 8945, 8946, 21554, 8951, 8952, 8953, 21555, 21556, 21557, 21558, 21559, 8960, 21560, 8966, 21561, 8967, 8968, 21562, 8972, 8973, 8974, 8975, 21563, 8980, 21564, 8981, 8982, 21565, 8986, 8987, 8988, 8989, 17008, 17010, 18402, 16523, 16624, 16626, 16832, 3283, 16850, 18416, 9134, 3293, 16873, 18422, 16881, 5869, 3305, 16886, 3330, 3332, 18448, 3336, 5908, 3342, 22291, 11993, 9145, 3367, 3381, 5953, 3215, 5982, 3334, 17322, 17323, 6010, 17325, 17264, 17326, 17327, 17328, 17329, 17330, 17331, 17332, 17333, 17335, 17336, 17337, 17338, 17339, 17340, 17341, 17342, 17343, 17344, 17345, 17346, 17347, 17348, 17349, 17350, 17351, 17352, 22359, 12101, 14730, 14733, 17386, 23999, 17399, 17409, 6067, 17414, 17415, 6084, 6086, 21765, 18628, 18632, 14843, 6157, 18648, 4229, 9401, 3628, 6198, 6200, 18668, 2536, 2537, 2538, 2539, 18675, 2540, 2375, 3650, 12288, 2444, 2477, 2487, 2521, 2528, 2541, 2542, 2543, 2544, 21825, 2545, 2546, 2547, 2548, 2549, 2550, 2551, 2552, 2553, 2554, 2555, 2556, 2557, 2558, 2559, 2560, 2561, 2562, 2563, 2564, 2565, 2566, 2567, 2568, 2569, 2570, 2571, 2572, 2573, 2574, 2575, 2576, 2577, 2578, 2579, 2580, 2333, 2581, 2582, 2583, 2584, 2585, 2586, 2587, 2588, 2589, 2590, 2591, 2592, 2593, 2594, 3028, 3029, 3691, 3032, 3043, 12343, 3049, 3052, 21539, 21540, 3056, 21869, 3068, 3069, 25486, 21542, 14953, 3079, 3082, 21543, 21544, 3758, 22567, 18784, 18806, 21551, 17871, 17872, 6398, 17873, 17874, 17875, 17876, 3839, 17877, 17878, 17879, 17880, 17881, 17882, 17883, 17884, 17885, 17886, 17887, 17888, 17895, 17896, 17889, 17890, 17900, 17892, 17893, 17894, 3854, 17905, 17898, 17899, 17901, 17911, 17903, 17904, 17906, 17915, 17907, 17908, 17909, 17910, 17912, 17913, 17914, 17916, 17924, 17917, 17918, 17919, 17920, 17921, 17922, 17932, 17934, 17926, 17927, 17928, 17929, 17930, 17931, 17933, 17943, 17944, 17937, 17938, 17939, 17940, 17941, 17951, 17945, 17946, 17947, 17948, 17949, 17959, 17960, 3890, 17953, 17954, 17955, 17965, 17957, 17958, 17961, 17962, 17963, 17964, 17967, 3901, 6512, 12547, 20392, 3917, 3922, 18880, 2988, 6624, 2989, 18889, 2990, 2991, 3947, 2992, 2994, 12594, 2995, 22687, 2998, 18911, 18915, 18916, 9798, 16928, 3982, 16929, 16930, 3003, 16931, 3993, 6557, 4000, 22717, 6565, 4004, 16935, 16936, 16937, 16938, 6579, 20467, 16940, 16941, 16942, 16943, 16944, 16945, 3010, 16946, 16947, 6609, 16948, 16949, 6613, 21548, 3014, 16950, 20493, 16951, 16952, 3017, 16953, 9891, 16954, 20502, 16955, 16956, 16957, 16958, 16959, 3023, 16960, 16961, 20518, 16962, 18996, 4091, 6661, 19001, 4109, 19016, 20542, 19019, 6689, 6691, 4133, 20551, 19033, 19035, 20560, 9993, 20567, 20569, 19045, 20570, 80, 81, 22840, 103, 19070, 4193, 7702, 4216, 142, 19090, 19091, 145, 169, 171, 186, 19111, 4256, 199, 204, 159, 4272, 4287, 4291, 242, 245, 4296, 250, 251, 15444, 19150, 266, 277, 299, 311, 313, 317, 15478, 6913, 328, 19184, 347, 22953, 19193, 274, 21553, 6937, 365, 376, 377, 384, 4399, 385, 396, 6965, 400, 402, 15532, 415, 422, 432, 437, 20764, 442, 446, 455, 471, 7025, 481, 492, 494, 503, 506, 524, 519, 528, 7061, 20813, 20815, 4503, 550, 4520, 4524, 8244, 578, 10439, 4542, 595, 597, 13189, 612, 19336, 619, 13199, 605, 649, 8341, 662, 4595, 673, 19366, 19371, 698, 699, 15711, 8386, 15715, 714, 20910, 19403, 745, 15739, 19412, 8438, 771, 4672, 710, 19423, 791, 795, 796, 799, 820, 821, 20971, 7293, 17891, 9813, 7307, 9821, 9845, 20991, 7313, 7316, 17897, 20997, 7323, 20999, 17902, 10693, 7335, 10696, 21008, 15856, 15859, 17923, 17925, 15926, 13494, 15941, 4869, 19558, 17935, 15961, 17936, 17942, 19580, 23201, 21116, 17950, 17952, 17956, 7515, 8771, 23239, 16046, 5002, 7572, 13981, 7574, 7580, 8830, 8843, 19690, 16135, 7659, 21242, 7670, 16172, 5108, 21256, 21258, 7684, 21261, 7699, 19748, 25223, 20061, 22352, 7762, 21317, 5198, 11204, 19835, 11247, 9196, 19879, 11322, 16384, 23501, 25156, 11471, 23597, 1357, 1402, 1485, 1522, 1588, 1589, 1591, 1592, 1593, 1594, 1595, 1596, 1597, 23622, 1599, 1600, 1601, 1602, 1603, 1604, 1607, 1608, 1609, 1611, 1612, 1614, 1615, 1616, 1617, 1619, 1620, 1622, 1623, 1624, 23634, 1625, 1626, 1627, 1629, 1630, 1631, 1632, 5545, 1633, 1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 1651, 1652, 1653, 1654, 1655, 1656, 1657, 1658, 1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667, 1671, 1669, 1670, 1674, 1672, 1673, 1676, 1677, 1678, 1679, 1680, 1681, 1675, 1682, 1683, 1643, 14253, 5610, 11666, 1659, 1668], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.7.0"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b,0.20545144909598131,,,,,0.0008980968466555684,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,117163.0,,0.02206854956930009,,,,2.5757420097215103e-05,,,0.0016286238781057815,0.002150387585049,,,,0.01639344262295082,0.0022664556672577427,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 21957},0.023300801262591896,,0.004879041206476031,,,0.2043019471292036,,,,,,,,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.003653630549910117,0.0055653764716371125,,,,,0.07787709718834974,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b/base_huber_q0.75_rare_sampling,5.0,2.0,1.0,float32,42.0,32.068671760720726,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_huber_q0.75_rare_sampling_train.xyz,data/base_huber_q0.75_rare_sampling_val.xyz,data/base_huber_q0.75_rare_sampling_test.xyz,d6bea18f,train:data/base_huber_q0.75_rare_sampling_train.xyz|val:data/base_huber_q0.75_rare_sampling_val.xyz|test:data/base_huber_q0.75_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
49,allegro_huber_loss_study_no_dimers_no_sr_no_val_b,base_huber_q0.75_rare_sampling,21957.0,117163.0,1751443241.361758,{'runtime': 21957},100.0,0.16393442622950818,0.01639344262295082,0.819672131147541,0.0005,0.10700740559857132,0.20545144909598131,0.019372245099430953,0.023300801262591896,0.002150387585049,0.004879041206476031,0.07787709718834974,0.02206854956930009,0.0008980968466555684,2.5757420097215103e-05,0.003653630549910117,0.03013387800251086,0.0016286238781057815,1.9046378982179095e-05,0.004982290538562677,584300.0,0.10962293467426144,0.2043019471292036,0.019200024670881225,0.023290913727081676,0.0022664556672577427,0.0055653764716371125,0.07771941244264077,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [11120, 18268, 23718, 14354, 14382, 25719, 8853, 21535, 8859, 8860, 8861, 8862, 21536, 8867, 8868, 8869, 21537, 21538, 8874, 8875, 8876, 8881, 8882, 8883, 8888, 8889, 8890, 21541, 8894, 8895, 8896, 8897, 16932, 8901, 8902, 8903, 8904, 16934, 8909, 21545, 8910, 8911, 21546, 8915, 8916, 8917, 8918, 21547, 8922, 8923, 8924, 8925, 21549, 8930, 21550, 8931, 8932, 21552, 8936, 8937, 8938, 5773, 8939, 8943, 8944, 8945, 8946, 21554, 8951, 8952, 8953, 21555, 21556, 21557, 21558, 21559, 8960, 21560, 8966, 21561, 8967, 8968, 21562, 8972, 8973, 8974, 8975, 21563, 8980, 21564, 8981, 8982, 21565, 8986, 8987, 8988, 8989, 17008, 17010, 18402, 16523, 16624, 16626, 16832, 3283, 16850, 18416, 9134, 3293, 16873, 18422, 16881, 5869, 3305, 16886, 3330, 3332, 18448, 3336, 5908, 3342, 22291, 11993, 9145, 3367, 3381, 5953, 3215, 5982, 3334, 17322, 17323, 6010, 17325, 17264, 17326, 17327, 17328, 17329, 17330, 17331, 17332, 17333, 17335, 17336, 17337, 17338, 17339, 17340, 17341, 17342, 17343, 17344, 17345, 17346, 17347, 17348, 17349, 17350, 17351, 17352, 22359, 12101, 14730, 14733, 17386, 23999, 17399, 17409, 6067, 17414, 17415, 6084, 6086, 21765, 18628, 18632, 14843, 6157, 18648, 4229, 9401, 3628, 6198, 6200, 18668, 2536, 2537, 2538, 2539, 18675, 2540, 2375, 3650, 12288, 2444, 2477, 2487, 2521, 2528, 2541, 2542, 2543, 2544, 21825, 2545, 2546, 2547, 2548, 2549, 2550, 2551, 2552, 2553, 2554, 2555, 2556, 2557, 2558, 2559, 2560, 2561, 2562, 2563, 2564, 2565, 2566, 2567, 2568, 2569, 2570, 2571, 2572, 2573, 2574, 2575, 2576, 2577, 2578, 2579, 2580, 2333, 2581, 2582, 2583, 2584, 2585, 2586, 2587, 2588, 2589, 2590, 2591, 2592, 2593, 2594, 3028, 3029, 3691, 3032, 3043, 12343, 3049, 3052, 21539, 21540, 3056, 21869, 3068, 3069, 25486, 21542, 14953, 3079, 3082, 21543, 21544, 3758, 22567, 18784, 18806, 21551, 17871, 17872, 6398, 17873, 17874, 17875, 17876, 3839, 17877, 17878, 17879, 17880, 17881, 17882, 17883, 17884, 17885, 17886, 17887, 17888, 17895, 17896, 17889, 17890, 17900, 17892, 17893, 17894, 3854, 17905, 17898, 17899, 17901, 17911, 17903, 17904, 17906, 17915, 17907, 17908, 17909, 17910, 17912, 17913, 17914, 17916, 17924, 17917, 17918, 17919, 17920, 17921, 17922, 17932, 17934, 17926, 17927, 17928, 17929, 17930, 17931, 17933, 17943, 17944, 17937, 17938, 17939, 17940, 17941, 17951, 17945, 17946, 17947, 17948, 17949, 17959, 17960, 3890, 17953, 17954, 17955, 17965, 17957, 17958, 17961, 17962, 17963, 17964, 17967, 3901, 6512, 12547, 20392, 3917, 3922, 18880, 2988, 6624, 2989, 18889, 2990, 2991, 3947, 2992, 2994, 12594, 2995, 22687, 2998, 18911, 18915, 18916, 9798, 16928, 3982, 16929, 16930, 3003, 16931, 3993, 6557, 4000, 22717, 6565, 4004, 16935, 16936, 16937, 16938, 6579, 20467, 16940, 16941, 16942, 16943, 16944, 16945, 3010, 16946, 16947, 6609, 16948, 16949, 6613, 21548, 3014, 16950, 20493, 16951, 16952, 3017, 16953, 9891, 16954, 20502, 16955, 16956, 16957, 16958, 16959, 3023, 16960, 16961, 20518, 16962, 18996, 4091, 6661, 19001, 4109, 19016, 20542, 19019, 6689, 6691, 4133, 20551, 19033, 19035, 20560, 9993, 20567, 20569, 19045, 20570, 80, 81, 22840, 103, 19070, 4193, 7702, 4216, 142, 19090, 19091, 145, 169, 171, 186, 19111, 4256, 199, 204, 159, 4272, 4287, 4291, 242, 245, 4296, 250, 251, 15444, 19150, 266, 277, 299, 311, 313, 317, 15478, 6913, 328, 19184, 347, 22953, 19193, 274, 21553, 6937, 365, 376, 377, 384, 4399, 385, 396, 6965, 400, 402, 15532, 415, 422, 432, 437, 20764, 442, 446, 455, 471, 7025, 481, 492, 494, 503, 506, 524, 519, 528, 7061, 20813, 20815, 4503, 550, 4520, 4524, 8244, 578, 10439, 4542, 595, 597, 13189, 612, 19336, 619, 13199, 605, 649, 8341, 662, 4595, 673, 19366, 19371, 698, 699, 15711, 8386, 15715, 714, 20910, 19403, 745, 15739, 19412, 8438, 771, 4672, 710, 19423, 791, 795, 796, 799, 820, 821, 20971, 7293, 17891, 9813, 7307, 9821, 9845, 20991, 7313, 7316, 17897, 20997, 7323, 20999, 17902, 10693, 7335, 10696, 21008, 15856, 15859, 17923, 17925, 15926, 13494, 15941, 4869, 19558, 17935, 15961, 17936, 17942, 19580, 23201, 21116, 17950, 17952, 17956, 7515, 8771, 23239, 16046, 5002, 7572, 13981, 7574, 7580, 8830, 8843, 19690, 16135, 7659, 21242, 7670, 16172, 5108, 21256, 21258, 7684, 21261, 7699, 19748, 25223, 20061, 22352, 7762, 21317, 5198, 11204, 19835, 11247, 9196, 19879, 11322, 16384, 23501, 25156, 11471, 23597, 1357, 1402, 1485, 1522, 1588, 1589, 1591, 1592, 1593, 1594, 1595, 1596, 1597, 23622, 1599, 1600, 1601, 1602, 1603, 1604, 1607, 1608, 1609, 1611, 1612, 1614, 1615, 1616, 1617, 1619, 1620, 1622, 1623, 1624, 23634, 1625, 1626, 1627, 1629, 1630, 1631, 1632, 5545, 1633, 1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 1651, 1652, 1653, 1654, 1655, 1656, 1657, 1658, 1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667, 1671, 1669, 1670, 1674, 1672, 1673, 1676, 1677, 1678, 1679, 1680, 1681, 1675, 1682, 1683, 1643, 14253, 5610, 11666, 1659, 1668], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.7.0"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.1947615926329772,,,,,,0.05071668770754759,,,0.016932118807217168,,0.06115765444384013,,516200.0,0.19257872399574963,,,,0.00027041754105836587,,,,0.06003576762272479,,0.20629050889303605,,0.10555773094735955,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27121.977153299,,,,,,,,,,,3.90625e-06,,,,,,,1751493553.0339444,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,1.2488243759753863,,,,,0.08187640202251499,0.3055978319668887,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103543.0,,0.12835003405296955,,,,0.017836293362737992,,,0.0005656502102194162,0.012115759535048927,,,,0.36625958351537513,0.012425451058132106,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27122},0.10902587132008336,,0.02474292029733767,,,0.4861497890485908,,,,,,,,,0.32814258451773615,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.07755586138356277,0.0271640066831578,,,,,0.4608643891976026,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b/base_huber_q0.75_rare_sampling,5.0,2.0,1.0,float32,42.0,32.068671760720726,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_huber_q0.75_rare_sampling_train.xyz,data/base_huber_q0.75_rare_sampling_val.xyz,data/base_huber_q0.75_rare_sampling_test.xyz,d6bea18f,train:data/base_huber_q0.75_rare_sampling_train.xyz|val:data/base_huber_q0.75_rare_sampling_val.xyz|test:data/base_huber_q0.75_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
50,allegro_huber_loss_study_no_dimers_no_sr_no_val_b,base_huber_q0.75_rare_sampling_nlh,39299.970352746,214448.0,1751503689.746696,{'runtime': 39299},183.0,0.16393442622950818,0.01639344262295082,0.819672131147541,3.90625e-06,0.469845549134732,0.8797924112285814,5.416146602720103,5.479819070986869,0.01589695440488711,0.052582389271266745,2.137397957162239,0.014483170064781371,0.00044562710427598475,1.691544783672952e-05,0.0023954606580971504,0.013062813075437352,0.00021503360854552457,1.0423542126134625e-05,0.0021535137945774712,1069484.0,0.11196376467940984,0.21127754039868551,0.01720262427585141,0.02111626530179777,0.0021329919148613805,0.005300833596376827,0.07923154643228672,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [11120, 18268, 23718, 14354, 14382, 25719, 8853, 21535, 8859, 8860, 8861, 8862, 21536, 8867, 8868, 8869, 21537, 21538, 8874, 8875, 8876, 8881, 8882, 8883, 8888, 8889, 8890, 21541, 8894, 8895, 8896, 8897, 16932, 8901, 8902, 8903, 8904, 16934, 8909, 21545, 8910, 8911, 21546, 8915, 8916, 8917, 8918, 21547, 8922, 8923, 8924, 8925, 21549, 8930, 21550, 8931, 8932, 21552, 8936, 8937, 8938, 5773, 8939, 8943, 8944, 8945, 8946, 21554, 8951, 8952, 8953, 21555, 21556, 21557, 21558, 21559, 8960, 21560, 8966, 21561, 8967, 8968, 21562, 8972, 8973, 8974, 8975, 21563, 8980, 21564, 8981, 8982, 21565, 8986, 8987, 8988, 8989, 17008, 17010, 18402, 16523, 16624, 16626, 16832, 3283, 16850, 18416, 9134, 3293, 16873, 18422, 16881, 5869, 3305, 16886, 3330, 3332, 18448, 3336, 5908, 3342, 22291, 11993, 9145, 3367, 3381, 5953, 3215, 5982, 3334, 17322, 17323, 6010, 17325, 17264, 17326, 17327, 17328, 17329, 17330, 17331, 17332, 17333, 17335, 17336, 17337, 17338, 17339, 17340, 17341, 17342, 17343, 17344, 17345, 17346, 17347, 17348, 17349, 17350, 17351, 17352, 22359, 12101, 14730, 14733, 17386, 23999, 17399, 17409, 6067, 17414, 17415, 6084, 6086, 21765, 18628, 18632, 14843, 6157, 18648, 4229, 9401, 3628, 6198, 6200, 18668, 2536, 2537, 2538, 2539, 18675, 2540, 2375, 3650, 12288, 2444, 2477, 2487, 2521, 2528, 2541, 2542, 2543, 2544, 21825, 2545, 2546, 2547, 2548, 2549, 2550, 2551, 2552, 2553, 2554, 2555, 2556, 2557, 2558, 2559, 2560, 2561, 2562, 2563, 2564, 2565, 2566, 2567, 2568, 2569, 2570, 2571, 2572, 2573, 2574, 2575, 2576, 2577, 2578, 2579, 2580, 2333, 2581, 2582, 2583, 2584, 2585, 2586, 2587, 2588, 2589, 2590, 2591, 2592, 2593, 2594, 3028, 3029, 3691, 3032, 3043, 12343, 3049, 3052, 21539, 21540, 3056, 21869, 3068, 3069, 25486, 21542, 14953, 3079, 3082, 21543, 21544, 3758, 22567, 18784, 18806, 21551, 17871, 17872, 6398, 17873, 17874, 17875, 17876, 3839, 17877, 17878, 17879, 17880, 17881, 17882, 17883, 17884, 17885, 17886, 17887, 17888, 17895, 17896, 17889, 17890, 17900, 17892, 17893, 17894, 3854, 17905, 17898, 17899, 17901, 17911, 17903, 17904, 17906, 17915, 17907, 17908, 17909, 17910, 17912, 17913, 17914, 17916, 17924, 17917, 17918, 17919, 17920, 17921, 17922, 17932, 17934, 17926, 17927, 17928, 17929, 17930, 17931, 17933, 17943, 17944, 17937, 17938, 17939, 17940, 17941, 17951, 17945, 17946, 17947, 17948, 17949, 17959, 17960, 3890, 17953, 17954, 17955, 17965, 17957, 17958, 17961, 17962, 17963, 17964, 17967, 3901, 6512, 12547, 20392, 3917, 3922, 18880, 2988, 6624, 2989, 18889, 2990, 2991, 3947, 2992, 2994, 12594, 2995, 22687, 2998, 18911, 18915, 18916, 9798, 16928, 3982, 16929, 16930, 3003, 16931, 3993, 6557, 4000, 22717, 6565, 4004, 16935, 16936, 16937, 16938, 6579, 20467, 16940, 16941, 16942, 16943, 16944, 16945, 3010, 16946, 16947, 6609, 16948, 16949, 6613, 21548, 3014, 16950, 20493, 16951, 16952, 3017, 16953, 9891, 16954, 20502, 16955, 16956, 16957, 16958, 16959, 3023, 16960, 16961, 20518, 16962, 18996, 4091, 6661, 19001, 4109, 19016, 20542, 19019, 6689, 6691, 4133, 20551, 19033, 19035, 20560, 9993, 20567, 20569, 19045, 20570, 80, 81, 22840, 103, 19070, 4193, 7702, 4216, 142, 19090, 19091, 145, 169, 171, 186, 19111, 4256, 199, 204, 159, 4272, 4287, 4291, 242, 245, 4296, 250, 251, 15444, 19150, 266, 277, 299, 311, 313, 317, 15478, 6913, 328, 19184, 347, 22953, 19193, 274, 21553, 6937, 365, 376, 377, 384, 4399, 385, 396, 6965, 400, 402, 15532, 415, 422, 432, 437, 20764, 442, 446, 455, 471, 7025, 481, 492, 494, 503, 506, 524, 519, 528, 7061, 20813, 20815, 4503, 550, 4520, 4524, 8244, 578, 10439, 4542, 595, 597, 13189, 612, 19336, 619, 13199, 605, 649, 8341, 662, 4595, 673, 19366, 19371, 698, 699, 15711, 8386, 15715, 714, 20910, 19403, 745, 15739, 19412, 8438, 771, 4672, 710, 19423, 791, 795, 796, 799, 820, 821, 20971, 7293, 17891, 9813, 7307, 9821, 9845, 20991, 7313, 7316, 17897, 20997, 7323, 20999, 17902, 10693, 7335, 10696, 21008, 15856, 15859, 17923, 17925, 15926, 13494, 15941, 4869, 19558, 17935, 15961, 17936, 17942, 19580, 23201, 21116, 17950, 17952, 17956, 7515, 8771, 23239, 16046, 5002, 7572, 13981, 7574, 7580, 8830, 8843, 19690, 16135, 7659, 21242, 7670, 16172, 5108, 21256, 21258, 7684, 21261, 7699, 19748, 25223, 20061, 22352, 7762, 21317, 5198, 11204, 19835, 11247, 9196, 19879, 11322, 16384, 23501, 25156, 11471, 23597, 1357, 1402, 1485, 1522, 1588, 1589, 1591, 1592, 1593, 1594, 1595, 1596, 1597, 23622, 1599, 1600, 1601, 1602, 1603, 1604, 1607, 1608, 1609, 1611, 1612, 1614, 1615, 1616, 1617, 1619, 1620, 1622, 1623, 1624, 23634, 1625, 1626, 1627, 1629, 1630, 1631, 1632, 5545, 1633, 1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 1651, 1652, 1653, 1654, 1655, 1656, 1657, 1658, 1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667, 1671, 1669, 1670, 1674, 1672, 1673, 1676, 1677, 1678, 1679, 1680, 1681, 1675, 1682, 1683, 1643, 14253, 5610, 11666, 1659, 1668], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling_nlh"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling_nlh"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling_nlh""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""forge.workflows.allegro_utils.pair_potential.NLH"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.7.0"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""forge.workflows.allegro_utils.pair_potential.NLH"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.11196376467940984,,,,,,0.013062813075437352,,,0.0021535137945774712,,5.416146602720103,,1069484.0,0.469845549134732,,,,1.0423542126134625e-05,,,,0.01720262427585141,,0.07923154643228672,,0.02111626530179777,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",183.0,,,,39299.970352746,,,,,,,,,,,3.90625e-06,,,,,,,1751503689.746696,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [11120, 18268, 23718, 14354, 14382, 25719, 8853, 21535, 8859, 8860, 8861, 8862, 21536, 8867, 8868, 8869, 21537, 21538, 8874, 8875, 8876, 8881, 8882, 8883, 8888, 8889, 8890, 21541, 8894, 8895, 8896, 8897, 16932, 8901, 8902, 8903, 8904, 16934, 8909, 21545, 8910, 8911, 21546, 8915, 8916, 8917, 8918, 21547, 8922, 8923, 8924, 8925, 21549, 8930, 21550, 8931, 8932, 21552, 8936, 8937, 8938, 5773, 8939, 8943, 8944, 8945, 8946, 21554, 8951, 8952, 8953, 21555, 21556, 21557, 21558, 21559, 8960, 21560, 8966, 21561, 8967, 8968, 21562, 8972, 8973, 8974, 8975, 21563, 8980, 21564, 8981, 8982, 21565, 8986, 8987, 8988, 8989, 17008, 17010, 18402, 16523, 16624, 16626, 16832, 3283, 16850, 18416, 9134, 3293, 16873, 18422, 16881, 5869, 3305, 16886, 3330, 3332, 18448, 3336, 5908, 3342, 22291, 11993, 9145, 3367, 3381, 5953, 3215, 5982, 3334, 17322, 17323, 6010, 17325, 17264, 17326, 17327, 17328, 17329, 17330, 17331, 17332, 17333, 17335, 17336, 17337, 17338, 17339, 17340, 17341, 17342, 17343, 17344, 17345, 17346, 17347, 17348, 17349, 17350, 17351, 17352, 22359, 12101, 14730, 14733, 17386, 23999, 17399, 17409, 6067, 17414, 17415, 6084, 6086, 21765, 18628, 18632, 14843, 6157, 18648, 4229, 9401, 3628, 6198, 6200, 18668, 2536, 2537, 2538, 2539, 18675, 2540, 2375, 3650, 12288, 2444, 2477, 2487, 2521, 2528, 2541, 2542, 2543, 2544, 21825, 2545, 2546, 2547, 2548, 2549, 2550, 2551, 2552, 2553, 2554, 2555, 2556, 2557, 2558, 2559, 2560, 2561, 2562, 2563, 2564, 2565, 2566, 2567, 2568, 2569, 2570, 2571, 2572, 2573, 2574, 2575, 2576, 2577, 2578, 2579, 2580, 2333, 2581, 2582, 2583, 2584, 2585, 2586, 2587, 2588, 2589, 2590, 2591, 2592, 2593, 2594, 3028, 3029, 3691, 3032, 3043, 12343, 3049, 3052, 21539, 21540, 3056, 21869, 3068, 3069, 25486, 21542, 14953, 3079, 3082, 21543, 21544, 3758, 22567, 18784, 18806, 21551, 17871, 17872, 6398, 17873, 17874, 17875, 17876, 3839, 17877, 17878, 17879, 17880, 17881, 17882, 17883, 17884, 17885, 17886, 17887, 17888, 17895, 17896, 17889, 17890, 17900, 17892, 17893, 17894, 3854, 17905, 17898, 17899, 17901, 17911, 17903, 17904, 17906, 17915, 17907, 17908, 17909, 17910, 17912, 17913, 17914, 17916, 17924, 17917, 17918, 17919, 17920, 17921, 17922, 17932, 17934, 17926, 17927, 17928, 17929, 17930, 17931, 17933, 17943, 17944, 17937, 17938, 17939, 17940, 17941, 17951, 17945, 17946, 17947, 17948, 17949, 17959, 17960, 3890, 17953, 17954, 17955, 17965, 17957, 17958, 17961, 17962, 17963, 17964, 17967, 3901, 6512, 12547, 20392, 3917, 3922, 18880, 2988, 6624, 2989, 18889, 2990, 2991, 3947, 2992, 2994, 12594, 2995, 22687, 2998, 18911, 18915, 18916, 9798, 16928, 3982, 16929, 16930, 3003, 16931, 3993, 6557, 4000, 22717, 6565, 4004, 16935, 16936, 16937, 16938, 6579, 20467, 16940, 16941, 16942, 16943, 16944, 16945, 3010, 16946, 16947, 6609, 16948, 16949, 6613, 21548, 3014, 16950, 20493, 16951, 16952, 3017, 16953, 9891, 16954, 20502, 16955, 16956, 16957, 16958, 16959, 3023, 16960, 16961, 20518, 16962, 18996, 4091, 6661, 19001, 4109, 19016, 20542, 19019, 6689, 6691, 4133, 20551, 19033, 19035, 20560, 9993, 20567, 20569, 19045, 20570, 80, 81, 22840, 103, 19070, 4193, 7702, 4216, 142, 19090, 19091, 145, 169, 171, 186, 19111, 4256, 199, 204, 159, 4272, 4287, 4291, 242, 245, 4296, 250, 251, 15444, 19150, 266, 277, 299, 311, 313, 317, 15478, 6913, 328, 19184, 347, 22953, 19193, 274, 21553, 6937, 365, 376, 377, 384, 4399, 385, 396, 6965, 400, 402, 15532, 415, 422, 432, 437, 20764, 442, 446, 455, 471, 7025, 481, 492, 494, 503, 506, 524, 519, 528, 7061, 20813, 20815, 4503, 550, 4520, 4524, 8244, 578, 10439, 4542, 595, 597, 13189, 612, 19336, 619, 13199, 605, 649, 8341, 662, 4595, 673, 19366, 19371, 698, 699, 15711, 8386, 15715, 714, 20910, 19403, 745, 15739, 19412, 8438, 771, 4672, 710, 19423, 791, 795, 796, 799, 820, 821, 20971, 7293, 17891, 9813, 7307, 9821, 9845, 20991, 7313, 7316, 17897, 20997, 7323, 20999, 17902, 10693, 7335, 10696, 21008, 15856, 15859, 17923, 17925, 15926, 13494, 15941, 4869, 19558, 17935, 15961, 17936, 17942, 19580, 23201, 21116, 17950, 17952, 17956, 7515, 8771, 23239, 16046, 5002, 7572, 13981, 7574, 7580, 8830, 8843, 19690, 16135, 7659, 21242, 7670, 16172, 5108, 21256, 21258, 7684, 21261, 7699, 19748, 25223, 20061, 22352, 7762, 21317, 5198, 11204, 19835, 11247, 9196, 19879, 11322, 16384, 23501, 25156, 11471, 23597, 1357, 1402, 1485, 1522, 1588, 1589, 1591, 1592, 1593, 1594, 1595, 1596, 1597, 23622, 1599, 1600, 1601, 1602, 1603, 1604, 1607, 1608, 1609, 1611, 1612, 1614, 1615, 1616, 1617, 1619, 1620, 1622, 1623, 1624, 23634, 1625, 1626, 1627, 1629, 1630, 1631, 1632, 5545, 1633, 1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 1651, 1652, 1653, 1654, 1655, 1656, 1657, 1658, 1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667, 1671, 1669, 1670, 1674, 1672, 1673, 1676, 1677, 1678, 1679, 1680, 1681, 1675, 1682, 1683, 1643, 14253, 5610, 11666, 1659, 1668], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling_nlh"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling_nlh"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling_nlh""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""forge.workflows.allegro_utils.pair_potential.NLH"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.7.0"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b,0.8797924112285814,,,,,0.00044562710427598475,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,214448.0,,0.014483170064781371,,,,1.691544783672952e-05,,,0.00021503360854552457,0.01589695440488711,,,,0.01639344262295082,0.0021329919148613805,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""forge.workflows.allegro_utils.pair_potential.NLH"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 39299},5.479819070986869,,0.052582389271266745,,,0.21127754039868551,,,,,,,,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.0023954606580971504,0.005300833596376827,,,,,2.137397957162239,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b/base_huber_q0.75_rare_sampling_nlh,5.0,2.0,1.0,float32,42.0,32.068671760720726,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_huber_q0.75_rare_sampling_train.xyz,data/base_huber_q0.75_rare_sampling_val.xyz,data/base_huber_q0.75_rare_sampling_test.xyz,d6bea18f,train:data/base_huber_q0.75_rare_sampling_train.xyz|val:data/base_huber_q0.75_rare_sampling_val.xyz|test:data/base_huber_q0.75_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=50)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,183.0,183.0
51,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,base_huber_q0.75_rare_sampling,27121.977153299,103543.0,1751493553.0339444,{'runtime': 27122},100.0,0.32814258451773615,0.36625958351537513,0.3055978319668887,3.90625e-06,0.19257872399574963,1.2488243759753863,0.06115765444384013,0.10902587132008336,0.012115759535048927,0.02474292029733767,0.4608643891976026,0.12835003405296955,0.08187640202251499,0.017836293362737992,0.07755586138356277,0.05071668770754759,0.0005656502102194162,0.00027041754105836587,0.016932118807217168,516200.0,0.1947615926329772,0.4861497890485908,0.06003576762272479,0.10555773094735955,0.012425451058132106,0.0271640066831578,0.20629050889303605,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10962293467426144,,,,,,0.03013387800251086,,,0.004982290538562677,,0.019372245099430953,,584300.0,0.10700740559857132,,,,1.9046378982179095e-05,,,,0.019200024670881225,,0.07771941244264077,,0.023290913727081676,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",100.0,,,,21957.0,,,,,,,,,,,0.0005,,,,,,,1751443241.361758,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [11120, 18268, 23718, 14354, 14382, 25719, 8853, 21535, 8859, 8860, 8861, 8862, 21536, 8867, 8868, 8869, 21537, 21538, 8874, 8875, 8876, 8881, 8882, 8883, 8888, 8889, 8890, 21541, 8894, 8895, 8896, 8897, 16932, 8901, 8902, 8903, 8904, 16934, 8909, 21545, 8910, 8911, 21546, 8915, 8916, 8917, 8918, 21547, 8922, 8923, 8924, 8925, 21549, 8930, 21550, 8931, 8932, 21552, 8936, 8937, 8938, 5773, 8939, 8943, 8944, 8945, 8946, 21554, 8951, 8952, 8953, 21555, 21556, 21557, 21558, 21559, 8960, 21560, 8966, 21561, 8967, 8968, 21562, 8972, 8973, 8974, 8975, 21563, 8980, 21564, 8981, 8982, 21565, 8986, 8987, 8988, 8989, 17008, 17010, 18402, 16523, 16624, 16626, 16832, 3283, 16850, 18416, 9134, 3293, 16873, 18422, 16881, 5869, 3305, 16886, 3330, 3332, 18448, 3336, 5908, 3342, 22291, 11993, 9145, 3367, 3381, 5953, 3215, 5982, 3334, 17322, 17323, 6010, 17325, 17264, 17326, 17327, 17328, 17329, 17330, 17331, 17332, 17333, 17335, 17336, 17337, 17338, 17339, 17340, 17341, 17342, 17343, 17344, 17345, 17346, 17347, 17348, 17349, 17350, 17351, 17352, 22359, 12101, 14730, 14733, 17386, 23999, 17399, 17409, 6067, 17414, 17415, 6084, 6086, 21765, 18628, 18632, 14843, 6157, 18648, 4229, 9401, 3628, 6198, 6200, 18668, 2536, 2537, 2538, 2539, 18675, 2540, 2375, 3650, 12288, 2444, 2477, 2487, 2521, 2528, 2541, 2542, 2543, 2544, 21825, 2545, 2546, 2547, 2548, 2549, 2550, 2551, 2552, 2553, 2554, 2555, 2556, 2557, 2558, 2559, 2560, 2561, 2562, 2563, 2564, 2565, 2566, 2567, 2568, 2569, 2570, 2571, 2572, 2573, 2574, 2575, 2576, 2577, 2578, 2579, 2580, 2333, 2581, 2582, 2583, 2584, 2585, 2586, 2587, 2588, 2589, 2590, 2591, 2592, 2593, 2594, 3028, 3029, 3691, 3032, 3043, 12343, 3049, 3052, 21539, 21540, 3056, 21869, 3068, 3069, 25486, 21542, 14953, 3079, 3082, 21543, 21544, 3758, 22567, 18784, 18806, 21551, 17871, 17872, 6398, 17873, 17874, 17875, 17876, 3839, 17877, 17878, 17879, 17880, 17881, 17882, 17883, 17884, 17885, 17886, 17887, 17888, 17895, 17896, 17889, 17890, 17900, 17892, 17893, 17894, 3854, 17905, 17898, 17899, 17901, 17911, 17903, 17904, 17906, 17915, 17907, 17908, 17909, 17910, 17912, 17913, 17914, 17916, 17924, 17917, 17918, 17919, 17920, 17921, 17922, 17932, 17934, 17926, 17927, 17928, 17929, 17930, 17931, 17933, 17943, 17944, 17937, 17938, 17939, 17940, 17941, 17951, 17945, 17946, 17947, 17948, 17949, 17959, 17960, 3890, 17953, 17954, 17955, 17965, 17957, 17958, 17961, 17962, 17963, 17964, 17967, 3901, 6512, 12547, 20392, 3917, 3922, 18880, 2988, 6624, 2989, 18889, 2990, 2991, 3947, 2992, 2994, 12594, 2995, 22687, 2998, 18911, 18915, 18916, 9798, 16928, 3982, 16929, 16930, 3003, 16931, 3993, 6557, 4000, 22717, 6565, 4004, 16935, 16936, 16937, 16938, 6579, 20467, 16940, 16941, 16942, 16943, 16944, 16945, 3010, 16946, 16947, 6609, 16948, 16949, 6613, 21548, 3014, 16950, 20493, 16951, 16952, 3017, 16953, 9891, 16954, 20502, 16955, 16956, 16957, 16958, 16959, 3023, 16960, 16961, 20518, 16962, 18996, 4091, 6661, 19001, 4109, 19016, 20542, 19019, 6689, 6691, 4133, 20551, 19033, 19035, 20560, 9993, 20567, 20569, 19045, 20570, 80, 81, 22840, 103, 19070, 4193, 7702, 4216, 142, 19090, 19091, 145, 169, 171, 186, 19111, 4256, 199, 204, 159, 4272, 4287, 4291, 242, 245, 4296, 250, 251, 15444, 19150, 266, 277, 299, 311, 313, 317, 15478, 6913, 328, 19184, 347, 22953, 19193, 274, 21553, 6937, 365, 376, 377, 384, 4399, 385, 396, 6965, 400, 402, 15532, 415, 422, 432, 437, 20764, 442, 446, 455, 471, 7025, 481, 492, 494, 503, 506, 524, 519, 528, 7061, 20813, 20815, 4503, 550, 4520, 4524, 8244, 578, 10439, 4542, 595, 597, 13189, 612, 19336, 619, 13199, 605, 649, 8341, 662, 4595, 673, 19366, 19371, 698, 699, 15711, 8386, 15715, 714, 20910, 19403, 745, 15739, 19412, 8438, 771, 4672, 710, 19423, 791, 795, 796, 799, 820, 821, 20971, 7293, 17891, 9813, 7307, 9821, 9845, 20991, 7313, 7316, 17897, 20997, 7323, 20999, 17902, 10693, 7335, 10696, 21008, 15856, 15859, 17923, 17925, 15926, 13494, 15941, 4869, 19558, 17935, 15961, 17936, 17942, 19580, 23201, 21116, 17950, 17952, 17956, 7515, 8771, 23239, 16046, 5002, 7572, 13981, 7574, 7580, 8830, 8843, 19690, 16135, 7659, 21242, 7670, 16172, 5108, 21256, 21258, 7684, 21261, 7699, 19748, 25223, 20061, 22352, 7762, 21317, 5198, 11204, 19835, 11247, 9196, 19879, 11322, 16384, 23501, 25156, 11471, 23597, 1357, 1402, 1485, 1522, 1588, 1589, 1591, 1592, 1593, 1594, 1595, 1596, 1597, 23622, 1599, 1600, 1601, 1602, 1603, 1604, 1607, 1608, 1609, 1611, 1612, 1614, 1615, 1616, 1617, 1619, 1620, 1622, 1623, 1624, 23634, 1625, 1626, 1627, 1629, 1630, 1631, 1632, 5545, 1633, 1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 1651, 1652, 1653, 1654, 1655, 1656, 1657, 1658, 1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667, 1671, 1669, 1670, 1674, 1672, 1673, 1676, 1677, 1678, 1679, 1680, 1681, 1675, 1682, 1683, 1643, 14253, 5610, 11666, 1659, 1668], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.7.0"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b,0.20545144909598131,,,,,0.0008980968466555684,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,117163.0,,0.02206854956930009,,,,2.5757420097215103e-05,,,0.0016286238781057815,0.002150387585049,,,,0.01639344262295082,0.0022664556672577427,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 21957},0.023300801262591896,,0.004879041206476031,,,0.2043019471292036,,,,,,,,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.003653630549910117,0.0055653764716371125,,,,,0.07787709718834974,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/base_huber_q0.75_rare_sampling,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_huber_q0.75_rare_sampling_train.xyz,data/base_huber_q0.75_rare_sampling_val.xyz,data/base_huber_q0.75_rare_sampling_test.xyz,d6bea18f,train:data/base_huber_q0.75_rare_sampling_train.xyz|val:data/base_huber_q0.75_rare_sampling_val.xyz|test:data/base_huber_q0.75_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
52,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,base_huber_q0.75_rare_sampling,27121.977153299,103543.0,1751493553.0339444,{'runtime': 27122},100.0,0.32814258451773615,0.36625958351537513,0.3055978319668887,3.90625e-06,0.19257872399574963,1.2488243759753863,0.06115765444384013,0.10902587132008336,0.012115759535048927,0.02474292029733767,0.4608643891976026,0.12835003405296955,0.08187640202251499,0.017836293362737992,0.07755586138356277,0.05071668770754759,0.0005656502102194162,0.00027041754105836587,0.016932118807217168,516200.0,0.1947615926329772,0.4861497890485908,0.06003576762272479,0.10555773094735955,0.012425451058132106,0.0271640066831578,0.20629050889303605,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10962293467426144,,,,,,0.05071668770754759,,,0.016932118807217168,,0.06115765444384013,,516200.0,0.19257872399574963,,,,0.00027041754105836587,,,,0.06003576762272479,,0.20629050889303605,,0.10555773094735955,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27121.977153299,,,,,,,,,,,3.90625e-06,,,,,,,1751493553.0339444,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,1.2488243759753863,,,,,0.08187640202251499,0.3055978319668887,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103543.0,,0.12835003405296955,,,,0.017836293362737992,,,0.0005656502102194162,0.012115759535048927,,,,0.36625958351537513,0.012425451058132106,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27122},0.10902587132008336,,0.02474292029733767,,,0.4861497890485908,,,,,,,,,0.32814258451773615,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.07755586138356277,0.0271640066831578,,,,,0.4608643891976026,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/base_huber_q0.75_rare_sampling,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_huber_q0.75_rare_sampling_train.xyz,data/base_huber_q0.75_rare_sampling_val.xyz,data/base_huber_q0.75_rare_sampling_test.xyz,d6bea18f,train:data/base_huber_q0.75_rare_sampling_train.xyz|val:data/base_huber_q0.75_rare_sampling_val.xyz|test:data/base_huber_q0.75_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
53,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,base_huber_q0.75_rare_sampling,27121.977153299,103543.0,1751493553.0339444,{'runtime': 27122},100.0,0.32814258451773615,0.36625958351537513,0.3055978319668887,3.90625e-06,0.19257872399574963,1.2488243759753863,0.06115765444384013,0.10902587132008336,0.012115759535048927,0.02474292029733767,0.4608643891976026,0.12835003405296955,0.08187640202251499,0.017836293362737992,0.07755586138356277,0.05071668770754759,0.0005656502102194162,0.00027041754105836587,0.016932118807217168,516200.0,0.1947615926329772,0.4861497890485908,0.06003576762272479,0.10555773094735955,0.012425451058132106,0.0271640066831578,0.20629050889303605,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.1947615926329772,,,,,,0.03013387800251086,,,0.004982290538562677,,0.019372245099430953,,584300.0,0.10700740559857132,,,,1.9046378982179095e-05,,,,0.019200024670881225,,0.07771941244264077,,0.023290913727081676,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",100.0,,,,21957.0,,,,,,,,,,,0.0005,,,,,,,1751443241.361758,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [11120, 18268, 23718, 14354, 14382, 25719, 8853, 21535, 8859, 8860, 8861, 8862, 21536, 8867, 8868, 8869, 21537, 21538, 8874, 8875, 8876, 8881, 8882, 8883, 8888, 8889, 8890, 21541, 8894, 8895, 8896, 8897, 16932, 8901, 8902, 8903, 8904, 16934, 8909, 21545, 8910, 8911, 21546, 8915, 8916, 8917, 8918, 21547, 8922, 8923, 8924, 8925, 21549, 8930, 21550, 8931, 8932, 21552, 8936, 8937, 8938, 5773, 8939, 8943, 8944, 8945, 8946, 21554, 8951, 8952, 8953, 21555, 21556, 21557, 21558, 21559, 8960, 21560, 8966, 21561, 8967, 8968, 21562, 8972, 8973, 8974, 8975, 21563, 8980, 21564, 8981, 8982, 21565, 8986, 8987, 8988, 8989, 17008, 17010, 18402, 16523, 16624, 16626, 16832, 3283, 16850, 18416, 9134, 3293, 16873, 18422, 16881, 5869, 3305, 16886, 3330, 3332, 18448, 3336, 5908, 3342, 22291, 11993, 9145, 3367, 3381, 5953, 3215, 5982, 3334, 17322, 17323, 6010, 17325, 17264, 17326, 17327, 17328, 17329, 17330, 17331, 17332, 17333, 17335, 17336, 17337, 17338, 17339, 17340, 17341, 17342, 17343, 17344, 17345, 17346, 17347, 17348, 17349, 17350, 17351, 17352, 22359, 12101, 14730, 14733, 17386, 23999, 17399, 17409, 6067, 17414, 17415, 6084, 6086, 21765, 18628, 18632, 14843, 6157, 18648, 4229, 9401, 3628, 6198, 6200, 18668, 2536, 2537, 2538, 2539, 18675, 2540, 2375, 3650, 12288, 2444, 2477, 2487, 2521, 2528, 2541, 2542, 2543, 2544, 21825, 2545, 2546, 2547, 2548, 2549, 2550, 2551, 2552, 2553, 2554, 2555, 2556, 2557, 2558, 2559, 2560, 2561, 2562, 2563, 2564, 2565, 2566, 2567, 2568, 2569, 2570, 2571, 2572, 2573, 2574, 2575, 2576, 2577, 2578, 2579, 2580, 2333, 2581, 2582, 2583, 2584, 2585, 2586, 2587, 2588, 2589, 2590, 2591, 2592, 2593, 2594, 3028, 3029, 3691, 3032, 3043, 12343, 3049, 3052, 21539, 21540, 3056, 21869, 3068, 3069, 25486, 21542, 14953, 3079, 3082, 21543, 21544, 3758, 22567, 18784, 18806, 21551, 17871, 17872, 6398, 17873, 17874, 17875, 17876, 3839, 17877, 17878, 17879, 17880, 17881, 17882, 17883, 17884, 17885, 17886, 17887, 17888, 17895, 17896, 17889, 17890, 17900, 17892, 17893, 17894, 3854, 17905, 17898, 17899, 17901, 17911, 17903, 17904, 17906, 17915, 17907, 17908, 17909, 17910, 17912, 17913, 17914, 17916, 17924, 17917, 17918, 17919, 17920, 17921, 17922, 17932, 17934, 17926, 17927, 17928, 17929, 17930, 17931, 17933, 17943, 17944, 17937, 17938, 17939, 17940, 17941, 17951, 17945, 17946, 17947, 17948, 17949, 17959, 17960, 3890, 17953, 17954, 17955, 17965, 17957, 17958, 17961, 17962, 17963, 17964, 17967, 3901, 6512, 12547, 20392, 3917, 3922, 18880, 2988, 6624, 2989, 18889, 2990, 2991, 3947, 2992, 2994, 12594, 2995, 22687, 2998, 18911, 18915, 18916, 9798, 16928, 3982, 16929, 16930, 3003, 16931, 3993, 6557, 4000, 22717, 6565, 4004, 16935, 16936, 16937, 16938, 6579, 20467, 16940, 16941, 16942, 16943, 16944, 16945, 3010, 16946, 16947, 6609, 16948, 16949, 6613, 21548, 3014, 16950, 20493, 16951, 16952, 3017, 16953, 9891, 16954, 20502, 16955, 16956, 16957, 16958, 16959, 3023, 16960, 16961, 20518, 16962, 18996, 4091, 6661, 19001, 4109, 19016, 20542, 19019, 6689, 6691, 4133, 20551, 19033, 19035, 20560, 9993, 20567, 20569, 19045, 20570, 80, 81, 22840, 103, 19070, 4193, 7702, 4216, 142, 19090, 19091, 145, 169, 171, 186, 19111, 4256, 199, 204, 159, 4272, 4287, 4291, 242, 245, 4296, 250, 251, 15444, 19150, 266, 277, 299, 311, 313, 317, 15478, 6913, 328, 19184, 347, 22953, 19193, 274, 21553, 6937, 365, 376, 377, 384, 4399, 385, 396, 6965, 400, 402, 15532, 415, 422, 432, 437, 20764, 442, 446, 455, 471, 7025, 481, 492, 494, 503, 506, 524, 519, 528, 7061, 20813, 20815, 4503, 550, 4520, 4524, 8244, 578, 10439, 4542, 595, 597, 13189, 612, 19336, 619, 13199, 605, 649, 8341, 662, 4595, 673, 19366, 19371, 698, 699, 15711, 8386, 15715, 714, 20910, 19403, 745, 15739, 19412, 8438, 771, 4672, 710, 19423, 791, 795, 796, 799, 820, 821, 20971, 7293, 17891, 9813, 7307, 9821, 9845, 20991, 7313, 7316, 17897, 20997, 7323, 20999, 17902, 10693, 7335, 10696, 21008, 15856, 15859, 17923, 17925, 15926, 13494, 15941, 4869, 19558, 17935, 15961, 17936, 17942, 19580, 23201, 21116, 17950, 17952, 17956, 7515, 8771, 23239, 16046, 5002, 7572, 13981, 7574, 7580, 8830, 8843, 19690, 16135, 7659, 21242, 7670, 16172, 5108, 21256, 21258, 7684, 21261, 7699, 19748, 25223, 20061, 22352, 7762, 21317, 5198, 11204, 19835, 11247, 9196, 19879, 11322, 16384, 23501, 25156, 11471, 23597, 1357, 1402, 1485, 1522, 1588, 1589, 1591, 1592, 1593, 1594, 1595, 1596, 1597, 23622, 1599, 1600, 1601, 1602, 1603, 1604, 1607, 1608, 1609, 1611, 1612, 1614, 1615, 1616, 1617, 1619, 1620, 1622, 1623, 1624, 23634, 1625, 1626, 1627, 1629, 1630, 1631, 1632, 5545, 1633, 1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 1651, 1652, 1653, 1654, 1655, 1656, 1657, 1658, 1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667, 1671, 1669, 1670, 1674, 1672, 1673, 1676, 1677, 1678, 1679, 1680, 1681, 1675, 1682, 1683, 1643, 14253, 5610, 11666, 1659, 1668], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.7.0"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b,0.20545144909598131,,,,,0.0008980968466555684,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,117163.0,,0.02206854956930009,,,,2.5757420097215103e-05,,,0.0016286238781057815,0.002150387585049,,,,0.01639344262295082,0.0022664556672577427,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.068671760720726, ""compile_mode"": ""compile"", ""l_max"": 1, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.38435731211423, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 21957},0.023300801262591896,,0.004879041206476031,,,0.2043019471292036,,,,,,,,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.003653630549910117,0.0055653764716371125,,,,,0.07787709718834974,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/base_huber_q0.75_rare_sampling,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_huber_q0.75_rare_sampling_train.xyz,data/base_huber_q0.75_rare_sampling_val.xyz,data/base_huber_q0.75_rare_sampling_test.xyz,d6bea18f,train:data/base_huber_q0.75_rare_sampling_train.xyz|val:data/base_huber_q0.75_rare_sampling_val.xyz|test:data/base_huber_q0.75_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
54,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,base_huber_q0.75_rare_sampling,27121.977153299,103543.0,1751493553.0339444,{'runtime': 27122},100.0,0.32814258451773615,0.36625958351537513,0.3055978319668887,3.90625e-06,0.19257872399574963,1.2488243759753863,0.06115765444384013,0.10902587132008336,0.012115759535048927,0.02474292029733767,0.4608643891976026,0.12835003405296955,0.08187640202251499,0.017836293362737992,0.07755586138356277,0.05071668770754759,0.0005656502102194162,0.00027041754105836587,0.016932118807217168,516200.0,0.1947615926329772,0.4861497890485908,0.06003576762272479,0.10555773094735955,0.012425451058132106,0.0271640066831578,0.20629050889303605,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.1947615926329772,,,,,,0.05071668770754759,,,0.016932118807217168,,0.06115765444384013,,516200.0,0.19257872399574963,,,,0.00027041754105836587,,,,0.06003576762272479,,0.20629050889303605,,0.10555773094735955,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27121.977153299,,,,,,,,,,,3.90625e-06,,,,,,,1751493553.0339444,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.75_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.75_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.75_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/base_huber_q0.75_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,1.2488243759753863,,,,,0.08187640202251499,0.3055978319668887,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103543.0,,0.12835003405296955,,,,0.017836293362737992,,,0.0005656502102194162,0.012115759535048927,,,,0.36625958351537513,0.012425451058132106,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27122},0.10902587132008336,,0.02474292029733767,,,0.4861497890485908,,,,,,,,,0.32814258451773615,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.07755586138356277,0.0271640066831578,,,,,0.4608643891976026,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/base_huber_q0.75_rare_sampling,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_huber_q0.75_rare_sampling_train.xyz,data/base_huber_q0.75_rare_sampling_val.xyz,data/base_huber_q0.75_rare_sampling_test.xyz,d6bea18f,train:data/base_huber_q0.75_rare_sampling_train.xyz|val:data/base_huber_q0.75_rare_sampling_val.xyz|test:data/base_huber_q0.75_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
55,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,huber_q0.65_auto_delta_rare_sampling,27628.972985787,103543.0,1751521289.3071978,{'runtime': 27629},100.0,0.3791141390836134,0.1726248361677585,0.4482610247486281,7.8125e-06,0.20764223504922255,1.5201989507198197,0.04907894086522296,0.09316735153140404,0.006991843066606158,0.017265293522132432,0.5435438652577854,0.11721083188376494,0.4813827253113782,0.018541779779038956,0.13584645491616887,0.04630296611909621,0.0006004569019809143,0.00014931889288087927,0.01772469675152625,516200.0,0.21162727226982883,0.4692747174648776,0.051631159954226534,0.09521008949002197,0.007536981368762284,0.021846056207968766,0.19544362105428945,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.65_auto_delta_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.65_auto_delta_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.65_auto_delta_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.65_auto_delta_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""forge.workflows.allegro_utils.callbacks.DeltaLoggerCallback""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.65_auto_delta_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.65_auto_delta_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",0.36511053831327667,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.21162727226982883,,,,,,0.04630296611909621,,,0.01772469675152625,,0.04907894086522296,0.36511053831327667,516200.0,0.20764223504922255,,,,0.00014931889288087927,,,,0.051631159954226534,,0.19544362105428945,,0.09521008949002197,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27628.972985787,,,,,,,,,,,7.8125e-06,,,,,,,1751521289.3071978,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.65_auto_delta_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.65_auto_delta_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.65_auto_delta_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.65_auto_delta_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""forge.workflows.allegro_utils.callbacks.DeltaLoggerCallback""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.65_auto_delta_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.65_auto_delta_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,1.5201989507198197,,,,,0.4813827253113782,0.4482610247486281,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103543.0,,0.11721083188376494,,,,0.018541779779038956,,,0.0006004569019809143,0.006991843066606158,,,,0.1726248361677585,0.007536981368762284,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27629},0.09316735153140404,,0.017265293522132432,,,0.4692747174648776,,,,,,,,,0.3791141390836134,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.13584645491616887,0.021846056207968766,,,,,0.5435438652577854,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/huber_q0.65_auto_delta_rare_sampling,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.65_auto_delta_rare_sampling_train.xyz,data/huber_q0.65_auto_delta_rare_sampling_val.xyz,data/huber_q0.65_auto_delta_rare_sampling_test.xyz,b074ba44,train:data/huber_q0.65_auto_delta_rare_sampling_train.xyz|val:data/huber_q0.65_auto_delta_rare_sampling_val.xyz|test:data/huber_q0.65_auto_delta_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|DeltaLoggerCallback|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
56,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,huber_q0.65_rare_sampling,29744.892052947,103543.0,1751551141.0666585,{'runtime': 29745},100.0,0.25365316442108043,0.3722843630153233,0.3740624725635964,3.90625e-06,0.19939966803132744,2.091237709768019,0.04884801997226206,0.09459835553710016,0.013859213885893276,0.02810717732175184,0.7379810808756236,0.10899616459321002,0.0471993758970996,0.016462735728056756,0.05137690328099914,0.046509441678495904,0.000604553555908276,0.00019445005078361232,0.012095069359464368,516200.0,0.19861473394086265,0.42579103952428704,0.04846866075260268,0.08792874741256107,0.013911485504780004,0.02957352973654605,0.18109777222446471,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.65_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.65_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.65_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.65_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.65_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.65_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.19861473394086265,,,,,,0.046509441678495904,,,0.012095069359464368,,0.04884801997226206,,516200.0,0.19939966803132744,,,,0.00019445005078361232,,,,0.04846866075260268,,0.18109777222446471,,0.08792874741256107,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}",100.0,,,,29744.892052947,,,,,,,,,,,3.90625e-06,,,,,,,1751551141.0666585,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.65_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.65_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.65_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.65_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.65_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.65_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,2.091237709768019,,,,,0.0471993758970996,0.3740624725635964,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103543.0,,0.10899616459321002,,,,0.016462735728056756,,,0.000604553555908276,0.013859213885893276,,,,0.3722843630153233,0.013911485504780004,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 29745},0.09459835553710016,,0.02810717732175184,,,0.42579103952428704,,,,,,,,,0.25365316442108043,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.05137690328099914,0.02957352973654605,,,,,0.7379810808756236,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/huber_q0.65_rare_sampling,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.65_rare_sampling_train.xyz,data/huber_q0.65_rare_sampling_val.xyz,data/huber_q0.65_rare_sampling_test.xyz,4e074489,train:data/huber_q0.65_rare_sampling_train.xyz|val:data/huber_q0.65_rare_sampling_val.xyz|test:data/huber_q0.65_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
57,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,base_huber_q0.75_no_sampler,40304.710775329,103543.0,1751580378.0158422,{'runtime': 40304},100.0,0.3333333333333333,0.3333333333333333,0.3333333333333333,3.90625e-06,0.2349199665641544,2.297969123572164,0.11423887680930386,0.18196667977174016,0.009633018726996031,0.02194826581070507,0.8339613563848696,0.13829687998828297,0.10189494597732252,0.015319016550205997,0.08517028083860381,0.15895419476059044,0.0016561738746826192,0.0002372220138765328,0.05361586354971653,516200.0,0.2357073585854557,0.5952202039226686,0.12069897376796088,0.188515688203663,0.01013438499818096,0.025755330031839618,0.26983040738605707,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.75_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.75_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.75_no_sampler_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_no_sampler"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/base_huber_q0.75_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.2357073585854557,,,,,,0.15895419476059044,,,0.05361586354971653,,0.11423887680930386,,516200.0,0.2349199665641544,,,,0.0002372220138765328,,,,0.12069897376796088,,0.26983040738605707,,0.188515688203663,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",100.0,,,,40304.710775329,,,,,,,,,,,3.90625e-06,,,,,,,1751580378.0158422,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.75_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.75_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.75_no_sampler_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""base_huber_q0.75_no_sampler"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/base_huber_q0.75_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,2.297969123572164,,,,,0.10189494597732252,0.3333333333333333,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103543.0,,0.13829687998828297,,,,0.015319016550205997,,,0.0016561738746826192,0.009633018726996031,,,,0.3333333333333333,0.01013438499818096,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 40304},0.18196667977174016,,0.02194826581070507,,,0.5952202039226686,,,,,,,,,0.3333333333333333,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.08517028083860381,0.025755330031839618,,,,,0.8339613563848696,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/base_huber_q0.75_no_sampler,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_huber_q0.75_no_sampler_train.xyz,data/base_huber_q0.75_no_sampler_val.xyz,data/base_huber_q0.75_no_sampler_test.xyz,a6442fe8,train:data/base_huber_q0.75_no_sampler_train.xyz|val:data/base_huber_q0.75_no_sampler_val.xyz|test:data/base_huber_q0.75_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=1),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
58,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,huber_q0.85_rare_sampling,27223.893185831,103543.0,1751578470.7956803,{'runtime': 27224},100.0,0.2938278376957023,0.3796101609649174,0.32656200133938035,3.90625e-06,0.1987573675745534,1.278432103962787,0.05250154717693558,0.08704150203659579,0.011439816605070596,0.02378775921928318,0.4630871217395553,0.1408767356094206,0.2594354609269759,0.01805672185260557,0.14577448291405748,0.0653028466144636,0.0005711161995599731,0.0002722828670905252,0.019493512966554095,516200.0,0.201030216640029,0.4711439387077011,0.05251628302659434,0.08713191594234171,0.011906557119822213,0.027727935044285605,0.19533459656477617,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10415636207441492,,,,,,0.009536574100866387,,,0.0015749672158386688,,0.01940781377793282,,573800.0,0.10071845964276048,,,,7.125805434982514e-06,,,,0.020247996086599423,,0.08281244580155335,,0.03938619633342144,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}",100.0,,,,45655.283691778,,,,,0.2185244922226943,,,0.00572410289284633,,,0.00025,,,,,,,1751395125.814844,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz"", ""data/huber_q0.85_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.19025008036494068,,,,,0.0008664083106257384,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,115063.0,0.0028188164372307156,0.02091012328667329,0.5185220064174889,,,2.177598916834802e-05,0.14724314276224035,,0.0003509688857457914,0.0020072829707943954,,,,0.01639344262295082,0.002226042503479916,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 45655},0.02523645571036659,,0.004333104540568548,,,0.2037011641141922,,,,,,0.030489752369354237,0.1313273673577477,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.00345994164976682,0.005349976957046467,,,,,0.07327321353862526,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/huber_q0.85_rare_sampling,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.85_rare_sampling_train.xyz,data/huber_q0.85_rare_sampling_val.xyz,data/huber_q0.85_rare_sampling_test.xyz,22be564f,train:data/huber_q0.85_rare_sampling_train.xyz|val:data/huber_q0.85_rare_sampling_val.xyz|test:data/huber_q0.85_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
59,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,huber_q0.85_rare_sampling,27223.893185831,103543.0,1751578470.7956803,{'runtime': 27224},100.0,0.2938278376957023,0.3796101609649174,0.32656200133938035,3.90625e-06,0.1987573675745534,1.278432103962787,0.05250154717693558,0.08704150203659579,0.011439816605070596,0.02378775921928318,0.4630871217395553,0.1408767356094206,0.2594354609269759,0.01805672185260557,0.14577448291405748,0.0653028466144636,0.0005711161995599731,0.0002722828670905252,0.019493512966554095,516200.0,0.201030216640029,0.4711439387077011,0.05251628302659434,0.08713191594234171,0.011906557119822213,0.027727935044285605,0.19533459656477617,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.10415636207441492,,,,,,0.0653028466144636,,,0.019493512966554095,,0.05250154717693558,,516200.0,0.1987573675745534,,,,0.0002722828670905252,,,,0.05251628302659434,,0.19533459656477617,,0.08713191594234171,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27223.893185831,,,,,,,,,,,3.90625e-06,,,,,,,1751578470.7956803,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,1.278432103962787,,,,,0.2594354609269759,0.32656200133938035,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103543.0,,0.1408767356094206,,,,0.01805672185260557,,,0.0005711161995599731,0.011439816605070596,,,,0.3796101609649174,0.011906557119822213,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27224},0.08704150203659579,,0.02378775921928318,,,0.4711439387077011,,,,,,,,,0.2938278376957023,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.14577448291405748,0.027727935044285605,,,,,0.4630871217395553,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/huber_q0.85_rare_sampling,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.85_rare_sampling_train.xyz,data/huber_q0.85_rare_sampling_val.xyz,data/huber_q0.85_rare_sampling_test.xyz,22be564f,train:data/huber_q0.85_rare_sampling_train.xyz|val:data/huber_q0.85_rare_sampling_val.xyz|test:data/huber_q0.85_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
60,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,huber_q0.85_rare_sampling,27223.893185831,103543.0,1751578470.7956803,{'runtime': 27224},100.0,0.2938278376957023,0.3796101609649174,0.32656200133938035,3.90625e-06,0.1987573675745534,1.278432103962787,0.05250154717693558,0.08704150203659579,0.011439816605070596,0.02378775921928318,0.4630871217395553,0.1408767356094206,0.2594354609269759,0.01805672185260557,0.14577448291405748,0.0653028466144636,0.0005711161995599731,0.0002722828670905252,0.019493512966554095,516200.0,0.201030216640029,0.4711439387077011,0.05251628302659434,0.08713191594234171,0.011906557119822213,0.027727935044285605,0.19533459656477617,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.201030216640029,,,,,,0.009536574100866387,,,0.0015749672158386688,,0.01940781377793282,,573800.0,0.10071845964276048,,,,7.125805434982514e-06,,,,0.020247996086599423,,0.08281244580155335,,0.03938619633342144,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}",100.0,,,,45655.283691778,,,,,0.2185244922226943,,,0.00572410289284633,,,0.00025,,,,,,,1751395125.814844,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [24577, 418, 7560, 422, 424, 17534, 17535, 16233, 17538, 15055, 9366, 9367, 6421, 9374, 9375, 454, 460, 461, 9382, 9383, 21610, 9392, 19148, 9399, 9400, 20535, 470, 9409, 472, 9416, 20564, 9425, 20778, 480, 21040, 9443, 9451, 9452, 26578, 9469, 22379, 9477, 9478, 9479, 9488, 5725, 9496, 9497, 506, 5994, 9515, 22394, 9521, 9524, 9529, 9530, 22396, 22397, 9536, 9537, 17607, 17643, 22399, 9543, 9544, 17608, 528, 17646, 9550, 17647, 532, 9551, 9552, 17648, 17650, 9558, 9559, 17651, 17657, 17655, 9565, 17658, 22405, 9571, 22406, 17662, 9573, 17663, 17664, 9578, 9579, 545, 9580, 9584, 7656, 9586, 9587, 21659, 9592, 22409, 17670, 9594, 21661, 9598, 9599, 9600, 6365, 17677, 17678, 9606, 17682, 9608, 9614, 22414, 22416, 22418, 9628, 9629, 9630, 9634, 9635, 9636, 22423, 9643, 5111, 22424, 8839, 17728, 624, 639, 19242, 17327, 676, 682, 17542, 3870, 692, 9796, 3880, 703, 17591, 3892, 17596, 730, 731, 16412, 16416, 20243, 779, 781, 12679, 786, 9807, 20252, 9052, 3954, 742, 20263, 829, 17963, 833, 834, 837, 838, 859, 860, 21817, 18053, 18058, 18059, 18061, 18063, 18064, 17966, 17967, 17968, 18067, 10475, 17993, 21837, 18078, 18081, 7911, 18082, 18085, 18088, 18091, 18093, 23218, 11355, 7930, 16557, 15431, 2453, 2454, 2458, 12527, 18131, 18144, 18154, 6679, 6681, 14189, 16642, 5456, 20398, 16662, 22624, 19472, 6752, 20420, 24060, 19488, 2661, 4816, 2668, 2672, 2674, 2678, 4215, 12638, 12653, 12661, 12709, 2681, 6795, 2683, 2685, 19508, 2689, 12733, 18375, 2693, 18381, 19515, 2697, 2501, 4237, 2603, 2647, 2654, 2698, 2699, 3146, 2702, 22684, 3149, 2705, 3151, 2707, 24098, 2709, 2710, 3152, 2712, 3155, 2714, 2715, 3160, 2717, 2718, 2720, 2722, 2724, 2725, 2726, 2728, 2729, 2730, 2731, 3167, 2734, 2737, 2450, 2738, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2749, 2750, 3189, 8167, 14676, 8169, 3209, 8175, 3248, 3263, 3269, 4345, 23426, 3300, 18617, 18632, 18634, 22088, 22407, 18637, 18638, 18639, 18640, 3325, 18642, 18646, 3335, 16873, 5696, 18657, 18658, 22102, 18663, 18664, 3350, 18666, 8279, 18668, 22107, 18673, 18674, 19646, 18682, 18683, 18684, 18685, 18687, 18689, 18691, 18692, 3372, 6993, 18693, 20590, 3376, 18699, 3378, 18700, 18701, 18703, 18704, 18705, 18708, 18710, 18712, 18716, 18720, 18722, 18724, 3398, 18728, 3402, 18730, 18731, 18732, 18734, 18735, 18736, 18737, 18738, 18741, 18743, 18744, 18745, 18746, 18749, 3422, 18754, 18755, 18756, 18758, 3427, 18762, 18763, 18764, 3429, 18765, 18767, 18769, 18770, 3434, 18772, 18773, 18775, 18779, 18780, 18781, 18782, 18785, 18787, 8357, 22163, 7107, 13242, 21238, 3473, 4504, 4509, 3487, 11880, 19720, 3494, 7219, 4534, 3524, 13289, 11923, 19751, 4569, 3568, 3571, 3581, 4587, 23576, 4591, 1377, 1378, 20722, 1379, 1382, 1383, 3596, 1385, 1387, 1388, 1389, 1390, 21313, 3610, 11998, 3633, 17665, 3637, 7204, 17669, 3657, 17672, 24360, 17674, 17675, 19080, 19836, 4678, 19090, 19091, 19092, 19098, 4696, 19856, 19859, 7284, 19873, 19875, 21406, 12147, 14759, 81, 83, 84, 86, 94, 14812, 1648, 11596, 11612, 11620, 4780, 19910, 11644, 11628, 11636, 26082, 1652, 1653, 1654, 1656, 1657, 1658, 1659, 24456, 11669, 11660, 1661, 1665, 1666, 1667, 1668, 1669, 1673, 137, 1675, 1676, 1678, 4803, 1681, 1686, 1687, 152, 1689, 19930, 155, 1693, 1694, 1696, 1702, 1415, 1543, 1680, 1707, 181, 1710, 1711, 1712, 24481, 1714, 1715, 1717, 1718, 1722, 1723, 197, 1726, 19951, 1730, 1731, 1732, 1737, 1739, 1740, 1741, 215, 1745, 1746, 6137, 1747, 169, 1748, 1750, 1754, 22338, 1755, 1756, 8930, 228, 8938, 1760, 1764, 1767, 1768, 1770, 1771, 1772, 1774, 1776, 1777, 1778, 1782, 4874, 1788, 4878, 1791, 1794, 1796, 1797, 265, 14954, 293, 315, 328, 335, 337, 347, 20024, 333], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz"", ""data/huber_q0.85_rare_sampling_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val1_epoch/forces_mae"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study,0.19025008036494068,,,,,0.0008664083106257384,0.819672131147541,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,115063.0,0.0028188164372307156,0.02091012328667329,0.5185220064174889,,,2.177598916834802e-05,0.14724314276224035,,0.0003509688857457914,0.0020072829707943954,,,,0.01639344262295082,0.002226042503479916,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.03126333894399, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.5762741643343685, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 45655},0.02523645571036659,,0.004333104540568548,,,0.2037011641141922,,,,,,0.030489752369354237,0.1313273673577477,,0.16393442622950818,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.00345994164976682,0.005349976957046467,,,,,0.07327321353862526,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/huber_q0.85_rare_sampling,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.85_rare_sampling_train.xyz,data/huber_q0.85_rare_sampling_val.xyz,data/huber_q0.85_rare_sampling_test.xyz,22be564f,train:data/huber_q0.85_rare_sampling_train.xyz|val:data/huber_q0.85_rare_sampling_val.xyz|test:data/huber_q0.85_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
61,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,huber_q0.85_rare_sampling,27223.893185831,103543.0,1751578470.7956803,{'runtime': 27224},100.0,0.2938278376957023,0.3796101609649174,0.32656200133938035,3.90625e-06,0.1987573675745534,1.278432103962787,0.05250154717693558,0.08704150203659579,0.011439816605070596,0.02378775921928318,0.4630871217395553,0.1408767356094206,0.2594354609269759,0.01805672185260557,0.14577448291405748,0.0653028466144636,0.0005711161995599731,0.0002722828670905252,0.019493512966554095,516200.0,0.201030216640029,0.4711439387077011,0.05251628302659434,0.08713191594234171,0.011906557119822213,0.027727935044285605,0.19533459656477617,,,,,,,,0.999,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.201030216640029,,,,,,0.0653028466144636,,,0.019493512966554095,,0.05250154717693558,,516200.0,0.1987573675745534,,,,0.0002722828670905252,,,,0.05251628302659434,,0.19533459656477617,,0.08713191594234171,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}",100.0,,,,27223.893185831,,,,,,,,,,,3.90625e-06,,,,,,,1751578470.7956803,,,"{""data"": {""_target_"": ""forge.workflows.allegro_utils.data_v3.CustomSamplingASEDataModuleV3"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""sampler_config"": {""_target_"": ""forge.workflows.allegro_utils.samplers.RareWeightedSampler"", ""rare_idx"": [], ""replica"": 5}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.85_rare_sampling_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.85_rare_sampling_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.85_rare_sampling_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.85_rare_sampling"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""nequip.train.callbacks.SoftAdapt"", ""beta"": 1, ""frequency"": 10, ""interval"": ""epoch""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.85_rare_sampling"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.85_rare_sampling""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.85}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,1.278432103962787,,,,,0.2594354609269759,0.32656200133938035,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103543.0,,0.1408767356094206,,,,0.01805672185260557,,,0.0005711161995599731,0.011439816605070596,,,,0.3796101609649174,0.011906557119822213,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 27224},0.08704150203659579,,0.02378775921928318,,,0.4711439387077011,,,,,,,,,0.2938278376957023,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.14577448291405748,0.027727935044285605,,,,,0.4630871217395553,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/huber_q0.85_rare_sampling,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.85_rare_sampling_train.xyz,data/huber_q0.85_rare_sampling_val.xyz,data/huber_q0.85_rare_sampling_test.xyz,22be564f,train:data/huber_q0.85_rare_sampling_train.xyz|val:data/huber_q0.85_rare_sampling_val.xyz|test:data/huber_q0.85_rare_sampling_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=10),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|SoftAdapt|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
62,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,huber_q0.65_auto_delta_no_sampler,41243.654480207,103543.0,1751621732.924143,{'runtime': 41243},100.0,0.3333333333333333,0.3333333333333333,0.3333333333333333,3.125e-05,0.18080017102353296,1.1622472837106803,0.03159407132255719,0.07050313928375729,0.008515549943892316,0.019453855334827384,0.41740142610975506,0.13697098195671556,0.2074712301548119,0.018396377872695453,0.12094619666140764,0.08751137729754346,0.00041160156365742807,4.046452276109251e-05,0.02932114779465399,516200.0,0.18348350794559645,0.40557089617585146,0.031199415719967694,0.06640363071930372,0.009001173543446926,0.024004499410119753,0.1653263421017583,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.65_auto_delta_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.65_auto_delta_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.65_auto_delta_no_sampler_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.65_auto_delta_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""forge.workflows.allegro_utils.callbacks.DeltaLoggerCallback""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.65_auto_delta_no_sampler"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.65_auto_delta_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",0.3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.18348350794559645,,,,,,0.08751137729754346,,,0.02932114779465399,,0.03159407132255719,0.3,516200.0,0.18080017102353296,,,,4.046452276109251e-05,,,,0.031199415719967694,,0.1653263421017583,,0.06640363071930372,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}",100.0,,,,41243.654480207,,,,,,,,,,,3.125e-05,,,,,,,1751621732.924143,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.65_auto_delta_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.65_auto_delta_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.65_auto_delta_no_sampler_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.65_auto_delta_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""forge.workflows.allegro_utils.callbacks.DeltaLoggerCallback""}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.65_auto_delta_no_sampler"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.65_auto_delta_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": ""auto"", ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,1.1622472837106803,,,,,0.2074712301548119,0.3333333333333333,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103543.0,,0.13697098195671556,,,,0.018396377872695453,,,0.00041160156365742807,0.008515549943892316,,,,0.3333333333333333,0.009001173543446926,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 41243},0.07050313928375729,,0.019453855334827384,,,0.40557089617585146,,,,,,,,,0.3333333333333333,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.12094619666140764,0.024004499410119753,,,,,0.41740142610975506,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/huber_q0.65_auto_delta_no_sampler,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.65_auto_delta_no_sampler_train.xyz,data/huber_q0.65_auto_delta_no_sampler_val.xyz,data/huber_q0.65_auto_delta_no_sampler_test.xyz,7f0b9cd0,train:data/huber_q0.65_auto_delta_no_sampler_train.xyz|val:data/huber_q0.65_auto_delta_no_sampler_val.xyz|test:data/huber_q0.65_auto_delta_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=1),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|DeltaLoggerCallback|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,100.0,100.0
63,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,huber_q0.65_no_sampler,13333.976994121,34167.0,1751635177.179618,{'runtime': 13333},32.0,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.00025,1.0296214656876388,11.006801552427854,10.208638986400407,10.315602056088968,0.21985421314872183,0.3964738490950379,7.239625819203953,0.1622210005333696,0.5209089491494061,0.020632035983315054,0.23458732855536357,0.10709174235777268,0.0013854591089530865,0.000142761009463164,0.036206654158729645,170344.0,0.22837957904208447,5.371884286934345,0.03466191822051691,0.1672973787839961,0.008795705881897086,0.024086569906473936,1.854422745208272,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.65_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.65_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.65_no_sampler_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.65_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.65_no_sampler"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.65_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.22837957904208447,,,,,,0.10709174235777268,,,0.036206654158729645,,10.208638986400407,,170344.0,1.0296214656876388,,,,0.000142761009463164,,,,0.03466191822051691,,1.854422745208272,,0.1672973787839961,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}",32.0,,,,13333.976994121,,,,,,,,,,,0.00025,,,,,,,1751635177.179618,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/huber_q0.65_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/huber_q0.65_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/huber_q0.65_no_sampler_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/huber_q0.65_no_sampler"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""huber_q0.65_no_sampler"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/huber_q0.65_no_sampler""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.65}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,11.006801552427854,,,,,0.5209089491494061,0.3333333333333333,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,34167.0,,0.1622210005333696,,,,0.020632035983315054,,,0.0013854591089530865,0.21985421314872183,,,,0.3333333333333333,0.008795705881897086,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 13333},10.315602056088968,,0.3964738490950379,,,5.371884286934345,,,,,,,,,0.3333333333333333,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.23458732855536357,0.024086569906473936,,,,,7.239625819203953,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/huber_q0.65_no_sampler,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/huber_q0.65_no_sampler_train.xyz,data/huber_q0.65_no_sampler_val.xyz,data/huber_q0.65_no_sampler_test.xyz,ec6974a5,train:data/huber_q0.65_no_sampler_train.xyz|val:data/huber_q0.65_no_sampler_val.xyz|test:data/huber_q0.65_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=1),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,32.0,32.0
64,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,base_huber_q0.75_no_sampler_artifact_test,2881.843534285,7353.0,1751641795.8488884,{'runtime': 2881},7.0,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.001,1.0296214655764957,11.00680154838886,10.208638986475837,10.315602056447098,0.21985421308465936,0.39647384912624206,7.2396258179874,0.32043437498412075,0.7604401139748498,0.020979997141667348,0.36728482870021256,0.3562790750444699,0.004177111342927703,0.0004030242771445878,0.12028640355484738,36649.0,0.26023027660475695,0.9366165246718254,0.1183566845713004,0.18125160205959256,0.011681280654756793,0.0300827786131594,0.38265030178152576,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.75_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.75_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.75_no_sampler_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_no_sampler_artifact_test"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""log_model"": true, ""name"": ""base_huber_q0.75_no_sampler_artifact_test"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/base_huber_q0.75_no_sampler_artifact_test""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.26023027660475695,,,,,,0.3562790750444699,,,0.12028640355484738,,10.208638986475837,,36649.0,1.0296214655764957,,,,0.0004030242771445878,,,,0.1183566845713004,,0.38265030178152576,,0.18125160205959256,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}",7.0,,,,2881.843534285,,,,,,,,,,,0.001,,,,,,,1751641795.8488884,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/base_huber_q0.75_no_sampler_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/base_huber_q0.75_no_sampler_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": [""data/base_huber_q0.75_no_sampler_val.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/base_huber_q0.75_no_sampler_artifact_test"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/weighted_sum"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""log_model"": true, ""name"": ""base_huber_q0.75_no_sampler_artifact_test"", ""project"": ""allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights"", ""save_dir"": ""results/base_huber_q0.75_no_sampler_artifact_test""}, ""max_epochs"": 100, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""forge.workflows.allegro_utils.custom_metrics.TailHuberLoss"", ""delta"": 1, ""quantile"": 0.75}, ""name"": ""forces_tail_huber""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.1"", ""torch"": ""2.7.1+cu128""}}",allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights,11.00680154838886,,,,,0.7604401139748498,0.3333333333333333,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,7353.0,,0.32043437498412075,,,,0.020979997141667348,,,0.004177111342927703,0.21985421308465936,,,,0.3333333333333333,0.011681280654756793,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.06065806177161, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 11.048654909251072, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 2881},10.315602056447098,,0.39647384912624206,,,0.9366165246718254,,,,,,,,,0.3333333333333333,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.36728482870021256,0.0300827786131594,,,,,7.2396258179874,,allegro_huber_loss_study_no_dimers_no_sr_no_val_b_equal_weights/base_huber_q0.75_no_sampler_artifact_test,5.0,2.0,2.0,float32,42.0,32.06065806177161,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/base_huber_q0.75_no_sampler_train.xyz,data/base_huber_q0.75_no_sampler_val.xyz,data/base_huber_q0.75_no_sampler_test.xyz,a6442fe8,train:data/base_huber_q0.75_no_sampler_train.xyz|val:data/base_huber_q0.75_no_sampler_val.xyz|test:data/base_huber_q0.75_no_sampler_test.xyz,per_atom_energy_mse(coeff=1)|stress_mse(coeff=1)|forces_tail_huber(coeff=1),val0_epoch/weighted_sum,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,7.0,7.0
65,allegro-stress-rmax-test,job_gen_7_2025-06-11_r5,32063.373507754,103043.0,1749682636.7121954,{'runtime': 32064},400.0,,,,,0.21117801739570533,0.3421112566354907,0.01718027144403673,0.02254901082023418,0.00437947234729753,0.009180492989018737,0.12461358681491454,,0.0005031025444425477,7.33330388025661e-05,0.004928773360810372,,0.0007656842099744016,0.0008328846946986473,0.006323891230920324,511200.0,0.21908518718053735,0.35419904827008003,0.017690590830660467,0.02657860913099519,0.004426713828779161,0.008835126800240128,0.12987092806710512,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r5"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r5"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r5""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 32.04513466643201, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 32.04513466643201, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1.795397412834827,2.5159393536306127,,,,,,,,,,,,,,,,,,,,,,,,,1.8599058803857111,3.1554161070163302,,0.014209884499186004,0.017373104788087925,,,,,,,,,,,,,,,,,,0.21908518718053735,,,2.5159393536306127,0.017373104788087925,,,,,0.006323891230920324,,0.01718027144403673,,511200.0,0.21117801739570533,,,,0.0008328846946986473,,,,0.017690590830660467,,0.12987092806710512,,0.02657860913099519,0.014209884499186004,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",400.0,,,,32063.373507754,,,,1.795397412834827,,,,,,,,1.8599058803857111,,,,,,1749682636.7121954,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r5"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r5"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r5""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 32.04513466643201, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,0.3421112566354907,,,,,0.0005031025444425477,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103043.0,,,,,,7.33330388025661e-05,,,0.0007656842099744016,0.00437947234729753,,,,,0.004426713828779161,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 32.04513466643201, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 32064},0.02254901082023418,,0.009180492989018737,,,0.35419904827008003,,,,,,,,,,3.1554161070163302,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.004928773360810372,0.008835126800240128,,,,,0.12461358681491454,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r5,5.0,1.0,2.0,float32,0.0,32.04513466643201,128.0,64.0,2.0,256.0,2.0,128.0,64.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=1)|stress_mse(coeff=1),,,1.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,400.0,400.0
66,allegro-stress-rmax-test,job_gen_7_2025-06-11_r5_b16,16254.390331534,26403.0,1749839156.7333925,{'runtime': 16254},400.0,,,,,0.23673387864461715,0.3904757739448493,0.020984096211108052,0.027985615308225985,0.00538645455167352,0.011092243092637878,0.1431845441152377,,0.0007981166330209256,0.00010729555067972416,0.005927348601121751,,0.00047583715562488446,0.00032166164529485856,0.004911658738534076,128000.0,0.2452975225581947,0.388855635052943,0.02160979786326936,0.03261311250003101,0.0054304730598671086,0.010558251461686204,0.1440089996715534,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r5_b16"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r5_b16"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r5_b16""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 32.045134666432126, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 32.045134666432126, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,2.133530207704625,3.198167597243898,,,,,,,,,,,,,,,,,,,,,,,,,2.235023417060896,3.918632221200424,,0.016876633619664606,0.013937477414682486,,,,,,,,,,,,,,,,,,0.2452975225581947,,,3.198167597243898,0.013937477414682486,,,,,0.004911658738534076,,0.020984096211108052,,128000.0,0.23673387864461715,,,,0.00032166164529485856,,,,0.02160979786326936,,0.1440089996715534,,0.03261311250003101,0.016876633619664606,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",400.0,,,,16254.390331534,,,,2.133530207704625,,,,,,,,2.235023417060896,,,,,,1749839156.7333925,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r5_b16"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r5_b16"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r5_b16""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 32.045134666432126, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,0.3904757739448493,,,,,0.0007981166330209256,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,26403.0,,,,,,0.00010729555067972416,,,0.00047583715562488446,0.00538645455167352,,,,,0.0054304730598671086,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 32.045134666432126, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 16254},0.027985615308225985,,0.011092243092637878,,,0.388855635052943,,,,,,,,,,3.918632221200424,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.005927348601121751,0.010558251461686204,,,,,0.1431845441152377,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r5_b16,5.0,1.0,2.0,float32,0.0,32.045134666432126,128.0,64.0,2.0,256.0,2.0,128.0,64.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=1)|stress_mse(coeff=1),,,1.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,400.0,400.0
67,allegro-stress-rmax-test,job_gen_7_2025-06-11_r5_stress100,32311.578508006,84993.0,1749807981.5998724,{'runtime': 32311},400.0,,,,,0.09816720866778356,0.20160230216473024,0.009703002760199144,0.012477459345547184,0.0010295272428579017,0.0025323465542519408,0.07220403602150978,,0.0005086197447823933,6.949701646578849e-06,0.00024250758768359465,,0.0004663500467351295,7.106190815397348e-06,0.000383679232326246,2044000.0,0.10090394585422816,0.20160209989663996,0.01012062575460454,0.01437954496044406,0.0010344251320258907,0.0026066767345908665,0.07286277386389163,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r5_stress100"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 1, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r5_stress100"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r5_stress100""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.04513466643201, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.04513466643201, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1.0839494792624853,1.4885350969349345,,,,,,,,,,,,,,,,,,,,,,,,,1.136867981945214,1.7666520744058969,,0.002571475232343873,0.004141142565993844,,,,,,,,,,,,,,,,,,0.10090394585422816,,,1.4885350969349345,0.004141142565993844,,,,,0.000383679232326246,,0.009703002760199144,,2044000.0,0.09816720866778356,,,,7.106190815397348e-06,,,,0.01012062575460454,,0.07286277386389163,,0.01437954496044406,0.002571475232343873,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",400.0,,,,32311.578508006,,,,1.0839494792624853,,,,,,,,1.136867981945214,,,,,,1749807981.5998724,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r5_stress100"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 1, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r5_stress100"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r5_stress100""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.04513466643201, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}",allegro-stress-rmax-test,0.20160230216473024,,,,,0.0005086197447823933,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,84993.0,,,,,,6.949701646578849e-06,,,0.0004663500467351295,0.0010295272428579017,,,,,0.0010344251320258907,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.04513466643201, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 32311},0.012477459345547184,,0.0025323465542519408,,,0.20160209989663996,,,,,,,,,,1.7666520744058969,,,,0.00024250758768359465,0.0026066767345908665,,,,,0.07220403602150978,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r5_stress100,5.0,2.0,2.0,float32,0.0,32.04513466643201,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),,,1.0,ModelCheckpoint,,,,400.0,400.0
68,allegro-stress-rmax-test,job_gen_7_2025-06-11_r5_stress100_b16,16193.940205183,26403.0,1749714513.266539,{'runtime': 16194},400.0,,,,,0.21937654918513583,0.3634964576681832,0.028958185764277822,0.03634957173898775,0.002787520988331248,0.006580305529866885,0.1354754449790126,,0.0013628864550935455,3.300476094586431e-05,0.0014358064638747847,,0.0010749291842071663,5.670913319871307e-05,0.001192556395260646,128000.0,0.22765560764644013,0.36749579681556976,0.03004406736170287,0.03979024776368648,0.0028671925017714744,0.006209319007613949,0.13783178786229006,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r5_stress100_b16"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r5_stress100_b16"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r5_stress100_b16""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 32.045134666432126, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 32.045134666432126, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,2.8579834057382234,3.74150799669929,,,,,,,,,,,,,,,,,,,,,,,,,2.973191226968629,4.327454272669294,,0.015471115494042112,0.012562791736985324,,,,,,,,,,,,,,,,,,0.22765560764644013,,,3.74150799669929,0.012562791736985324,,,,,0.001192556395260646,,0.028958185764277822,,128000.0,0.21937654918513583,,,,5.670913319871307e-05,,,,0.03004406736170287,,0.13783178786229006,,0.03979024776368648,0.015471115494042112,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",400.0,,,,16193.940205183,,,,2.8579834057382234,,,,,,,,2.973191226968629,,,,,,1749714513.266539,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r5_stress100_b16"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r5_stress100_b16"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r5_stress100_b16""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 32.045134666432126, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,0.3634964576681832,,,,,0.0013628864550935455,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,26403.0,,,,,,3.300476094586431e-05,,,0.0010749291842071663,0.002787520988331248,,,,,0.0028671925017714744,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 32.045134666432126, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 16194},0.03634957173898775,,0.006580305529866885,,,0.36749579681556976,,,,,,,,,,4.327454272669294,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.0014358064638747847,0.006209319007613949,,,,,0.1354754449790126,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r5_stress100_b16,5.0,1.0,2.0,float32,0.0,32.045134666432126,128.0,64.0,2.0,256.0,2.0,128.0,64.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),,,1.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,400.0,400.0
69,allegro-stress-rmax-test,job_gen_7_2025-06-11_r5_stress100_lrsched_fixed,276925.97595739,257603.0,1750296744.7458522,{'runtime': 276926},1000.0,,,,,0.16080841776557253,0.27253849581360756,0.01991685021042759,0.02445123100397151,0.001873791752799676,0.003917770694050624,0.10030249917054322,,0.0006226541372517798,1.407150313936374e-05,0.0008686081578103871,,0.0005445329414096071,6.4869164330405435e-06,0.0005556104431515646,1278000.0,0.16707671822191889,0.2822982257552813,0.020819651039151555,0.026694175431483273,0.001961174567535431,0.0041432727291803835,0.10437855797198164,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r5_stress100_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r5_stress100_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r5_stress100_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.04513466643201, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.04513466643201, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,2.0936709596152014,2.766957945079065,,,,,,,,,,,,,,,,,,,,,,,,,2.181764547113136,3.0780405653654883,,0.009438570106576482,0.006047953460511,,,,,,,,,,,,,,,,,,0.16707671822191889,,,2.766957945079065,0.006047953460511,,,,,0.0005556104431515646,,0.01991685021042759,,1278000.0,0.16080841776557253,,,,6.4869164330405435e-06,,,,0.020819651039151555,,0.10437855797198164,,0.026694175431483273,0.009438570106576482,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",1000.0,,,,276925.97595739,,,,2.0936709596152014,,,,,,,,2.181764547113136,,,,,,1750296744.7458522,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r5_stress100_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r5_stress100_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r5_stress100_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.04513466643201, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,0.27253849581360756,,,,,0.0006226541372517798,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,257603.0,,,,,,1.407150313936374e-05,,,0.0005445329414096071,0.001873791752799676,,,,,0.001961174567535431,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.04513466643201, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 276926},0.02445123100397151,,0.003917770694050624,,,0.2822982257552813,,,,,,,,,,3.0780405653654883,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.0008686081578103871,0.0041432727291803835,,,,,0.10030249917054322,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r5_stress100_lrsched_fixed,5.0,2.0,2.0,float32,0.0,32.04513466643201,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,1000.0,1000.0
70,allegro-stress-rmax-test,job_gen_7_2025-06-11_r6,61428.67653696,103043.0,1749685688.2151165,{'runtime': 61429},400.0,,,,,0.20429937286552724,0.365150983997964,0.016069844063813992,0.021356628682213073,0.0037318602200253374,0.007934063729274564,0.13148055880315054,,0.00041758842288820074,5.3031799514537875e-05,0.0047125360033858825,,0.0004979206884598972,0.0002285491238469556,0.006006893309449292,511200.0,0.2116558110054956,0.34428418001992145,0.016561573233871127,0.026488277624280805,0.003793782958008532,0.00796612773002668,0.12624619512474297,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1.705985037896809,2.3821237179663197,,,,,,,,,,,,,,,,,,,,,,,,,1.7774424857604234,3.210402162009341,,0.01366698778775491,0.017294210116041025,,,,,,,,,,,,,,,,,,0.2116558110054956,,,2.3821237179663197,0.017294210116041025,,,,,0.006006893309449292,,0.016069844063813992,,511200.0,0.20429937286552724,,,,0.0002285491238469556,,,,0.016561573233871127,,0.12624619512474297,,0.026488277624280805,0.01366698778775491,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",400.0,,,,61428.67653696,,,,1.705985037896809,,,,,,,,1.7774424857604234,,,,,,1749685688.2151165,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,0.365150983997964,,,,,0.00041758842288820074,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103043.0,,,,,,5.3031799514537875e-05,,,0.0004979206884598972,0.0037318602200253374,,,,,0.003793782958008532,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 61429},0.021356628682213073,,0.007934063729274564,,,0.34428418001992145,,,,,,,,,,3.210402162009341,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.0047125360033858825,0.00796612773002668,,,,,0.13148055880315054,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r6,6.0,1.0,2.0,float32,0.0,58.23823517470566,128.0,64.0,2.0,256.0,2.0,128.0,64.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=1)|stress_mse(coeff=1),,,1.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,400.0,400.0
71,allegro-stress-rmax-test,job_gen_7_2025-06-11_r6_configloss,86353.056855513,103043.0,1749931917.4595106,{'runtime': 86353},400.0,,,,,0.18857477198141775,0.32970959382713155,0.02022168799952864,0.02498661842896854,0.0015649855831298303,0.0034605435195658916,0.11938558525855532,,0.0006340300466890743,1.0628383779253455e-05,0.004374667284094633,,0.0007088759277074203,0.00011649812536712562,0.005381224303509339,511200.0,0.1955878169997207,0.32293576318555606,0.02088180620748826,0.026587537597931487,0.0016548838699698858,0.0037072181290503338,0.1177435063041793,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_configloss"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_configloss"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_configloss""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMAConFIGLightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,2.169243064982807,2.860350136915409,,,,,,,,,,,,,,,,,,,,,,,,,2.2429994766121704,3.1006028892835555,,0.012479343421815572,0.01531829885745347,,,,,,,,,,,,,,,True,1e-08,,0.1955878169997207,,,2.860350136915409,0.01531829885745347,,,,,0.005381224303509339,,0.02022168799952864,,511200.0,0.18857477198141775,,True,,0.00011649812536712562,,,,0.02088180620748826,,0.1177435063041793,,0.026587537597931487,0.012479343421815572,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",400.0,,,,86353.056855513,,,,2.169243064982807,,,,,,,,2.2429994766121704,,,,,,1749931917.4595106,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_configloss"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_configloss"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_configloss""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMAConFIGLightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,0.32970959382713155,,1e-08,,,0.0006340300466890743,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103043.0,,,,,,1.0628383779253455e-05,,,0.0007088759277074203,0.0015649855831298303,,,,,0.0016548838699698858,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 86353},0.02498661842896854,,0.0034605435195658916,,,0.32293576318555606,,,,,,,,,,3.1006028892835555,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.004374667284094633,0.0037072181290503338,,,,,0.11938558525855532,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r6_configloss,6.0,1.0,2.0,float32,0.0,58.23823517470566,128.0,64.0,2.0,256.0,2.0,128.0,64.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=1)|stress_mse(coeff=1),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,400.0,400.0
72,allegro-stress-rmax-test,job_gen_7_2025-06-11_r6_stress100,55074.123144806,136193.0,1749830969.9186535,{'runtime': 55074},400.0,,,,,0.0962232883137709,0.1908935754825092,0.00956896818732418,0.012514146793542276,0.0009299299181150754,0.002204638300201662,0.06853745352541771,,0.0007052097790217378,8.93973161682017e-06,0.0002725888122311184,,0.00014154578002615096,4.652869538923099e-06,0.0003320739317055751,2044000.0,0.0987906448079328,0.20068729468851965,0.009778208534776268,0.014814530166931858,0.000960055073176101,0.002502312457825354,0.07266804577109229,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 1, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1.0675141801897507,1.4514890683236503,,,,,,,,,,,,,,,,,,,,,,,,,1.0941285673335046,1.7874116295309326,,0.002865817521695039,0.0036253373685400376,,,,,,,,,,,,,,,,,,0.0987906448079328,,,1.4514890683236503,0.0036253373685400376,,,,,0.0003320739317055751,,0.00956896818732418,,2044000.0,0.0962232883137709,,,,4.652869538923099e-06,,,,0.009778208534776268,,0.07266804577109229,,0.014814530166931858,0.002865817521695039,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",400.0,,,,55074.123144806,,,,1.0675141801897507,,,,,,,,1.0941285673335046,,,,,,1749830969.9186535,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 1, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1""}}",allegro-stress-rmax-test,0.1908935754825092,,,,,0.0007052097790217378,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,136193.0,,,,,,8.93973161682017e-06,,,0.00014154578002615096,0.0009299299181150754,,,,,0.000960055073176101,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 55074},0.012514146793542276,,0.002204638300201662,,,0.20068729468851965,,,,,,,,,,1.7874116295309326,,,,0.0002725888122311184,0.002502312457825354,,,,,0.06853745352541771,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r6_stress100,6.0,2.0,2.0,float32,0.0,58.23823517470566,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),,,1.0,ModelCheckpoint,,,,400.0,400.0
73,allegro-stress-rmax-test,job_gen_7_2025-06-11_r6_stress100_b16,29980.107183951,26403.0,1749763184.540472,{'runtime': 29980},400.0,,,,,0.20830250181730048,0.3658744294537963,0.02586021673102796,0.03228616563115649,0.002207539535031125,0.004736363191020178,0.13429898609199098,,0.0010433719433371625,1.9975619622058832e-05,0.001335719844466957,,0.0010069536990426691,5.4495130969165294e-05,0.0011030266615577064,128000.0,0.2161399292983667,0.35259166748811827,0.026693865272419647,0.03513586968575234,0.002252292145818117,0.004645435897840057,0.13079099102390354,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100_b16"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100_b16"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100_b16""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470576, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470576, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,2.611044374701046,3.4107982572289104,,,,,,,,,,,,,,,,,,,,,,,,,2.706792855530798,3.875034168801,,0.01452239688302892,0.011597949263694623,,,,,,,,,,,,,,,,,,0.2161399292983667,,,3.4107982572289104,0.011597949263694623,,,,,0.0011030266615577064,,0.02586021673102796,,128000.0,0.20830250181730048,,,,5.4495130969165294e-05,,,,0.026693865272419647,,0.13079099102390354,,0.03513586968575234,0.01452239688302892,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",400.0,,,,29980.107183951,,,,2.611044374701046,,,,,,,,2.706792855530798,,,,,,1749763184.540472,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100_b16"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100_b16"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100_b16""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470576, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,0.3658744294537963,,,,,0.0010433719433371625,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,26403.0,,,,,,1.9975619622058832e-05,,,0.0010069536990426691,0.002207539535031125,,,,,0.002252292145818117,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470576, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 29980},0.03228616563115649,,0.004736363191020178,,,0.35259166748811827,,,,,,,,,,3.875034168801,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.001335719844466957,0.004645435897840057,,,,,0.13429898609199098,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r6_stress100_b16,6.0,1.0,2.0,float32,0.0,58.23823517470576,128.0,64.0,2.0,256.0,2.0,128.0,64.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),,,1.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,400.0,400.0
74,allegro-stress-rmax-test,job_gen_7_2025-06-11_r6_stress100_b16_lrsched_fixed,,,,{'runtime': 5},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100_b16_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100_b16_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100_b16_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470576, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470576, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100_b16_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100_b16_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100_b16_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470576, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,,,,,,,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,,,,,,,,,,,,,,,,,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470576, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 5},,,,,,,,,,,,,,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",,,,,,,,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r6_stress100_b16_lrsched_fixed,6.0,2.0,2.0,float32,0.0,58.23823517470576,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,,
75,allegro-stress-rmax-test,job_gen_7_2025-06-11_r6_stress100_b1_lrsched_fixed,427741.45560407,693731.0,1750452763.6733131,{'runtime': 427742},677.0,,,,,1.2670496374611533,1.9786869050761835,9.855758801211552,9.94793477481625,0.2268302654835944,0.4043109128085326,4.110310864233655,,0.000318908112352996,4.2656804834546645e-06,0.0004865828932008721,,0.00035358940793121574,1.5126249252612692e-06,2.892993847836018e-05,3461879.0,0.12106592930395382,0.21880662256259792,0.014577708016652056,0.019488600064526185,0.0012148884431706774,0.002790267197251073,0.0803618299414584,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100_b1_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100_b1_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100_b1_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470599, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839283, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470599, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839283, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1012.1506465838614,1108.7873088108545,,,,,,,,,,,,,,,,,,,,,,,,,1.6251496494304871,2.370025908274701,,0.005326522498459834,0.00027063712706406376,,,,,,,,,,,,,,,,,,0.12106592930395382,,,1108.7873088108545,0.00027063712706406376,,,,,2.892993847836018e-05,,9.855758801211552,,3461879.0,1.2670496374611533,,,,1.5126249252612692e-06,,,,0.014577708016652056,,0.0803618299414584,,0.019488600064526185,0.005326522498459834,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",677.0,,,,427741.45560407,,,,1012.1506465838614,,,,,,,,1.6251496494304871,,,,,,1750452763.6733131,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100_b1_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100_b1_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100_b1_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470599, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839283, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,1.9786869050761835,,,,,0.000318908112352996,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,693731.0,,,,,,4.2656804834546645e-06,,,0.00035358940793121574,0.2268302654835944,,,,,0.0012148884431706774,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470599, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839283, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 427742},9.94793477481625,,0.4043109128085326,,,0.21880662256259792,,,,,,,,,,2.370025908274701,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.0004865828932008721,0.002790267197251073,,,,,4.110310864233655,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r6_stress100_b1_lrsched_fixed,6.0,2.0,2.0,float32,0.0,58.23823517470599,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,677.0,677.0
76,allegro-stress-rmax-test,job_gen_7_2025-06-11_r6_stress100_configloss,86588.32339485,103043.0,1749927094.469882,{'runtime': 86588},400.0,,,,,0.27490794867472074,0.4460464282773792,0.3345826331972962,0.6016258101722832,0.0013499831681081098,0.0026770658862102677,0.3501164347786242,,0.35425387288684096,7.355236273883033e-06,0.005061617477509805,,0.5686585069725323,0.0001390668633463968,0.007711513280618159,511200.0,0.2830378687532416,0.43275133344538375,0.3431245789021665,0.6150506568356203,0.0014362261226834427,0.0028864609503651273,0.3502294837437897,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100_configloss"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100_configloss"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100_configloss""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMAConFIGLightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,21.504471998407094,37.86502456066655,,,,,,,,,,,,,,,,,,,,,,,,,22.320186695613614,41.476306481409075,,0.020685014348935913,0.027341278084144365,,,,,,,,,,,,,,,True,1e-08,,0.2830378687532416,,,37.86502456066655,0.027341278084144365,,,,,0.007711513280618159,,0.3345826331972962,,511200.0,0.27490794867472074,,True,,0.0001390668633463968,,,,0.3431245789021665,,0.3502294837437897,,0.6150506568356203,0.020685014348935913,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",400.0,,,,86588.32339485,,,,21.504471998407094,,,,,,,,22.320186695613614,,,,,,1749927094.469882,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100_configloss"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100_configloss"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100_configloss""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMAConFIGLightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,0.4460464282773792,,1e-08,,,0.35425387288684096,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103043.0,,,,,,7.355236273883033e-06,,,0.5686585069725323,0.0013499831681081098,,,,,0.0014362261226834427,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 86588},0.6016258101722832,,0.0026770658862102677,,,0.43275133344538375,,,,,,,,,,41.476306481409075,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.005061617477509805,0.0028864609503651273,,,,,0.3501164347786242,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r6_stress100_configloss,6.0,1.0,2.0,float32,0.0,58.23823517470566,128.0,64.0,2.0,256.0,2.0,128.0,64.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,400.0,400.0
77,allegro-stress-rmax-test,job_gen_7_2025-06-11_r6_stress100_lrsched,13384.515044336,22241.0,1750014126.302244,{'runtime': 13385},86.0,,,,,1.226514622862098,1.936559428491007,10.00506737888704,10.09226509639406,0.23095220874704775,0.41324885548476104,4.147357793456609,,0.0007661910667895706,1.3505745618966145e-05,0.00113815341153273,,0.0004839082361108105,1.1864079548815951e-05,0.0012937271237891167,110339.0,0.1951657802205334,0.32433113399068525,0.023329941813089797,0.030366744626582756,0.001944243629156172,0.004295752412887004,0.11966454367671832,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100_lrsched"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100_lrsched"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100_lrsched""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1028.816394345464,1126.9489539251415,,,,,,,,,,,,,,,,,,,,,,,,,2.455569660195494,3.5155733958951645,,0.012421826305144682,0.014193339454959956,,,,,,,,,,,,,,,,,,0.1951657802205334,,,1126.9489539251415,0.014193339454959956,,,,,0.0012937271237891167,,10.00506737888704,,110339.0,1.226514622862098,,,,1.1864079548815951e-05,,,,0.023329941813089797,,0.11966454367671832,,0.030366744626582756,0.012421826305144682,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",86.0,,,,13384.515044336,,,,1028.816394345464,,,,,,,,2.455569660195494,,,,,,1750014126.302244,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100_lrsched"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100_lrsched"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100_lrsched""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,1.936559428491007,,,,,0.0007661910667895706,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,22241.0,,,,,,1.3505745618966145e-05,,,0.0004839082361108105,0.23095220874704775,,,,,0.001944243629156172,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 13385},10.09226509639406,,0.41324885548476104,,,0.32433113399068525,,,,,,,,,,3.5155733958951645,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.00113815341153273,0.004295752412887004,,,,,4.147357793456609,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r6_stress100_lrsched,6.0,1.0,2.0,float32,0.0,58.23823517470566,128.0,64.0,2.0,256.0,2.0,128.0,64.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,86.0,86.0
78,allegro-stress-rmax-test,job_gen_7_2025-06-11_r6_stress100_lrsched_fixed,19304.743095896,42503.0,1750041169.9952316,{'runtime': 19304},164.0,,,,,1.2670496383005254,1.978686905787248,9.85575881097794,9.947934784421395,0.22683026558496489,0.4043109129136976,4.110310867707447,,0.000592814603995755,9.379586273974176e-06,0.0008845296084023228,,0.0004182127137335684,8.608603151250788e-06,0.000634764306512102,210869.0,0.16762752141318496,0.2812448301793907,0.020287321859969187,0.025662966088710285,0.0016578296577633709,0.003409908639697358,0.10343923496926612,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470566, ""compile_mode"": ""compile"", ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470566, ""compile_mode"": ""compile"", ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1012.150647703184,1108.7873100451775,,,,,,,,,,,,,,,,,,,,,,,,,2.1935104200200906,3.0240224396046536,,0.009665201330126466,0.006917976499398466,,,,,,,,,,,,,,,,,,0.16762752141318496,,,1108.7873100451775,0.006917976499398466,,,,,0.000634764306512102,,9.85575881097794,,210869.0,1.2670496383005254,,,,8.608603151250788e-06,,,,0.020287321859969187,,0.10343923496926612,,0.025662966088710285,0.009665201330126466,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",164.0,,,,19304.743095896,,,,1012.150647703184,,,,,,,,2.1935104200200906,,,,,,1750041169.9952316,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress100_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress100_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress100_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470566, ""compile_mode"": ""compile"", ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1""}}",allegro-stress-rmax-test,1.978686905787248,,,,,0.000592814603995755,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,42503.0,,,,,,9.379586273974176e-06,,,0.0004182127137335684,0.22683026558496489,,,,,0.0016578296577633709,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470566, ""compile_mode"": ""compile"", ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 19304},9.947934784421395,,0.4043109129136976,,,0.2812448301793907,,,,,,,,,,3.0240224396046536,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.0008845296084023228,0.003409908639697358,,,,,4.110310867707447,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r6_stress100_lrsched_fixed,6.0,2.0,2.0,float32,0.0,58.23823517470566,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,164.0,164.0
79,allegro-stress-rmax-test,job_gen_7_2025-06-11_r6_stress50_b1_lrsched_fixed,82313.682940794,316742.0,1750124157.4835312,{'runtime': 82313},309.0,,,,,1.2670496375549856,1.9786869049234663,9.855758800510657,9.94793477421863,0.22683026547133273,0.4043109127980719,4.110310863980056,,0.00030748553102356976,5.410922256460966e-06,0.0008589551924551648,,0.0005174425478411251,9.710214499423403e-07,0.0002293833294504455,1580614.0,0.11839838822908431,0.2158685103805424,0.014071400222661278,0.018867891600944903,0.0013340957026449134,0.002990791394385398,0.07924239779195756,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress50_b1_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress50_b1_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress50_b1_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470599, ""compile_mode"": ""compile"", ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839283, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470599, ""compile_mode"": ""compile"", ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839283, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1012.150646567076,1108.787308794193,,,,,,,,,,,,,,,,,,,,,,,,,1.5723178626900425,2.292397794170149,,0.005181823509591844,0.0013426389476138931,,,,,,,,,,,,,,,,,,0.11839838822908431,,,1108.787308794193,0.0013426389476138931,,,,,0.0002293833294504455,,9.855758800510657,,1580614.0,1.2670496375549856,,,,9.710214499423403e-07,,,,0.014071400222661278,,0.07924239779195756,,0.018867891600944903,0.005181823509591844,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",309.0,,,,82313.682940794,,,,1012.150646567076,,,,,,,,1.5723178626900425,,,,,,1750124157.4835312,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress50_b1_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress50_b1_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress50_b1_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1, ""strategy"": {""_target_"": ""nequip.train.SimpleDDPStrategy""}}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470599, ""compile_mode"": ""compile"", ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839283, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.2"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1""}}",allegro-stress-rmax-test,1.9786869049234663,,,,,0.00030748553102356976,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,316742.0,,,,,,5.410922256460966e-06,,,0.0005174425478411251,0.22683026547133273,,,,,0.0013340957026449134,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470599, ""compile_mode"": ""compile"", ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839283, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 82313},9.94793477421863,,0.4043109127980719,,,0.2158685103805424,,,,,,,,,,2.292397794170149,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.0008589551924551648,0.002990791394385398,,,,,4.110310863980056,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r6_stress50_b1_lrsched_fixed,6.0,2.0,2.0,float32,0.0,58.23823517470599,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=50),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,309.0,309.0
80,allegro-stress-rmax-test,job_gen_7_2025-06-11_r6_stress50_lrsched,13313.818547264,22221.0,1750014127.1339183,{'runtime': 13314},86.0,,,,,1.2265146229506187,1.9365594283363516,10.005067378938952,10.09226509644777,0.23095220874586184,0.4132488555546615,4.14735779344626,,0.000706214307276261,1.4940851783085552e-05,0.001919714001551584,,0.0005248385902661947,1.5651585290889522e-05,0.001621078399816866,110239.0,0.18658284506567688,0.3119679494875791,0.022335859885425913,0.028408400719400637,0.002074968217428524,0.004753264437183611,0.1150432048813878,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress50_lrsched"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress50_lrsched"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress50_lrsched""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1028.8163943589896,1126.9489539411748,,,,,,,,,,,,,,,,,,,,,,,,,2.3776681980238648,3.3103707033516825,,0.011564929719821608,0.009757836453401817,,,,,,,,,,,,,,,,,,0.18658284506567688,,,1126.9489539411748,0.009757836453401817,,,,,0.001621078399816866,,10.005067378938952,,110239.0,1.2265146229506187,,,,1.5651585290889522e-05,,,,0.022335859885425913,,0.1150432048813878,,0.028408400719400637,0.011564929719821608,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",86.0,,,,13313.818547264,,,,1028.8163943589896,,,,,,,,2.3776681980238648,,,,,,1750014127.1339183,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress50_lrsched"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress50_lrsched"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress50_lrsched""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,1.9365594283363516,,,,,0.000706214307276261,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,22221.0,,,,,,1.4940851783085552e-05,,,0.0005248385902661947,0.23095220874586184,,,,,0.002074968217428524,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 13314},10.09226509644777,,0.4132488555546615,,,0.3119679494875791,,,,,,,,,,3.3103707033516825,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.001919714001551584,0.004753264437183611,,,,,4.14735779344626,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r6_stress50_lrsched,6.0,1.0,2.0,float32,0.0,58.23823517470566,128.0,64.0,2.0,256.0,2.0,128.0,64.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=50),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,86.0,86.0
81,allegro-stress-rmax-test,job_gen_7_2025-06-11_r6_stress50_lrsched_fixed,86.950665534,6.0,1750014609.3802676,{'runtime': 87},0.0,,,,,1.2670496371452828,1.978686904802042,9.855758801350625,9.947934775073673,0.22683026552591057,0.4043109128433355,4.110310864239683,,,,,,9.589435187580662,0.02893942582754072,0.25687558977608105,24.0,1.288242174439358,2.009292361970388,9.86986284474556,9.964369016113457,0.2260642769442831,0.403890503402433,4.125850627162092,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress50_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress50_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress50_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1012.1506465742837,1108.787308806311,,,,,,,,,,,,,,,,,,,,,,,,,1009.5661488974856,1107.2280545837868,,,0.4633004497383244,,,,,,,,,,,,,,,,,,1.288242174439358,,,1108.787308806311,0.4633004497383244,,,,,0.25687558977608105,,9.855758801350625,,24.0,1.2670496371452828,,,,0.02893942582754072,,,,9.86986284474556,,4.125850627162092,,9.964369016113457,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",0.0,,,,86.950665534,,,,1012.1506465742837,,,,,,,,1009.5661488974856,,,,,,1750014609.3802676,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r6_stress50_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r6_stress50_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r6_stress50_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 50, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,1.978686904802042,,,,,,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,6.0,,,,,,,,,9.589435187580662,0.22683026552591057,,,,,0.2260642769442831,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.23823517470566, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 87},9.947934775073673,,0.4043109128433355,,,2.009292361970388,,,,,,,,,,1107.2280545837868,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",,0.403890503402433,,,,,4.110310864239683,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r6_stress50_lrsched_fixed,6.0,2.0,2.0,float32,0.0,58.23823517470566,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=50),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,0.0,0.0
82,allegro-stress-rmax-test,job_gen_7_2025-06-11_r7,114322.961784714,103043.0,1749740124.0106635,{'runtime': 114323},400.0,,,,,0.19485724379299807,0.3488305043605302,0.01468775397066586,0.01943437101972304,0.002892598094385554,0.005944953437177054,0.12473660960581008,,0.00036318826893138114,3.32606555370413e-05,0.004406456784743283,,0.0003725923389745606,0.0005790058806245787,0.005340453313587065,511200.0,0.2016852745381791,0.3310428744463153,0.015345686786959653,0.02391138782896773,0.002939186661315718,0.006068172343890305,0.12034081153972444,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 7}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r7"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r7"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r7""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 99.71316465632096, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 7, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 99.71316465632096, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 7, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1.586312944791166,2.1648700234496023,,,,,,,,,,,,,,,,,,,,,,,,,1.6522634078896417,2.80619682427192,,0.012822921429761429,0.015069761721162056,,,,,,,,,,,,,,,,,,0.2016852745381791,,,2.1648700234496023,0.015069761721162056,,,,,0.005340453313587065,,0.01468775397066586,,511200.0,0.19485724379299807,,,,0.0005790058806245787,,,,0.015345686786959653,,0.12034081153972444,,0.02391138782896773,0.012822921429761429,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",400.0,,,,114322.961784714,,,,1.586312944791166,,,,,,,,1.6522634078896417,,,,,,1749740124.0106635,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 7}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r7"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r7"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r7""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 1, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 99.71316465632096, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 7, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,0.3488305043605302,,,,,0.00036318826893138114,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,103043.0,,,,,,3.32606555370413e-05,,,0.0003725923389745606,0.002892598094385554,,,,,0.002939186661315718,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 99.71316465632096, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 7, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 114323},0.01943437101972304,,0.005944953437177054,,,0.3310428744463153,,,,,,,,,,2.80619682427192,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.004406456784743283,0.006068172343890305,,,,,0.12473660960581008,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r7,7.0,1.0,2.0,float32,0.0,99.71316465632096,128.0,64.0,2.0,256.0,2.0,128.0,64.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=1)|stress_mse(coeff=1),,,1.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,400.0,400.0
83,allegro-stress-rmax-test,job_gen_7_2025-06-11_r7_stress100,80741.396871556,122877.0,1749856708.659132,{'runtime': 80741},282.0,,,,,,,,,,,,,0.0007193809344070144,7.914159691202911e-06,0.0002446460920847091,,2.6819199063917956e-05,1.7953955105120708e-06,0.0003604019947372399,1446129.0,0.09526146017706956,0.1923243857468525,0.009686474403620093,0.01572005681455617,0.0009359156263485178,0.002360973985358268,0.07013513884892231,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 7}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r7_stress100"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 1, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r7_stress100"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r7_stress100""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 99.71316465632096, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 7, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 99.71316465632096, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 7, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1.0839953865350855,1.9370045433292875,,0.0025644919317875407,0.00397982626657185,,,,,,,,,,,,,,,,,,0.09526146017706956,,,,0.00397982626657185,,,,,0.0003604019947372399,,,,1446129.0,,,,,1.7953955105120708e-06,,,,0.009686474403620093,,0.07013513884892231,,0.01572005681455617,0.0025644919317875407,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",282.0,,,,80741.396871556,,,,,,,,,,,,1.0839953865350855,,,,,,1749856708.659132,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 7}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r7_stress100"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 1, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r7_stress100"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r7_stress100""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 99.71316465632096, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 7, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.1+cu128""}}",allegro-stress-rmax-test,,,,,,0.0007193809344070144,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,122877.0,,,,,,7.914159691202911e-06,,,2.6819199063917956e-05,,,,,,0.0009359156263485178,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 99.71316465632096, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.8285575837839327, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 7, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 80741},,,,,,0.1923243857468525,,,,,,,,,,1.9370045433292875,,,,0.0002446460920847091,0.002360973985358268,,,,,,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r7_stress100,7.0,2.0,2.0,float32,0.0,99.71316465632096,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),,,1.0,ModelCheckpoint,,,,282.0,282.0
84,allegro-stress-rmax-test,job_gen_7_2025-06-11_r7_stress100_b16,43489.788883605,26403.0,1749779668.120217,{'runtime': 43490},400.0,,,,,0.20248200597846777,0.36090321515478746,0.02339692603828184,0.029025715322915143,0.0019612311353434694,0.004228770026673804,0.13138590016812546,,0.0008618483762110221,1.644518148402551e-05,0.0012724567617458478,,0.0008249168170695862,7.326957436652397e-05,0.0010487091211325498,128000.0,0.20984963950618657,0.3425647124292047,0.02448778091730187,0.03290148623054341,0.0020558195950777336,0.004562046536262108,0.1266760817320034,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 7}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r7_stress100_b16"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r7_stress100_b16"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r7_stress100_b16""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 99.7131646563206, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 7, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 99.7131646563206, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 7, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,2.4154547916650424,3.1806723898826843,,,,,,,,,,,,,,,,,,,,,,,,,2.513330945060503,3.737038150877971,,0.013873633402917552,0.010825483819199108,,,,,,,,,,,,,,,,,,0.20984963950618657,,,3.1806723898826843,0.010825483819199108,,,,,0.0010487091211325498,,0.02339692603828184,,128000.0,0.20248200597846777,,,,7.326957436652397e-05,,,,0.02448778091730187,,0.1266760817320034,,0.03290148623054341,0.013873633402917552,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",400.0,,,,43489.788883605,,,,2.4154547916650424,,,,,,,,2.513330945060503,,,,,,1749779668.120217,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""test_file_path"": ""data/job_gen_7-2025-04-29_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""train_file_path"": ""data/job_gen_7-2025-04-29_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 7}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 16, ""num_workers"": 8}, ""val_file_path"": ""data/job_gen_7-2025-04-29_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_7_2025-06-11_r7_stress100_b16"", ""filename"": ""{epoch}-{forces_mae:.2f}"", ""save_last"": true, ""save_top_k"": 1}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_7_2025-06-11_r7_stress100_b16"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_7_2025-06-11_r7_stress100_b16""}, ""max_epochs"": 400, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 99.7131646563206, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 7, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.10.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,0.36090321515478746,,,,,0.0008618483762110221,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,26403.0,,,,,,1.644518148402551e-05,,,0.0008249168170695862,0.0019612311353434694,,,,,0.0020558195950777336,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 256, ""avg_num_neighbors"": 99.7131646563206, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 1, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 1.828557583783929, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 7, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 64, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 128, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 43490},0.029025715322915143,,0.004228770026673804,,,0.3425647124292047,,,,,,,,,,3.737038150877971,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.6, ""min_lr"": 1e-06, ""patience"": 5, ""threshold"": 0.2}}",0.0012724567617458478,0.004562046536262108,,,,,0.13138590016812546,,allegro-stress-rmax-test/job_gen_7_2025-06-11_r7_stress100_b16,7.0,1.0,2.0,float32,0.0,99.7131646563206,128.0,64.0,2.0,256.0,2.0,128.0,64.0,False,False,False,True,silu,6.0,8.0,False,data/job_gen_7-2025-04-29_train.xyz,data/job_gen_7-2025-04-29_val.xyz,data/job_gen_7-2025-04-29_test.xyz,0e9c7bd3,train:data/job_gen_7-2025-04-29_train.xyz|val:data/job_gen_7-2025-04-29_val.xyz|test:data/job_gen_7-2025-04-29_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),,,1.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,400.0,400.0
85,allegro-stress-rmax-test,job_gen_8_2025-06-20_r5_stress100_b4_lrsched_fixed,278560.873580563,270003.0,1750734866.3009193,{'runtime': 278561},1000.0,,,,,0.25987857556223615,3.343605351260732,0.13190400378942838,2.320376335008325,0.006500270020485772,0.237029603393483,1.9670037632208464,,0.14107125046541968,0.001396454354161018,0.004392746769062713,,0.0006984525546777663,1.151322953319859e-05,0.0008180087083681065,1340000.0,0.22625691766914183,0.8379790286658074,0.058912628750365306,0.5122634036932454,0.0032799396341138486,0.008959957066464507,0.4530674631418391,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/allegro_gen_8_2025-06-20_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/allegro_gen_8_2025-06-20_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/allegro_gen_8_2025-06-20_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_8_2025-06-20_r5_stress100_b4_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_8_2025-06-20_r5_stress100_b4_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_8_2025-06-20_r5_stress100_b4_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.01512968231003, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.79345809524218, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.01512968231003, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.79345809524218, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,9.215078885863528,262.5413913861683,,,,,,,,,,,,,,,,,,,,,,,,,3.1200319055103543,4.901626138914355,,0.020687820548443966,0.00889491911208622,,,,,,,,,,,,,,,,,,0.22625691766914183,,,262.5413913861683,0.00889491911208622,,,,,0.0008180087083681065,,0.13190400378942838,,1340000.0,0.25987857556223615,,,,1.151322953319859e-05,,,,0.058912628750365306,,0.4530674631418391,,0.5122634036932454,0.020687820548443966,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",1000.0,,,,278560.873580563,,,,9.215078885863528,,,,,,,,3.1200319055103543,,,,,,1750734866.3009193,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/allegro_gen_8_2025-06-20_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/allegro_gen_8_2025-06-20_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/allegro_gen_8_2025-06-20_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_8_2025-06-20_r5_stress100_b4_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_8_2025-06-20_r5_stress100_b4_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_8_2025-06-20_r5_stress100_b4_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.01512968231003, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.79345809524218, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,3.343605351260732,,,,,0.14107125046541968,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,270003.0,,,,,,0.001396454354161018,,,0.0006984525546777663,0.006500270020485772,,,,,0.0032799396341138486,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.01512968231003, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.79345809524218, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 278561},2.320376335008325,,0.237029603393483,,,0.8379790286658074,,,,,,,,,,4.901626138914355,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.004392746769062713,0.008959957066464507,,,,,1.9670037632208464,,allegro-stress-rmax-test/job_gen_8_2025-06-20_r5_stress100_b4_lrsched_fixed,5.0,2.0,2.0,float32,0.0,32.01512968231003,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/allegro_gen_8_2025-06-20_train.xyz,data/allegro_gen_8_2025-06-20_val.xyz,data/allegro_gen_8_2025-06-20_test.xyz,804e3836,train:data/allegro_gen_8_2025-06-20_train.xyz|val:data/allegro_gen_8_2025-06-20_val.xyz|test:data/allegro_gen_8_2025-06-20_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,1000.0,1000.0
86,allegro-stress-rmax-test,job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed,128461.042511337,208210.0,1750987657.1654863,{'runtime': 128461},193.0,,,,,1.4581737521435114,13.71899624819924,11.042533735348552,12.718944992199493,0.25870575232920656,0.5142289903795327,8.984056743592753,,0.14758456609161827,0.006897964549654326,0.008954919417336607,,0.0008261081834410368,0.00013625307285153492,0.000732466453248625,1039114.0,0.20499297176245335,0.650826549759672,0.037342680977246134,0.18963364821888307,0.0022797801505469524,0.006554469748500017,0.28233822257568497,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/allegro_gen_8_2025-06-20_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/allegro_gen_8_2025-06-20_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/allegro_gen_8_2025-06-20_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.12707025837309, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.793458095242144, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.12707025837309, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.793458095242144, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1091.2447197894337,1247.6044585536074,,,,,,,,,,,,,,,,,,,,,,,,,2.591846358695152,3.998412606498108,,0.01566150342673125,0.006685236084200285,,,,,,,,,,,,,,,,,,0.20499297176245335,,,1247.6044585536074,0.006685236084200285,,,,,0.000732466453248625,,11.042533735348552,,1039114.0,1.4581737521435114,,,,0.00013625307285153492,,,,0.037342680977246134,,0.28233822257568497,,0.18963364821888307,0.01566150342673125,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",193.0,,,,128461.042511337,,,,1091.2447197894337,,,,,,,,2.591846358695152,,,,,,1750987657.1654863,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/allegro_gen_8_2025-06-20_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/allegro_gen_8_2025-06-20_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/allegro_gen_8_2025-06-20_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.12707025837309, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.793458095242144, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,13.71899624819924,,,,,0.14758456609161827,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,208210.0,,,,,,0.006897964549654326,,,0.0008261081834410368,0.25870575232920656,,,,,0.0022797801505469524,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.12707025837309, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.793458095242144, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 128461},12.718944992199493,,0.5142289903795327,,,0.650826549759672,,,,,,,,,,3.998412606498108,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.008954919417336607,0.006554469748500017,,,,,8.984056743592753,,allegro-stress-rmax-test/job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed,6.0,2.0,2.0,float32,0.0,58.12707025837309,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/allegro_gen_8_2025-06-20_train.xyz,data/allegro_gen_8_2025-06-20_val.xyz,data/allegro_gen_8_2025-06-20_test.xyz,804e3836,train:data/allegro_gen_8_2025-06-20_train.xyz|val:data/allegro_gen_8_2025-06-20_val.xyz|test:data/allegro_gen_8_2025-06-20_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,193.0,193.0
87,allegro-stress-rmax-test,job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed_no_dimers,128475.258497139,208220.0,1750987671.4403963,{'runtime': 128476},197.0,,,,,1.3686175577898123,11.50908369309444,10.648413405842511,11.002280708140336,0.2561925592110078,0.5049428484725177,7.672102416569097,,0.0014130549340787668,2.6859777158086066e-05,0.001198990688014597,,0.00017216969751370674,0.0003156762451954595,0.0015244998278528077,1039124.0,0.15531520168541327,0.34585214619922705,0.019388931821742447,0.023938825110281385,0.001617664263513425,0.0049591281522136455,0.12491669982057402,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/allegro_gen_8_2025-06-20_no_dimers_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/allegro_gen_8_2025-06-20_no_dimers_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/allegro_gen_8_2025-06-20_no_dimers_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed_no_dimers"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed_no_dimers"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed_no_dimers""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.1473021201517, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.610309224869487, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.1473021201517, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.610309224869487, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1085.0698959510107,1227.3847825913113,,,,,,,,,,,,,,,,,,,,,,,,,2.0903747113998254,2.749531033834565,,0.012898893371973289,0.0137479686674602,,,,,,,,,,,,,,,,,,0.15531520168541327,,,1227.3847825913113,0.0137479686674602,,,,,0.0015244998278528077,,10.648413405842511,,1039124.0,1.3686175577898123,,,,0.0003156762451954595,,,,0.019388931821742447,,0.12491669982057402,,0.023938825110281385,0.012898893371973289,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",197.0,,,,128475.258497139,,,,1085.0698959510107,,,,,,,,2.0903747113998254,,,,,,1750987671.4403963,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""test_file_path"": ""data/allegro_gen_8_2025-06-20_no_dimers_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""train_file_path"": ""data/allegro_gen_8_2025-06-20_no_dimers_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 1}, ""val_file_path"": ""data/allegro_gen_8_2025-06-20_no_dimers_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed_no_dimers"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed_no_dimers"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed_no_dimers""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.1473021201517, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.610309224869487, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,11.50908369309444,,,,,0.0014130549340787668,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,208220.0,,,,,,2.6859777158086066e-05,,,0.00017216969751370674,0.2561925592110078,,,,,0.001617664263513425,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.1473021201517, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.610309224869487, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 128476},11.002280708140336,,0.5049428484725177,,,0.34585214619922705,,,,,,,,,,2.749531033834565,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.001198990688014597,0.0049591281522136455,,,,,7.672102416569097,,allegro-stress-rmax-test/job_gen_8_2025-06-20_r6_stress100_b1_lrsched_fixed_no_dimers,6.0,2.0,2.0,float32,0.0,58.1473021201517,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/allegro_gen_8_2025-06-20_no_dimers_train.xyz,data/allegro_gen_8_2025-06-20_no_dimers_val.xyz,data/allegro_gen_8_2025-06-20_no_dimers_test.xyz,0e9f5f24,train:data/allegro_gen_8_2025-06-20_no_dimers_train.xyz|val:data/allegro_gen_8_2025-06-20_no_dimers_val.xyz|test:data/allegro_gen_8_2025-06-20_no_dimers_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,197.0,197.0
88,allegro-stress-rmax-test,job_gen_8_2025-06-20_r6_stress100_b4_lrsched_fixed,83.703071001,8.0,1750453061.1233954,{'runtime': 83},0.0,,,,,1.458173752555758,13.718996251781933,11.042533741761329,12.718944984315373,0.2587057524882264,0.514228990888467,8.98405674232859,,,,,,1.178508372174615,0.004769602496972982,0.027635104883843836,34.0,1.4214517518012155,12.496311190885375,10.85261969483329,11.21465214029481,0.2590801815720636,0.4619301838748523,8.057631171685012,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/allegro_gen_8_2025-06-20_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/allegro_gen_8_2025-06-20_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/allegro_gen_8_2025-06-20_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_8_2025-06-20_r6_stress100_b4_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_8_2025-06-20_r6_stress100_b4_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_8_2025-06-20_r6_stress100_b4_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.12707025837307, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.79345809524218, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.12707025837307, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.79345809524218, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,"{""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}",,,,,,,,,,,,,,,,,,,,,,,,1091.2447197740248,1247.604458501969,,,,,,,,,,,,,,,,,,,,,,,,,1114.9813119259975,1236.0252813710206,,,0.1412028020234753,,,,,,,,,,,,,,,,,,1.4214517518012155,,,1247.604458501969,0.1412028020234753,,,,,0.027635104883843836,,11.042533741761329,,34.0,1.458173752555758,,,,0.004769602496972982,,,,10.85261969483329,,8.057631171685012,,11.21465214029481,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",0.0,,,,83.703071001,,,,1091.2447197740248,,,,,,,,1114.9813119259975,,,,,,1750453061.1233954,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/allegro_gen_8_2025-06-20_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/allegro_gen_8_2025-06-20_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 6}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/allegro_gen_8_2025-06-20_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/job_gen_8_2025-06-20_r6_stress100_b4_lrsched_fixed"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""job_gen_8_2025-06-20_r6_stress100_b4_lrsched_fixed"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/job_gen_8_2025-06-20_r6_stress100_b4_lrsched_fixed""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.StratifiedHuberForceLoss"", ""delta_dict"": {""0.0107"": 0.0011, ""0.4981"": 0.0498, ""2.7991"": 0.2799}}, ""name"": ""forces_stratified_huber""}, {""coeff"": 100, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.12707025837307, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.79345809524218, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}, ""val_metrics"": {""_target_"": ""nequip.train.EnergyForceStressMetrics"", ""coeffs"": {""forces_rmse"": 1, ""per_atom_energy_rmse"": 1, ""stress_rmse"": 1}}}, ""versions"": {""allegro"": ""0.6.1"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.11.0"", ""torch"": ""2.7.0+cu118""}}",allegro-stress-rmax-test,13.718996251781933,,,,,,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,8.0,,,,,,,,,1.178508372174615,0.2587057524882264,,,,,0.2590801815720636,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 58.12707025837307, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 13.79345809524218, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 6, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 83},12.718944984315373,,0.514228990888467,,,12.496311190885375,,,,,,,,,,1236.0252813710206,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",,0.4619301838748523,,,,,8.98405674232859,,allegro-stress-rmax-test/job_gen_8_2025-06-20_r6_stress100_b4_lrsched_fixed,6.0,2.0,2.0,float32,0.0,58.12707025837307,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/allegro_gen_8_2025-06-20_train.xyz,data/allegro_gen_8_2025-06-20_val.xyz,data/allegro_gen_8_2025-06-20_test.xyz,804e3836,train:data/allegro_gen_8_2025-06-20_train.xyz|val:data/allegro_gen_8_2025-06-20_val.xyz|test:data/allegro_gen_8_2025-06-20_test.xyz,per_atom_energy_mse(coeff=1)|forces_stratified_huber(coeff=10)|stress_mse(coeff=100),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,0.0,0.0
89,allegro-stress-rmax-test,debug_job,,,,{'runtime': 5},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/debug_job_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/debug_job_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/debug_job_val.xyz"", ""data/debug_job_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/debug_job"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 1, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""debug_job"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/debug_job""}, ""max_epochs"": 1, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00545746023445, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.004520440254163, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00545746023445, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.004520440254163, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 0, ""stats_manager"": {""_target_"": ""forge.workflows.allegro_utils.ExtendedDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""test_file_path"": ""data/debug_job_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""train_file_path"": ""data/debug_job_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4}, ""val_file_path"": [""data/debug_job_val.xyz"", ""data/debug_job_val_b.xyz""]}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/debug_job"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 1, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""debug_job"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/debug_job""}, ""max_epochs"": 1, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00545746023445, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.004520440254163, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu128""}}",allegro-stress-rmax-test,,,,,,,,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 2}",,,,,,,,,,,,,,,,,,,,,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.00545746023445, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""nequip.nn.pair_potential.ZBL"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 7.004520440254163, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 0, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 5},,,,,,,,,,,,,,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",,,,,,,,,allegro-stress-rmax-test/debug_job,5.0,2.0,2.0,float32,0.0,32.00545746023445,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/debug_job_train.xyz,data/debug_job_val.xyz|data/debug_job_val_b.xyz,data/debug_job_test.xyz,06e0a40d,train:data/debug_job_train.xyz|val:data/debug_job_val.xyz|data/debug_job_val_b.xyz|test:data/debug_job_test.xyz,per_atom_energy_mse(coeff=1),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,,
90,allegro-stress-rmax-test,allegro_gen_8_2025-06-20_no_dimers,272107.791339681,265803.0,1751171455.11351,{'runtime': 272107},1000.0,,0.027777777777777776,0.6944444444444444,1e-06,0.20518317660599344,0.9979244715540426,0.05348263680360972,0.08158012347181082,0.006370298808251374,0.01415798412128968,0.3645541930490477,,0.7063921183207411,0.0184648967200478,0.07857695079821501,,0.00613138013202565,0.0003486970301834731,0.018089602614055948,1314000.0,0.1936461534957808,0.32753830034247733,0.05280950903894539,0.0794600463625469,0.00624957950605108,0.014087785718753947,0.14036204414125938,,,,,,,,0.999,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/allegro_gen_8_2025-06-20_no_dimers_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/allegro_gen_8_2025-06-20_no_dimers_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/allegro_gen_8_2025-06-20_no_dimers_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/allegro_gen_8_2025-06-20_no_dimers"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""allegro_gen_8_2025-06-20_no_dimers"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/allegro_gen_8_2025-06-20_no_dimers_nlh""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""forces_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.05165459701234, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""forge.workflows.allegro_utils.pair_potential.NLH"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.140394816296144, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""forces_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}","{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}","{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.05165459701234, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""forge.workflows.allegro_utils.pair_potential.NLH"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.140394816296144, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}","{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}","{""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}","{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.2777777777777778,0.16607556924138045,0.06363768882194017,,,,,,,0.1936461534957808,,,,,,,,,0.018089602614055948,,0.05348263680360972,,1314000.0,0.20518317660599344,,,,0.0003486970301834731,,,,0.05280950903894539,,0.14036204414125938,,0.0794600463625469,,,"{""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""forces_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}",1000.0,,,,272107.791339681,,,,,,,,,,,1e-06,,,,,,0.06363768882194017,1751171455.11351,,,"{""data"": {""_target_"": ""nequip.data.datamodule.ASEDataModule"", ""ase_args"": {""format"": ""extxyz""}, ""key_mapping"": {""REF_energy"": ""total_energy"", ""REF_force"": ""forces"", ""REF_stress"": ""stress""}, ""seed"": 42, ""stats_manager"": {""_target_"": ""nequip.data.CommonDataStatisticsManager"", ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""test_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""test_file_path"": ""data/allegro_gen_8_2025-06-20_no_dimers_test.xyz"", ""train_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""train_file_path"": ""data/allegro_gen_8_2025-06-20_no_dimers_train.xyz"", ""transforms"": [{""_target_"": ""nequip.data.transforms.NeighborListTransform"", ""r_max"": 5}, {""_target_"": ""nequip.data.transforms.ChemicalSpeciesToAtomTypeMapper"", ""chemical_symbols"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}], ""val_dataloader"": {""_target_"": ""torch.utils.data.DataLoader"", ""batch_size"": 4, ""num_workers"": 4}, ""val_file_path"": ""data/allegro_gen_8_2025-06-20_no_dimers_val.xyz""}, ""global_options"": {""allow_tf32"": false}, ""runs"": [""val"", ""test"", ""train"", ""val"", ""test""], ""trainer"": {""_target_"": ""lightning.Trainer"", ""accelerator"": ""gpu"", ""callbacks"": [{""_target_"": ""lightning.pytorch.callbacks.ModelCheckpoint"", ""dirpath"": ""results/allegro_gen_8_2025-06-20_no_dimers"", ""filename"": ""{epoch:03d}-{val0_epoch/stress_rmse:.4f}"", ""mode"": ""min"", ""monitor"": ""val0_epoch/stress_rmse"", ""save_last"": true, ""save_top_k"": 5}, {""_target_"": ""lightning.pytorch.callbacks.LearningRateMonitor"", ""logging_interval"": ""epoch""}, {""_target_"": ""nequip.train.callbacks.LossCoefficientMonitor"", ""frequency"": 1, ""interval"": ""epoch""}], ""check_val_every_n_epoch"": 1, ""devices"": 4, ""log_every_n_steps"": 5, ""logger"": {""_target_"": ""lightning.pytorch.loggers.wandb.WandbLogger"", ""name"": ""allegro_gen_8_2025-06-20_no_dimers"", ""project"": ""allegro-stress-rmax-test"", ""save_dir"": ""results/allegro_gen_8_2025-06-20_no_dimers_nlh""}, ""max_epochs"": 1000, ""num_nodes"": 1}, ""training_module"": {""_target_"": ""nequip.train.EMALightningModule"", ""loss"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""per_atom_energy_mse""}, {""coeff"": 10, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""forces_mse""}, {""coeff"": 25, ""field"": ""stress"", ""metric"": {""_target_"": ""nequip.train.MeanSquaredError""}, ""name"": ""stress_mse""}]}, ""lr_scheduler"": {""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}, ""model"": {""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.05165459701234, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""forge.workflows.allegro_utils.pair_potential.NLH"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.140394816296144, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}, ""optimizer"": {""_target_"": ""torch.optim.Adam"", ""lr"": 0.001}, ""test_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}, ""val_metrics"": {""_target_"": ""nequip.train.MetricsManager"", ""metrics"": [{""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""per_atom_energy_mae""}, {""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""forces_mae""}, {""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.MeanAbsoluteError""}, ""name"": ""stress_mae""}, {""coeff"": 1, ""field"": {""_target_"": ""nequip.data.PerAtomModifier"", ""field"": ""total_energy""}, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""per_atom_energy_rmse""}, {""coeff"": 1, ""field"": ""forces"", ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""forces_rmse""}, {""coeff"": 1, ""field"": ""stress"", ""ignore_nan"": true, ""metric"": {""_target_"": ""nequip.train.RootMeanSquaredError""}, ""name"": ""stress_rmse""}]}}, ""versions"": {""allegro"": ""0.6.3"", ""e3nn"": ""0.5.6"", ""nequip"": ""0.12.0"", ""torch"": ""2.7.1+cu118""}}",allegro-stress-rmax-test,0.9979244715540426,,,,,0.7063921183207411,0.6944444444444444,,,"{""predict"": 0, ""test"": 1, ""train"": 1, ""val"": 1}",,,,,265803.0,,,,,,0.0184648967200478,,,0.00613138013202565,0.006370298808251374,,,0.16607556924138045,0.027777777777777776,0.00624957950605108,"{""_target_"": ""allegro.model.AllegroModel"", ""allegro_mlp_hidden_layers_depth"": 2, ""allegro_mlp_hidden_layers_width"": 512, ""avg_num_neighbors"": 32.05165459701234, ""l_max"": 2, ""model_dtype"": ""float32"", ""num_layers"": 2, ""num_scalar_features"": 128, ""num_tensor_features"": 64, ""pair_potential"": {""_target_"": ""forge.workflows.allegro_utils.pair_potential.NLH"", ""chemical_species"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""], ""units"": ""metal""}, ""parity"": false, ""per_type_energy_scales"": 10.140394816296144, ""per_type_energy_scales_trainable"": false, ""per_type_energy_shifts"": {""Cr"": -5.42767241, ""Ti"": -2.15203187, ""V"": -3.55411419, ""W"": -4.55186158, ""Zr"": -2.3361286}, ""per_type_energy_shifts_trainable"": false, ""r_max"": 5, ""radial_chemical_embed"": {""_target_"": ""allegro.nn.TwoBodyBesselScalarEmbed"", ""bessel_trainable"": false, ""num_bessels"": 8, ""polynomial_cutoff_p"": 6}, ""radial_chemical_embed_dim"": 128, ""scalar_embed_mlp_hidden_layers_depth"": 2, ""scalar_embed_mlp_hidden_layers_width"": 256, ""scalar_embed_mlp_nonlinearity"": ""silu"", ""seed"": 42, ""tp_path_channel_coupling"": true, ""type_names"": [""Ti"", ""V"", ""Cr"", ""Zr"", ""W""]}",{'runtime': 272107},0.08158012347181082,,0.01415798412128968,,,0.32753830034247733,,,,,,,,,,,,,"{""frequency"": 1, ""interval"": ""epoch"", ""monitor"": ""val0_epoch/weighted_sum"", ""scheduler"": {""_target_"": ""torch.optim.lr_scheduler.ReduceLROnPlateau"", ""factor"": 0.5, ""min_lr"": 1e-06, ""patience"": 10}}",0.07857695079821501,0.014087785718753947,,0.2777777777777778,,,0.3645541930490477,,allegro-stress-rmax-test/allegro_gen_8_2025-06-20_no_dimers,5.0,2.0,2.0,float32,42.0,32.05165459701234,128.0,64.0,2.0,512.0,2.0,256.0,128.0,False,False,False,True,silu,6.0,8.0,False,data/allegro_gen_8_2025-06-20_no_dimers_train.xyz,data/allegro_gen_8_2025-06-20_no_dimers_val.xyz,data/allegro_gen_8_2025-06-20_no_dimers_test.xyz,0e9f5f24,train:data/allegro_gen_8_2025-06-20_no_dimers_train.xyz|val:data/allegro_gen_8_2025-06-20_no_dimers_val.xyz|test:data/allegro_gen_8_2025-06-20_no_dimers_test.xyz,per_atom_energy_mse(coeff=1)|forces_mse(coeff=10)|stress_mse(coeff=25),val0_epoch/stress_rmse,min,5.0,ModelCheckpoint|LearningRateMonitor|LossCoefficientMonitor,ReduceLROnPlateau,val0_epoch/weighted_sum,1.0,1000.0,1000.0
